{"version":3,"names":["cov_1fkvasw43v","actualCoverage","controller","PERMISSIONS","requireAnyPermission","idgMeetingDocumentationRoutes","fastify","options","f","s","post","preHandler","CREATE_CLINICAL_NOTES","createDocumentation","bind","get","VIEW_REPORTS","getPendingDocumentation","GENERATE_REPORTS","getComplianceReport","VIEW_CLINICAL_NOTES","getDocumentation","put","UPDATE_CLINICAL_NOTES","updateDocumentation","delete","DELETE_CLINICAL_NOTES","deleteDocumentation","submitDocumentation","MANAGE_SETTINGS","requestOverride","VIEW_AUDIT_LOGS","getAuditTrail"],"sources":["idgMeetingDocumentation.routes.js"],"sourcesContent":["import controller from '../controllers/IDGMeetingDocumentation.controller.js';\nimport { PERMISSIONS } from '../config/rbac.js';\nimport { requireAnyPermission } from '../middleware/rbac.middleware.js';\n\n/**\n * IDG Meeting Documentation Routes\n *\n * CMS 14-Day Compliance Enforcement for IDG Meeting Documentation\n * Per 42 CFR ยง418.56, documentation must be completed within 14 calendar days\n *\n * Endpoints:\n * - POST   /idg-meetings/documentation              - Create new documentation\n * - GET    /idg-meetings/documentation/:id          - Get specific documentation\n * - PUT    /idg-meetings/documentation/:id          - Update documentation (draft save)\n * - DELETE /idg-meetings/documentation/:id          - Delete documentation (soft delete)\n * - POST   /idg-meetings/documentation/:id/submit   - Submit documentation (final submission with deadline enforcement)\n * - POST   /idg-meetings/documentation/:id/override - Request late submission override (supervisor only)\n * - GET    /idg-meetings/documentation/pending      - List pending documentation with deadline status\n * - GET    /idg-meetings/documentation/compliance-report - Generate compliance metrics report\n * - GET    /idg-meetings/documentation/:id/audit-trail - Get documentation audit trail\n */\nexport default async function idgMeetingDocumentationRoutes(fastify, options) {\n\n  // ============================================================================\n  // STATIC ROUTES (must be registered BEFORE parameterized routes)\n  // ============================================================================\n\n  /**\n   * Create new IDG meeting documentation\n   * POST /idg-meetings/documentation\n   */\n  fastify.post('/idg-meetings/documentation', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.createDocumentation.bind(controller));\n\n  /**\n   * Get all pending documentation with deadline status\n   * GET /idg-meetings/documentation/pending\n   *\n   * Query params:\n   * - limit: number (default 50)\n   * - offset: number (default 0)\n   * - include_overdue: boolean (default true)\n   *\n   * Returns:\n   * - List of pending documentation with real-time deadline countdown\n   * - Summary counts by urgency category\n   * - Categorized lists (overdue, due_today, due_tomorrow, etc.)\n   */\n  fastify.get('/idg-meetings/documentation/pending', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_REPORTS)]\n  }, controller.getPendingDocumentation.bind(controller));\n\n  /**\n   * Generate compliance report\n   * GET /idg-meetings/documentation/compliance-report\n   *\n   * Query params:\n   * - month: number (1-12)\n   * - year: number (e.g., 2024)\n   * OR\n   * - start_date: ISO date string\n   * - end_date: ISO date string\n   *\n   * Returns comprehensive compliance metrics:\n   * - Total meetings and documentation coverage\n   * - On-time vs late submission rates\n   * - Override statistics and reasons\n   * - Average completion times\n   * - Meetings without documentation\n   * - CMS regulation reference (42 CFR ยง418.56)\n   */\n  fastify.get('/idg-meetings/documentation/compliance-report', {\n    preHandler: [requireAnyPermission(PERMISSIONS.GENERATE_REPORTS)]\n  }, controller.getComplianceReport.bind(controller));\n\n  // ============================================================================\n  // PARAMETERIZED ROUTES (must be registered AFTER static routes)\n  // ============================================================================\n\n  /**\n   * Get documentation by ID\n   * GET /idg-meetings/documentation/:id\n   *\n   * Returns documentation with real-time deadline countdown\n   */\n  fastify.get('/idg-meetings/documentation/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getDocumentation.bind(controller));\n\n  /**\n   * Update documentation (draft save)\n   * PUT /idg-meetings/documentation/:id\n   *\n   * Notes:\n   * - Draft saves are allowed at any time (no deadline enforcement)\n   * - Cannot modify meeting_date after creation\n   * - Cannot update finalized (submitted/approved) documentation\n   * - Each update increments draft_version\n   */\n  fastify.put('/idg-meetings/documentation/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.updateDocumentation.bind(controller));\n\n  /**\n   * Delete documentation (soft delete with audit trail)\n   * DELETE /idg-meetings/documentation/:id\n   *\n   * Required body:\n   * - deletion_reason: string (minimum 20 characters)\n   *\n   * Notes:\n   * - Requires administrator role\n   * - Creates immutable audit trail entry\n   * - Cancels pending compliance alerts\n   */\n  fastify.delete('/idg-meetings/documentation/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.DELETE_CLINICAL_NOTES)]\n  }, controller.deleteDocumentation.bind(controller));\n\n  /**\n   * Submit documentation (final submission with 14-day deadline enforcement)\n   * POST /idg-meetings/documentation/:id/submit\n   *\n   * IMPORTANT: This endpoint enforces the CMS 14-day deadline per 42 CFR ยง418.56\n   *\n   * Behavior:\n   * - If within deadline: Accepts submission, marks as SUBMITTED\n   * - If past deadline without override: Returns HTTP 422 with CMS regulation reference\n   * - If past deadline with override: Accepts submission, marks as OVERRIDDEN\n   *\n   * Validation:\n   * - Required fields must be complete\n   * - Cannot resubmit already submitted documentation\n   */\n  fastify.post('/idg-meetings/documentation/:id/submit', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.submitDocumentation.bind(controller));\n\n  /**\n   * Request late submission override\n   * POST /idg-meetings/documentation/:id/override\n   *\n   * Required body:\n   * - justification: string (minimum 50 characters)\n   *\n   * Authorization:\n   * - Requires supervisor, administrator, director, or compliance_officer role\n   *\n   * Effects:\n   * - Grants override for this documentation\n   * - Flags documentation in compliance reports\n   * - Creates audit trail entry\n   * - Notifies compliance team (when notification service available)\n   */\n  fastify.post('/idg-meetings/documentation/:id/override', {\n    preHandler: [requireAnyPermission(PERMISSIONS.MANAGE_SETTINGS)] // Admin-level permission\n  }, controller.requestOverride.bind(controller));\n\n  /**\n   * Get documentation audit trail\n   * GET /idg-meetings/documentation/:id/audit-trail\n   *\n   * Query params:\n   * - limit: number (default 100)\n   * - offset: number (default 0)\n   *\n   * Returns immutable audit log entries for the documentation including:\n   * - All status transitions\n   * - User actions (create, update, submit, override)\n   * - IP addresses and user agents\n   * - Deadline status at time of each action\n   */\n  fastify.get('/idg-meetings/documentation/:id/audit-trail', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_AUDIT_LOGS)]\n  }, controller.getAuditTrail.bind(controller));\n}\n"],"mappings":"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","ignoreList":[]}