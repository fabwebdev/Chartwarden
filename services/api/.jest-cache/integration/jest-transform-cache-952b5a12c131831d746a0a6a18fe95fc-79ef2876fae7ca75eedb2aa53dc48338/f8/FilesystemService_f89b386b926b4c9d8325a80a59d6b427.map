{"version":3,"names":["cov_j9aopqerv","actualCoverage","fs","path","filesystemsConfig","FilesystemService","constructor","f","s","config","disks","Map","initializeDisks","name","Object","entries","set","driver","root","url","visibility","disk","b","default","get","filePath","diskName","Error","join","exists","fullPath","existsSync","read","readFileSync","write","content","dir","dirname","mkdirSync","recursive","writeFileSync","delete","unlinkSync","size","stats","statSync","lastModified","mtime"],"sources":["FilesystemService.js"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport filesystemsConfig from '../config/filesystems.config.js';\n\nclass FilesystemService {\n    constructor() {\n        this.config = filesystemsConfig;\n        this.disks = new Map();\n        this.initializeDisks();\n    }\n    \n    /**\n     * Initialize the filesystem disks\n     */\n    initializeDisks() {\n        for (const [name, config] of Object.entries(this.config.disks)) {\n            this.disks.set(name, {\n                driver: config.driver,\n                root: config.root,\n                url: config.url,\n                visibility: config.visibility\n            });\n        }\n    }\n    \n    /**\n     * Get a disk instance\n     * @param {string} name - Disk name\n     * @returns {Object} Disk configuration\n     */\n    disk(name = this.config.default) {\n        return this.disks.get(name);\n    }\n    \n    /**\n     * Get the full path for a file\n     * @param {string} filePath - File path\n     * @param {string} diskName - Disk name\n     * @returns {string} Full path\n     */\n    path(filePath, diskName = this.config.default) {\n        const disk = this.disk(diskName);\n        if (!disk) {\n            throw new Error(`Disk ${diskName} not found`);\n        }\n        \n        return path.join(disk.root, filePath);\n    }\n    \n    /**\n     * Check if a file exists\n     * @param {string} filePath - File path\n     * @param {string} diskName - Disk name\n     * @returns {boolean} True if file exists\n     */\n    exists(filePath, diskName = this.config.default) {\n        const fullPath = this.path(filePath, diskName);\n        return fs.existsSync(fullPath);\n    }\n    \n    /**\n     * Read a file\n     * @param {string} filePath - File path\n     * @param {string} diskName - Disk name\n     * @returns {Buffer|string} File content\n     */\n    read(filePath, diskName = this.config.default) {\n        const fullPath = this.path(filePath, diskName);\n        return fs.readFileSync(fullPath);\n    }\n    \n    /**\n     * Write a file\n     * @param {string} filePath - File path\n     * @param {string|Buffer} content - File content\n     * @param {string} diskName - Disk name\n     * @returns {boolean} True if successful\n     */\n    write(filePath, content, diskName = this.config.default) {\n        const fullPath = this.path(filePath, diskName);\n        \n        // Create directory if it doesn't exist\n        const dir = path.dirname(fullPath);\n        if (!fs.existsSync(dir)) {\n            fs.mkdirSync(dir, { recursive: true });\n        }\n        \n        fs.writeFileSync(fullPath, content);\n        return true;\n    }\n    \n    /**\n     * Delete a file\n     * @param {string} filePath - File path\n     * @param {string} diskName - Disk name\n     * @returns {boolean} True if successful\n     */\n    delete(filePath, diskName = this.config.default) {\n        const fullPath = this.path(filePath, diskName);\n        if (fs.existsSync(fullPath)) {\n            fs.unlinkSync(fullPath);\n            return true;\n        }\n        return false;\n    }\n    \n    /**\n     * Get file URL\n     * @param {string} filePath - File path\n     * @param {string} diskName - Disk name\n     * @returns {string} File URL\n     */\n    url(filePath, diskName = this.config.default) {\n        const disk = this.disk(diskName);\n        if (!disk || !disk.url) {\n            return null;\n        }\n        \n        return `${disk.url}/${filePath}`;\n    }\n    \n    /**\n     * Get file size\n     * @param {string} filePath - File path\n     * @param {string} diskName - Disk name\n     * @returns {number} File size in bytes\n     */\n    size(filePath, diskName = this.config.default) {\n        const fullPath = this.path(filePath, diskName);\n        const stats = fs.statSync(fullPath);\n        return stats.size;\n    }\n    \n    /**\n     * Get file last modified time\n     * @param {string} filePath - File path\n     * @param {string} diskName - Disk name\n     * @returns {Date} Last modified time\n     */\n    lastModified(filePath, diskName = this.config.default) {\n        const fullPath = this.path(filePath, diskName);\n        const stats = fs.statSync(fullPath);\n        return stats.mtime;\n    }\n}\n\nexport default new FilesystemService();"],"mappings":"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","ignoreList":[]}