{"version":3,"names":["cov_1sg4su5790","actualCoverage","controller","PERMISSIONS","requireAnyPermission","medicationRoutes","fastify","options","f","s","get","preHandler","VIEW_MEDICATIONS","VIEW_CLINICAL_NOTES","getPatientMedications","getMedication","getMedicationSchedule","post","CREATE_MEDICATIONS","CREATE_CLINICAL_NOTES","createMedication","put","UPDATE_MEDICATIONS","UPDATE_CLINICAL_NOTES","updateMedication","delete","DELETE_MEDICATIONS","cancelMedication","checkInteractions","discontinueMedication","holdMedication","pauseMedication","resumeMedication","getPatientMAR","getMAREntry","createMAREntry","updateMAREntry","getPatientComfortKit","createComfortKit","destroyComfortKit","getMedicationReconciliationHistory","getMedicationReconciliation","createMedicationReconciliation","compareMedications","getPatientAllergies","createPatientAllergy","updatePatientAllergy","deletePatientAllergy","getControlledSubstanceLog"],"sources":["medication.routes.js"],"sourcesContent":["import controller from '../controllers/Medication.controller.js';\nimport { PERMISSIONS } from '../config/rbac.js';\nimport { requireAnyPermission } from '../middleware/rbac.middleware.js';\n\n/**\n * Medication Routes\n * Medication management, MAR, comfort kits, and controlled substances\n * CRITICAL: Clinical necessity and regulatory compliance\n */\nexport default async function medicationRoutes(fastify, options) {\n  // ============================================================================\n  // MEDICATION ORDER ROUTES\n  // ============================================================================\n\n  // Get patient medications\n  fastify.get('/patients/:id/medications', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_MEDICATIONS, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getPatientMedications);\n\n  // Get single medication\n  fastify.get('/patients/:id/medications/:medId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_MEDICATIONS, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getMedication);\n\n  // Get medication schedule for a patient\n  fastify.get('/patients/:id/medications/schedule', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_MEDICATIONS, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getMedicationSchedule);\n\n  // Create medication order\n  fastify.post('/patients/:id/medications', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_MEDICATIONS, PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.createMedication);\n\n  // Update medication order\n  fastify.put('/patients/:id/medications/:medId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_MEDICATIONS, PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.updateMedication);\n\n  // Cancel medication order\n  fastify.delete('/patients/:id/medications/:medId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.DELETE_MEDICATIONS, PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.cancelMedication);\n\n  // Check drug interactions and allergy conflicts\n  fastify.post('/patients/:id/medications/check-interactions', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_MEDICATIONS, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.checkInteractions);\n\n  // Discontinue medication\n  fastify.post('/patients/:id/medications/:medId/discontinue', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_MEDICATIONS, PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.discontinueMedication);\n\n  // Hold medication\n  fastify.post('/patients/:id/medications/:medId/hold', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_MEDICATIONS, PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.holdMedication);\n\n  // Pause medication\n  fastify.post('/patients/:id/medications/:medId/pause', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_MEDICATIONS, PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.pauseMedication);\n\n  // Resume medication\n  fastify.post('/patients/:id/medications/:medId/resume', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_MEDICATIONS, PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.resumeMedication);\n\n  // ============================================================================\n  // MAR (MEDICATION ADMINISTRATION RECORD) ROUTES\n  // ============================================================================\n\n  // Get patient MAR entries\n  fastify.get('/patients/:id/mar', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_MEDICATIONS, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getPatientMAR);\n\n  // Get single MAR entry\n  fastify.get('/patients/:id/mar/:marId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_MEDICATIONS, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getMAREntry);\n\n  // Create MAR entry (record medication administration)\n  fastify.post('/patients/:id/mar', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_MEDICATIONS, PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.createMAREntry);\n\n  // Update MAR entry\n  fastify.put('/patients/:id/mar/:marId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_MEDICATIONS, PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.updateMAREntry);\n\n  // ============================================================================\n  // COMFORT KIT ROUTES\n  // ============================================================================\n\n  // Get patient comfort kit\n  fastify.get('/patients/:id/comfort-kit', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_MEDICATIONS, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getPatientComfortKit);\n\n  // Create comfort kit\n  fastify.post('/patients/:id/comfort-kit', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_MEDICATIONS, PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.createComfortKit);\n\n  // Destroy comfort kit\n  fastify.post('/patients/:id/comfort-kit/destroy', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_MEDICATIONS, PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.destroyComfortKit);\n\n  // ============================================================================\n  // MEDICATION RECONCILIATION ROUTES\n  // ============================================================================\n\n  // Get medication reconciliation history\n  fastify.get('/patients/:id/medication-reconciliation', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_MEDICATIONS, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getMedicationReconciliationHistory);\n\n  // Get single medication reconciliation\n  fastify.get('/patients/:id/medication-reconciliation/:reconId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_MEDICATIONS, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getMedicationReconciliation);\n\n  // Create medication reconciliation\n  fastify.post('/patients/:id/medication-reconciliation', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_MEDICATIONS, PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.createMedicationReconciliation);\n\n  // Compare home medications with current orders\n  fastify.post('/patients/:id/medication-reconciliation/compare', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_MEDICATIONS, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.compareMedications);\n\n  // ============================================================================\n  // PATIENT ALLERGIES ROUTES\n  // ============================================================================\n\n  // Get patient allergies\n  fastify.get('/patients/:id/allergies', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_MEDICATIONS, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getPatientAllergies);\n\n  // Create patient allergy\n  fastify.post('/patients/:id/allergies', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_MEDICATIONS, PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.createPatientAllergy);\n\n  // Update patient allergy\n  fastify.put('/patients/:id/allergies/:allergyId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_MEDICATIONS, PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.updatePatientAllergy);\n\n  // Delete patient allergy\n  fastify.delete('/patients/:id/allergies/:allergyId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.DELETE_MEDICATIONS, PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.deletePatientAllergy);\n\n  // ============================================================================\n  // CONTROLLED SUBSTANCE LOG ROUTES\n  // ============================================================================\n\n  // Get controlled substance log for patient\n  fastify.get('/patients/:id/controlled-substances', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_MEDICATIONS, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getControlledSubstanceLog);\n}\n"],"mappings":"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","ignoreList":[]}