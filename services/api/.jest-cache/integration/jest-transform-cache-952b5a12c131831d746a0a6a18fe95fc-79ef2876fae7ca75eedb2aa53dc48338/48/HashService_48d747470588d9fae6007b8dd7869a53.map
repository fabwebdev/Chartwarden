{"version":3,"names":["cov_3rf0xbf9s","actualCoverage","bcrypt","argon2","hashingConfig","HashService","constructor","f","s","config","make","value","driver","b","hash","rounds","memoryCost","memory","parallelism","timeCost","time","Error","check","compare","verify","needsRehash"],"sources":["HashService.js"],"sourcesContent":["import bcrypt from 'bcryptjs';\nimport argon2 from 'argon2';\nimport hashingConfig from '../config/hashing.config.js';\n\nclass HashService {\n    constructor() {\n        this.config = hashingConfig;\n    }\n    \n    /**\n     * Hash a value\n     * @param {string} value - The value to hash\n     * @returns {Promise<string>} The hashed value\n     */\n    async make(value) {\n        switch (this.config.driver) {\n            case 'bcrypt':\n                return await bcrypt.hash(value, this.config.bcrypt.rounds);\n                \n            case 'argon2':\n                return await argon2.hash(value, {\n                    memoryCost: this.config.argon2.memory,\n                    parallelism: this.config.argon2.parallelism,\n                    timeCost: this.config.argon2.time\n                });\n                \n            default:\n                throw new Error(`Unsupported hash driver: ${this.config.driver}`);\n        }\n    }\n    \n    /**\n     * Check if a value matches a hash\n     * @param {string} value - The value to check\n     * @param {string} hash - The hash to compare against\n     * @returns {Promise<boolean>} True if the value matches the hash\n     */\n    async check(value, hash) {\n        switch (this.config.driver) {\n            case 'bcrypt':\n                return await bcrypt.compare(value, hash);\n                \n            case 'argon2':\n                return await argon2.verify(hash, value);\n                \n            default:\n                throw new Error(`Unsupported hash driver: ${this.config.driver}`);\n        }\n    }\n    \n    /**\n     * Check if a hash needs to be rehashed\n     * @param {string} hash - The hash to check\n     * @returns {boolean} True if the hash needs to be rehashed\n     */\n    needsRehash(hash) {\n        // This is a simplified implementation\n        // In practice, you would check the hash parameters\n        return false;\n    }\n}\n\nexport default new HashService();"],"mappings":"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","ignoreList":[]}