{"version":3,"names":["cov_2in1i1adxz","actualCoverage","controller","PERMISSIONS","requireAnyPermission","carePlanRoutes","fastify","options","f","s","get","preHandler","VIEW_CLINICAL_NOTES","getAllCarePlans","VIEW_PATIENT","getPatientCarePlans","post","CREATE_CLINICAL_NOTES","createCarePlan","show","patch","UPDATE_CLINICAL_NOTES","update","delete","sign","recertify","getPatientProblems","getProblemById","createProblem","updateProblem","deleteProblem","resolveProblem","getPatientGoals","getGoalById","createGoal","updateGoal","deleteGoal","updateGoalProgress","discontinueGoal","addGoalMilestone","getPatientInterventions","getInterventionById","createIntervention","updateIntervention","deleteIntervention","recordInterventionPerformed","discontinueIntervention","getTemplates","createTemplate"],"sources":["carePlan.routes.js"],"sourcesContent":["import controller from '../controllers/CarePlan.controller.js';\nimport { PERMISSIONS } from '../config/rbac.js';\nimport { requireAnyPermission } from '../middleware/rbac.middleware.js';\n\n/**\n * Care Plan Routes\n * Patient-centered care planning - Medicare requirement\n *\n * Features:\n * - Full CRUD for care plans, problems, goals, and interventions\n * - Pagination and filtering support on list endpoints\n * - Goal tracking with milestones and progress updates\n * - Intervention monitoring with performance tracking\n * - Optimistic locking for concurrent update protection\n * - Soft deletes with active dependency protection\n */\nexport default async function carePlanRoutes(fastify, options) {\n  // ============================================================================\n  // CARE PLANS\n  // ============================================================================\n\n  // List all care plans (with pagination and filtering)\n  fastify.get('/care-plans', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getAllCarePlans);\n\n  // Patient care plans (with pagination and filtering)\n  fastify.get('/patients/:id/care-plans', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_PATIENT, PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getPatientCarePlans);\n\n  fastify.post('/patients/:id/care-plans', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.createCarePlan);\n\n  // Care plan by ID (includes related problems, goals, interventions)\n  fastify.get('/care-plans/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.show);\n\n  // Update care plan (with optimistic locking via version field)\n  fastify.patch('/care-plans/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.update);\n\n  // Delete/archive care plan (protected: cannot delete with active interventions)\n  fastify.delete('/care-plans/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.delete);\n\n  // Sign care plan (21 CFR Part 11 compliance)\n  fastify.post('/care-plans/:id/sign', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.sign);\n\n  // Recertify care plan (Medicare recertification)\n  fastify.post('/care-plans/:id/recertify', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.recertify);\n\n  // ============================================================================\n  // PROBLEMS\n  // ============================================================================\n\n  // Patient problems (with pagination and filtering)\n  fastify.get('/patients/:id/problems', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getPatientProblems);\n\n  // Get problem by ID (includes related goals and interventions)\n  fastify.get('/problems/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getProblemById);\n\n  fastify.post('/patients/:id/problems', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.createProblem);\n\n  fastify.patch('/problems/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.updateProblem);\n\n  // Delete problem (soft delete - protected: cannot delete with active goals)\n  fastify.delete('/problems/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.deleteProblem);\n\n  // Resolve problem\n  fastify.post('/problems/:id/resolve', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.resolveProblem);\n\n  // ============================================================================\n  // GOALS\n  // ============================================================================\n\n  // Patient goals (with pagination and filtering)\n  fastify.get('/patients/:id/goals', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getPatientGoals);\n\n  // Get goal by ID (includes related interventions and problem)\n  fastify.get('/goals/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getGoalById);\n\n  fastify.post('/patients/:id/goals', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.createGoal);\n\n  fastify.patch('/goals/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.updateGoal);\n\n  // Delete goal (soft delete - protected: cannot delete with active interventions)\n  fastify.delete('/goals/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.deleteGoal);\n\n  // Update goal progress\n  fastify.post('/goals/:id/progress', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.updateGoalProgress);\n\n  // Discontinue goal (with status transition validation)\n  fastify.post('/goals/:id/discontinue', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.discontinueGoal);\n\n  // Add milestone to goal\n  fastify.post('/goals/:id/milestones', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.addGoalMilestone);\n\n  // ============================================================================\n  // INTERVENTIONS\n  // ============================================================================\n\n  // Patient interventions (with pagination and filtering)\n  fastify.get('/patients/:id/interventions', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getPatientInterventions);\n\n  // Get intervention by ID (includes related goal and problem)\n  fastify.get('/interventions/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getInterventionById);\n\n  fastify.post('/patients/:id/interventions', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.createIntervention);\n\n  fastify.patch('/interventions/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.updateIntervention);\n\n  // Delete intervention (soft delete)\n  fastify.delete('/interventions/:id', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.deleteIntervention);\n\n  // Record intervention performed\n  fastify.post('/interventions/:id/performed', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.recordInterventionPerformed);\n\n  // Discontinue intervention\n  fastify.post('/interventions/:id/discontinue', {\n    preHandler: [requireAnyPermission(PERMISSIONS.UPDATE_CLINICAL_NOTES)]\n  }, controller.discontinueIntervention);\n\n  // ============================================================================\n  // CARE PLAN TEMPLATES\n  // ============================================================================\n\n  fastify.get('/care-plan-templates', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getTemplates);\n\n  fastify.post('/care-plan-templates', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.createTemplate);\n}\n"],"mappings":"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","ignoreList":[]}