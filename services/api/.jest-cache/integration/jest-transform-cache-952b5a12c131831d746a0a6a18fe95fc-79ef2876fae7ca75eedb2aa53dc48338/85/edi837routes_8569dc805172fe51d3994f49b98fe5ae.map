{"version":3,"names":["cov_9mop9zy13","actualCoverage","controller","PERMISSIONS","requireAnyPermission","edi837Routes","fastify","options","f","s","post","preHandler","CREATE_CLINICAL_NOTES","generate837","generateBatch837","VIEW_CLINICAL_NOTES","validateClaim","get","previewEDI","getClaimTypes","getSubmissionHistory","downloadEDI","VIEW_REPORTS","getSubmissionStatus"],"sources":["edi837.routes.js"],"sourcesContent":["import controller from '../controllers/EDI837.controller.js';\nimport { PERMISSIONS } from '../config/rbac.js';\nimport { requireAnyPermission } from '../middleware/rbac.middleware.js';\n\n/**\n * EDI 837 Routes\n * Comprehensive EDI 837 claim file generation for healthcare clearinghouse submission\n *\n * Supports:\n *   - 837I (Institutional Claims) - ANSI X12 005010X223A2\n *   - 837P (Professional Claims) - ANSI X12 005010X222A1\n *\n * Features:\n *   - Single and batch file generation\n *   - Pre-generation validation\n *   - File preview without saving\n *   - Submission tracking\n *   - File download\n *   - HIPAA 5010 compliance\n *\n * Endpoints:\n *   POST /api/edi837/generate/:claimId - Generate 837 for single claim\n *   POST /api/edi837/generate-batch - Generate batch 837 file\n *   POST /api/edi837/validate/:claimId - Validate claim for EDI generation\n *   GET /api/edi837/preview/:claimId - Preview EDI content without saving\n *   GET /api/edi837/claim-types - Get supported claim types\n *   GET /api/edi837/submissions/:claimId - Get submission history for claim\n *   GET /api/edi837/download/:submissionId - Download EDI file\n *   GET /api/edi837/submission-status - Get submission status summary\n */\nexport default async function edi837Routes(fastify, options) {\n\n  /**\n   * Generate 837 EDI file for a single claim\n   * POST /api/edi837/generate/:claimId\n   *\n   * Body: {\n   *   claim_type?: '837I' | '837P',  // Auto-detected if not provided\n   *   clearinghouse_id?: string,      // Clearinghouse configuration ID\n   *   skip_validation?: boolean       // Skip pre-generation validation\n   * }\n   *\n   * Response: {\n   *   status: 'success',\n   *   message: '837I file generated successfully',\n   *   data: {\n   *     submission_id, claim_id, claim_type, edi_file_name, edi_file_path,\n   *     edi_control_number, file_size_bytes, segment_count, checksum, generated_at\n   *   }\n   * }\n   */\n  fastify.post('/edi837/generate/:claimId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.generate837);\n\n  /**\n   * Generate batch 837 EDI file for multiple claims\n   * POST /api/edi837/generate-batch\n   *\n   * Body: {\n   *   claim_ids: number[],            // Array of claim IDs (max 5000)\n   *   batch_name?: string,            // Custom batch identifier\n   *   claim_type?: '837I' | '837P',   // Force specific claim type\n   *   clearinghouse_id?: string,      // Clearinghouse configuration ID\n   *   continue_on_error?: boolean,    // Continue if individual claims fail (default: true)\n   *   skip_validation?: boolean       // Skip pre-generation validation\n   * }\n   *\n   * Response: {\n   *   status: 'success',\n   *   message: 'Batch 837 file generated for X claims',\n   *   data: {\n   *     batch_id, submission_ids, edi_file_name, edi_file_path,\n   *     claims_processed, claims_failed, failed_claims, processed_claims,\n   *     total_charges_cents, file_size_bytes, segment_count, checksum, generated_at\n   *   }\n   * }\n   */\n  fastify.post('/edi837/generate-batch', {\n    preHandler: [requireAnyPermission(PERMISSIONS.CREATE_CLINICAL_NOTES)]\n  }, controller.generateBatch837);\n\n  /**\n   * Validate claim for EDI generation\n   * POST /api/edi837/validate/:claimId\n   *\n   * Body: {\n   *   claim_type?: '837I' | '837P'    // Auto-detected if not provided\n   * }\n   *\n   * Response: {\n   *   status: 'success',\n   *   message: 'Claim is valid for EDI generation',\n   *   data: {\n   *     claim_id, claim_type, is_valid, errors, warnings, validated_at\n   *   }\n   * }\n   */\n  fastify.post('/edi837/validate/:claimId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.validateClaim);\n\n  /**\n   * Preview EDI content without saving\n   * GET /api/edi837/preview/:claimId\n   *\n   * Query: {\n   *   claim_type?: '837I' | '837P',   // Auto-detected if not provided\n   *   clearinghouse_id?: string,      // Clearinghouse configuration ID\n   *   skip_validation?: 'true'        // Skip pre-generation validation\n   * }\n   *\n   * Response: {\n   *   status: 'success',\n   *   message: 'EDI preview generated successfully',\n   *   data: {\n   *     preview: true, claim_id, claim_type, edi_content,\n   *     segment_count, checksum, control_numbers\n   *   }\n   * }\n   */\n  fastify.get('/edi837/preview/:claimId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.previewEDI);\n\n  /**\n   * Get supported claim types\n   * GET /api/edi837/claim-types\n   *\n   * Response: {\n   *   status: 'success',\n   *   data: {\n   *     claim_types: {\n   *       '837I': { name, version, description, bill_type_prefix },\n   *       '837P': { name, version, description, bill_type_prefix }\n   *     }\n   *   }\n   * }\n   */\n  fastify.get('/edi837/claim-types', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getClaimTypes);\n\n  /**\n   * Get submission history for a claim\n   * GET /api/edi837/submissions/:claimId\n   *\n   * Response: {\n   *   status: 'success',\n   *   data: {\n   *     claim_id, submission_count, submissions: [\n   *       { submission_id, batch_id, submission_date, edi_file_name,\n   *         control_numbers, clearinghouse, status, charges_cents, claim_type, ... }\n   *     ]\n   *   }\n   * }\n   */\n  fastify.get('/edi837/submissions/:claimId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.getSubmissionHistory);\n\n  /**\n   * Download EDI file\n   * GET /api/edi837/download/:submissionId\n   *\n   * Query: {\n   *   format?: 'raw' | 'formatted'    // 'formatted' adds line breaks (default: 'raw')\n   * }\n   *\n   * Response: Raw EDI file content (text/plain)\n   */\n  fastify.get('/edi837/download/:submissionId', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_CLINICAL_NOTES)]\n  }, controller.downloadEDI);\n\n  /**\n   * Get submission status summary\n   * GET /api/edi837/submission-status\n   *\n   * Query: {\n   *   status?: string,                // Filter by status\n   *   date_from?: string,             // Filter from date (ISO format)\n   *   date_to?: string,               // Filter to date (ISO format)\n   *   clearinghouse_id?: string,      // Filter by clearinghouse\n   *   limit?: number,                 // Max results (default: 100)\n   *   offset?: number                 // Offset for pagination (default: 0)\n   * }\n   *\n   * Response: {\n   *   status: 'success',\n   *   data: {\n   *     submissions: [...],\n   *     summary: { total, by_status, total_charges_cents },\n   *     pagination: { limit, offset, returned }\n   *   }\n   * }\n   */\n  fastify.get('/edi837/submission-status', {\n    preHandler: [requireAnyPermission(PERMISSIONS.VIEW_REPORTS)]\n  }, controller.getSubmissionStatus);\n}\n"],"mappings":"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","ignoreList":[]}