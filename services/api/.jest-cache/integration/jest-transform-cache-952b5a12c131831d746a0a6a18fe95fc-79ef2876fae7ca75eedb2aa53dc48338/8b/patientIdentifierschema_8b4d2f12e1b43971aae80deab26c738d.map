{"version":3,"names":["cov_wj47b6rnp","actualCoverage","pgTable","bigint","varchar","timestamp","boolean","index","text","patients","users","patient_identifiers","s","id","mode","primaryKey","generatedByDefaultAsIdentity","patient_id","references","f","notNull","identifier_type","length","identifier_value","facility_id","facility_name","issuing_authority","issuing_state","is_primary","default","is_active","is_verified","effective_from","effective_to","verified_at","verified_by_id","verification_method","verification_notes","notes","created_by_id","updated_by_id","deleted_at","createdAt","defaultNow","updatedAt","table","patientIdx","on","typeIdx","valueIdx","facilityIdx","activeIdx","patientTypeIdx","patientActiveIdx","typeValueIdx","patientTypePrimaryIdx","patientIdentifiers"],"sources":["patientIdentifier.schema.js"],"sourcesContent":["import { pgTable, bigint, varchar, timestamp, boolean, index, text } from 'drizzle-orm/pg-core';\nimport { patients } from './patient.schema.js';\nimport { users } from './user.schema.js';\n\n/**\n * Patient Identifiers - Multiple identifier types per patient\n * Manages various patient identification numbers with type and facility tracking\n *\n * COMPLIANCE: Required for HIPAA, Medicare/Medicaid billing, and cross-facility patient matching\n *\n * Identifier types:\n * - MRN: Medical Record Number (internal, facility-specific)\n * - SSN: Social Security Number (sensitive PII, encrypted storage recommended)\n * - MEDICARE: Medicare Beneficiary Identifier (MBI) for hospice billing\n * - MEDICAID: Medicaid ID for dual-eligible patients\n * - INSURANCE: Commercial insurance member ID\n * - NPI: National Provider Identifier (if patient is also a provider)\n * - OTHER: Custom identifier types\n *\n * Use cases:\n * - Store multiple MRNs when patient transfers between facilities\n * - Track historical identifiers (old MBI numbers after changes)\n * - Support multi-payer scenarios with different member IDs\n * - Enable patient matching across facilities\n */\nexport const patient_identifiers = pgTable('patient_identifiers', {\n  id: bigint('id', { mode: 'number' }).primaryKey().generatedByDefaultAsIdentity(),\n  patient_id: bigint('patient_id', { mode: 'number' }).references(() => patients.id).notNull(),\n\n  // Identifier classification\n  identifier_type: varchar('identifier_type', { length: 50 }).notNull(), // MRN, SSN, MEDICARE, MEDICAID, INSURANCE, NPI, OTHER\n  identifier_value: varchar('identifier_value', { length: 255 }).notNull(), // The actual identifier value\n\n  // Facility/Issuer tracking\n  facility_id: bigint('facility_id', { mode: 'number' }), // Reference to facility if applicable\n  facility_name: varchar('facility_name', { length: 255 }), // Facility or organization name that issued the identifier\n  issuing_authority: varchar('issuing_authority', { length: 255 }), // Authority that issued the identifier (e.g., CMS, State Medicaid, etc.)\n  issuing_state: varchar('issuing_state', { length: 2 }), // Two-letter state code for state-issued IDs (e.g., Medicaid)\n\n  // Status flags\n  is_primary: boolean('is_primary').default(false), // True if this is the primary identifier for its type\n  is_active: boolean('is_active').default(true), // Identifier is currently active/valid\n  is_verified: boolean('is_verified').default(false), // Identifier has been verified\n\n  // Effective dates (for tracking identifier history)\n  effective_from: timestamp('effective_from'), // When the identifier became valid\n  effective_to: timestamp('effective_to'), // When the identifier expired/was replaced\n\n  // Verification tracking\n  verified_at: timestamp('verified_at'), // When verification occurred\n  verified_by_id: text('verified_by_id').references(() => users.id), // Who verified the identifier\n  verification_method: varchar('verification_method', { length: 100 }), // How it was verified (e.g., CMS portal, card scan, etc.)\n  verification_notes: text('verification_notes'), // Additional verification details\n\n  // Notes and documentation\n  notes: text('notes'), // General notes about this identifier\n\n  // Audit fields\n  created_by_id: text('created_by_id').references(() => users.id),\n  updated_by_id: text('updated_by_id').references(() => users.id),\n  deleted_at: timestamp('deleted_at'), // Soft delete\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n}, (table) => ({\n  // Single column indexes for common lookups\n  patientIdx: index('idx_patient_identifiers_patient_id').on(table.patient_id),\n  typeIdx: index('idx_patient_identifiers_type').on(table.identifier_type),\n  valueIdx: index('idx_patient_identifiers_value').on(table.identifier_value),\n  facilityIdx: index('idx_patient_identifiers_facility_id').on(table.facility_id),\n  activeIdx: index('idx_patient_identifiers_is_active').on(table.is_active),\n\n  // Composite indexes for common query patterns\n  patientTypeIdx: index('idx_patient_identifiers_patient_type')\n    .on(table.patient_id, table.identifier_type),\n  patientActiveIdx: index('idx_patient_identifiers_patient_active')\n    .on(table.patient_id, table.is_active),\n  typeValueIdx: index('idx_patient_identifiers_type_value')\n    .on(table.identifier_type, table.identifier_value),\n  patientTypePrimaryIdx: index('idx_patient_identifiers_patient_type_primary')\n    .on(table.patient_id, table.identifier_type, table.is_primary),\n}));\n\n// Keep legacy export name for backwards compatibility\nexport const patientIdentifiers = patient_identifiers;\n"],"mappings":"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","ignoreList":[]}