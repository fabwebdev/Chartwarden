{"version":3,"names":["cov_26qxyqxl45","actualCoverage","db","chat_rooms","chat_messages","chat_participants","user_presence","eq","and","desc","lt","or","inArray","sql","isNull","nanoid","logger","DOMPurify","ChatController","createRoom","req","res","f","s","name","type","b","description","patientId","participantIds","body","userId","user","id","includes","status","json","success","error","length","existingRoom","select","created_at","from","innerJoin","room_id","where","is_active","user_id","groupBy","having","message","room","insert","values","patient_id","created_by","is_archived","returning","role","participantValues","map","participantId","getRooms","archived","query","whereConditions","push","rooms","updated_at","participant_count","last_message_at","leftJoin","is_deleted","orderBy","count","getRoom","params","participation","limit","participants","is_muted","joined_at","last_read_at","updateRoom","updateData","undefined","Date","updated","update","set","archiveRoom","archived_at","sendMessage","roomId","content","replyToId","trim","sanitizedContent","sanitize","ALLOWED_TAGS","ALLOWED_ATTR","sender_id","reply_to_id","data","getMessages","before","messages","parseInt","reverse","editMessage","is_edited","edited_at","deleteMessage","deleted_at","addParticipant","newUserId","existing","participant","removeParticipant","targetUserId","authorized","left_at","updateLastRead","messageId","last_read_message_id"],"sources":["Chat.controller.js"],"sourcesContent":["import { db } from '../config/db.drizzle.js';\nimport {\n  chat_rooms,\n  chat_messages,\n  chat_participants,\n  user_presence\n} from '../db/schemas/index.js';\nimport { eq, and, desc, lt, or, inArray, sql, isNull } from 'drizzle-orm';\nimport { nanoid } from 'nanoid';\nimport { logger } from '../utils/logger.js';\nimport DOMPurify from 'isomorphic-dompurify';\n\n/**\n * Chat Controller\n * Manages team chat rooms, messages, and participants\n *\n * HIPAA Compliance:\n * - All messages are sanitized for XSS prevention\n * - Patient care rooms require special authorization\n * - All operations are audited via database triggers\n * - Soft delete only - messages never hard deleted\n *\n * Endpoints:\n *   Rooms:\n *     - POST   /rooms                     - Create new chat room\n *     - GET    /rooms                     - Get user's active rooms\n *     - GET    /rooms/:id                 - Get room details\n *     - PUT    /rooms/:id                 - Update room settings\n *     - DELETE /rooms/:id                 - Archive room\n *\n *   Messages:\n *     - POST   /rooms/:id/messages        - Send message\n *     - GET    /rooms/:id/messages        - Get message history\n *     - PUT    /messages/:id              - Edit message\n *     - DELETE /messages/:id              - Soft delete message\n *\n *   Participants:\n *     - POST   /rooms/:id/participants    - Add participant\n *     - DELETE /rooms/:id/participants/:userId - Remove participant\n *     - PUT    /rooms/:id/read            - Update last read timestamp\n */\n\nclass ChatController {\n  // ============================================\n  // ROOM MANAGEMENT\n  // ============================================\n\n  /**\n   * POST /api/chat/rooms\n   * Create a new chat room\n   */\n  async createRoom(req, res) {\n    try {\n      const { name, type = 'group', description, patientId, participantIds = [] } = req.body;\n      const userId = req.user.id;\n\n      // Validate room type\n      if (!['direct', 'group', 'department', 'patient_care'].includes(type)) {\n        return res.status(400).json({\n          success: false,\n          error: 'Invalid room type'\n        });\n      }\n\n      // Patient care rooms require patient_id\n      if (type === 'patient_care' && !patientId) {\n        return res.status(400).json({\n          success: false,\n          error: 'Patient ID is required for patient care rooms'\n        });\n      }\n\n      // Direct messages require exactly one other participant\n      if (type === 'direct' && participantIds.length !== 1) {\n        return res.status(400).json({\n          success: false,\n          error: 'Direct messages require exactly one other participant'\n        });\n      }\n\n      // Check if direct message room already exists\n      if (type === 'direct') {\n        const existingRoom = await db\n          .select({\n            id: chat_rooms.id,\n            name: chat_rooms.name,\n            type: chat_rooms.type,\n            created_at: chat_rooms.created_at\n          })\n          .from(chat_rooms)\n          .innerJoin(\n            chat_participants,\n            eq(chat_rooms.id, chat_participants.room_id)\n          )\n          .where(\n            and(\n              eq(chat_rooms.type, 'direct'),\n              eq(chat_rooms.is_active, true),\n              inArray(chat_participants.user_id, [userId, participantIds[0]])\n            )\n          )\n          .groupBy(chat_rooms.id)\n          .having(sql`COUNT(DISTINCT ${chat_participants.user_id}) = 2`);\n\n        if (existingRoom.length > 0) {\n          return res.status(200).json({\n            success: true,\n            message: 'Direct message room already exists',\n            room: existingRoom[0]\n          });\n        }\n      }\n\n      // Create room\n      const [room] = await db\n        .insert(chat_rooms)\n        .values({\n          id: nanoid(),\n          name: type === 'direct' ? null : name,\n          type,\n          description,\n          patient_id: patientId || null,\n          created_by: userId,\n          is_active: true,\n          is_archived: false\n        })\n        .returning();\n\n      // Add creator as participant\n      await db.insert(chat_participants).values({\n        id: nanoid(),\n        room_id: room.id,\n        user_id: userId,\n        role: 'admin',\n        is_active: true\n      });\n\n      // Add other participants\n      if (participantIds.length > 0) {\n        const participantValues = participantIds.map(participantId => ({\n          id: nanoid(),\n          room_id: room.id,\n          user_id: participantId,\n          role: 'member',\n          is_active: true\n        }));\n\n        await db.insert(chat_participants).values(participantValues);\n      }\n\n      res.status(201).json({\n        success: true,\n        message: 'Chat room created successfully',\n        room\n      });\n    } catch (error) {\n      logger.error('Error creating chat room:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to create chat room',\n        message: error.message\n      });\n    }\n  }\n\n  /**\n   * GET /api/chat/rooms\n   * Get all active rooms for the current user\n   */\n  async getRooms(req, res) {\n    try {\n      const userId = req.user.id;\n      const { type, archived = false } = req.query;\n\n      const whereConditions = [\n        eq(chat_participants.user_id, userId),\n        eq(chat_participants.is_active, true)\n      ];\n\n      if (type) {\n        whereConditions.push(eq(chat_rooms.type, type));\n      }\n\n      whereConditions.push(eq(chat_rooms.is_archived, archived === 'true'));\n\n      const rooms = await db\n        .select({\n          id: chat_rooms.id,\n          name: chat_rooms.name,\n          type: chat_rooms.type,\n          description: chat_rooms.description,\n          patient_id: chat_rooms.patient_id,\n          is_archived: chat_rooms.is_archived,\n          created_at: chat_rooms.created_at,\n          updated_at: chat_rooms.updated_at,\n          participant_count: sql`COUNT(DISTINCT ${chat_participants.user_id})`,\n          last_message_at: sql`MAX(${chat_messages.created_at})`\n        })\n        .from(chat_rooms)\n        .innerJoin(\n          chat_participants,\n          eq(chat_rooms.id, chat_participants.room_id)\n        )\n        .leftJoin(\n          chat_messages,\n          and(\n            eq(chat_rooms.id, chat_messages.room_id),\n            eq(chat_messages.is_deleted, false)\n          )\n        )\n        .where(and(...whereConditions))\n        .groupBy(chat_rooms.id)\n        .orderBy(desc(sql`MAX(${chat_messages.created_at})`));\n\n      res.json({\n        success: true,\n        count: rooms.length,\n        rooms\n      });\n    } catch (error) {\n      logger.error('Error getting chat rooms:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to retrieve chat rooms',\n        message: error.message\n      });\n    }\n  }\n\n  /**\n   * GET /api/chat/rooms/:id\n   * Get room details with participants\n   */\n  async getRoom(req, res) {\n    try {\n      const { id } = req.params;\n      const userId = req.user.id;\n\n      // Verify user is a participant\n      const participation = await db\n        .select()\n        .from(chat_participants)\n        .where(\n          and(\n            eq(chat_participants.room_id, id),\n            eq(chat_participants.user_id, userId),\n            eq(chat_participants.is_active, true)\n          )\n        )\n        .limit(1);\n\n      if (participation.length === 0) {\n        return res.status(403).json({\n          success: false,\n          error: 'Not authorized to access this room'\n        });\n      }\n\n      const [room] = await db\n        .select()\n        .from(chat_rooms)\n        .where(eq(chat_rooms.id, id))\n        .limit(1);\n\n      if (!room) {\n        return res.status(404).json({\n          success: false,\n          error: 'Room not found'\n        });\n      }\n\n      // Get participants with user details\n      const participants = await db\n        .select({\n          id: chat_participants.id,\n          user_id: chat_participants.user_id,\n          role: chat_participants.role,\n          is_muted: chat_participants.is_muted,\n          joined_at: chat_participants.joined_at,\n          last_read_at: chat_participants.last_read_at\n        })\n        .from(chat_participants)\n        .where(\n          and(\n            eq(chat_participants.room_id, id),\n            eq(chat_participants.is_active, true)\n          )\n        );\n\n      res.json({\n        success: true,\n        room: {\n          ...room,\n          participants\n        }\n      });\n    } catch (error) {\n      logger.error('Error getting room details:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to retrieve room details',\n        message: error.message\n      });\n    }\n  }\n\n  /**\n   * PUT /api/chat/rooms/:id\n   * Update room settings\n   */\n  async updateRoom(req, res) {\n    try {\n      const { id } = req.params;\n      const { name, description } = req.body;\n      const userId = req.user.id;\n\n      // Verify user is admin of the room\n      const participation = await db\n        .select()\n        .from(chat_participants)\n        .where(\n          and(\n            eq(chat_participants.room_id, id),\n            eq(chat_participants.user_id, userId),\n            eq(chat_participants.role, 'admin'),\n            eq(chat_participants.is_active, true)\n          )\n        )\n        .limit(1);\n\n      if (participation.length === 0) {\n        return res.status(403).json({\n          success: false,\n          error: 'Not authorized to update this room'\n        });\n      }\n\n      const updateData = {};\n      if (name !== undefined) updateData.name = name;\n      if (description !== undefined) updateData.description = description;\n      updateData.updated_at = new Date();\n\n      const [updated] = await db\n        .update(chat_rooms)\n        .set(updateData)\n        .where(eq(chat_rooms.id, id))\n        .returning();\n\n      res.json({\n        success: true,\n        message: 'Room updated successfully',\n        room: updated\n      });\n    } catch (error) {\n      logger.error('Error updating room:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to update room',\n        message: error.message\n      });\n    }\n  }\n\n  /**\n   * DELETE /api/chat/rooms/:id\n   * Archive a room (soft delete)\n   */\n  async archiveRoom(req, res) {\n    try {\n      const { id } = req.params;\n      const userId = req.user.id;\n\n      // Verify user is admin\n      const participation = await db\n        .select()\n        .from(chat_participants)\n        .where(\n          and(\n            eq(chat_participants.room_id, id),\n            eq(chat_participants.user_id, userId),\n            eq(chat_participants.role, 'admin')\n          )\n        )\n        .limit(1);\n\n      if (participation.length === 0) {\n        return res.status(403).json({\n          success: false,\n          error: 'Not authorized to archive this room'\n        });\n      }\n\n      await db\n        .update(chat_rooms)\n        .set({\n          is_archived: true,\n          archived_at: new Date(),\n          updated_at: new Date()\n        })\n        .where(eq(chat_rooms.id, id));\n\n      res.json({\n        success: true,\n        message: 'Room archived successfully'\n      });\n    } catch (error) {\n      logger.error('Error archiving room:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to archive room',\n        message: error.message\n      });\n    }\n  }\n\n  // ============================================\n  // MESSAGE MANAGEMENT\n  // ============================================\n\n  /**\n   * POST /api/chat/rooms/:id/messages\n   * Send a message to a room\n   */\n  async sendMessage(req, res) {\n    try {\n      const { id: roomId } = req.params;\n      const { content, replyToId } = req.body;\n      const userId = req.user.id;\n\n      if (!content || content.trim().length === 0) {\n        return res.status(400).json({\n          success: false,\n          error: 'Message content is required'\n        });\n      }\n\n      // Verify user is participant\n      const participation = await db\n        .select()\n        .from(chat_participants)\n        .where(\n          and(\n            eq(chat_participants.room_id, roomId),\n            eq(chat_participants.user_id, userId),\n            eq(chat_participants.is_active, true)\n          )\n        )\n        .limit(1);\n\n      if (participation.length === 0) {\n        return res.status(403).json({\n          success: false,\n          error: 'Not authorized to send messages to this room'\n        });\n      }\n\n      // Sanitize content to prevent XSS\n      const sanitizedContent = DOMPurify.sanitize(content, {\n        ALLOWED_TAGS: [],\n        ALLOWED_ATTR: []\n      });\n\n      // Create message\n      const [message] = await db\n        .insert(chat_messages)\n        .values({\n          id: nanoid(),\n          room_id: roomId,\n          sender_id: userId,\n          content: sanitizedContent,\n          reply_to_id: replyToId || null,\n          is_deleted: false\n        })\n        .returning();\n\n      // Update room's updated_at timestamp\n      await db\n        .update(chat_rooms)\n        .set({ updated_at: new Date() })\n        .where(eq(chat_rooms.id, roomId));\n\n      res.status(201).json({\n        success: true,\n        message: 'Message sent successfully',\n        data: message\n      });\n    } catch (error) {\n      logger.error('Error sending message:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to send message',\n        message: error.message\n      });\n    }\n  }\n\n  /**\n   * GET /api/chat/rooms/:id/messages\n   * Get message history with pagination\n   */\n  async getMessages(req, res) {\n    try {\n      const { id: roomId } = req.params;\n      const { limit = 50, before } = req.query;\n      const userId = req.user.id;\n\n      // Verify user is participant\n      const participation = await db\n        .select()\n        .from(chat_participants)\n        .where(\n          and(\n            eq(chat_participants.room_id, roomId),\n            eq(chat_participants.user_id, userId),\n            eq(chat_participants.is_active, true)\n          )\n        )\n        .limit(1);\n\n      if (participation.length === 0) {\n        return res.status(403).json({\n          success: false,\n          error: 'Not authorized to access this room'\n        });\n      }\n\n      const whereConditions = [\n        eq(chat_messages.room_id, roomId),\n        eq(chat_messages.is_deleted, false)\n      ];\n\n      if (before) {\n        whereConditions.push(lt(chat_messages.created_at, new Date(before)));\n      }\n\n      const messages = await db\n        .select()\n        .from(chat_messages)\n        .where(and(...whereConditions))\n        .orderBy(desc(chat_messages.created_at))\n        .limit(parseInt(limit));\n\n      res.json({\n        success: true,\n        count: messages.length,\n        messages: messages.reverse() // Return in chronological order\n      });\n    } catch (error) {\n      logger.error('Error getting messages:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to retrieve messages',\n        message: error.message\n      });\n    }\n  }\n\n  /**\n   * PUT /api/chat/messages/:id\n   * Edit a message\n   */\n  async editMessage(req, res) {\n    try {\n      const { id } = req.params;\n      const { content } = req.body;\n      const userId = req.user.id;\n\n      if (!content || content.trim().length === 0) {\n        return res.status(400).json({\n          success: false,\n          error: 'Message content is required'\n        });\n      }\n\n      // Verify user is the sender\n      const [message] = await db\n        .select()\n        .from(chat_messages)\n        .where(eq(chat_messages.id, id))\n        .limit(1);\n\n      if (!message) {\n        return res.status(404).json({\n          success: false,\n          error: 'Message not found'\n        });\n      }\n\n      if (message.sender_id !== userId) {\n        return res.status(403).json({\n          success: false,\n          error: 'Not authorized to edit this message'\n        });\n      }\n\n      // Sanitize content\n      const sanitizedContent = DOMPurify.sanitize(content, {\n        ALLOWED_TAGS: [],\n        ALLOWED_ATTR: []\n      });\n\n      const [updated] = await db\n        .update(chat_messages)\n        .set({\n          content: sanitizedContent,\n          is_edited: true,\n          edited_at: new Date(),\n          updated_at: new Date()\n        })\n        .where(eq(chat_messages.id, id))\n        .returning();\n\n      res.json({\n        success: true,\n        message: 'Message updated successfully',\n        data: updated\n      });\n    } catch (error) {\n      logger.error('Error editing message:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to edit message',\n        message: error.message\n      });\n    }\n  }\n\n  /**\n   * DELETE /api/chat/messages/:id\n   * Soft delete a message (HIPAA compliance)\n   */\n  async deleteMessage(req, res) {\n    try {\n      const { id } = req.params;\n      const userId = req.user.id;\n\n      // Verify user is the sender\n      const [message] = await db\n        .select()\n        .from(chat_messages)\n        .where(eq(chat_messages.id, id))\n        .limit(1);\n\n      if (!message) {\n        return res.status(404).json({\n          success: false,\n          error: 'Message not found'\n        });\n      }\n\n      if (message.sender_id !== userId) {\n        return res.status(403).json({\n          success: false,\n          error: 'Not authorized to delete this message'\n        });\n      }\n\n      await db\n        .update(chat_messages)\n        .set({\n          is_deleted: true,\n          deleted_at: new Date(),\n          updated_at: new Date()\n        })\n        .where(eq(chat_messages.id, id));\n\n      res.json({\n        success: true,\n        message: 'Message deleted successfully'\n      });\n    } catch (error) {\n      logger.error('Error deleting message:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to delete message',\n        message: error.message\n      });\n    }\n  }\n\n  // ============================================\n  // PARTICIPANT MANAGEMENT\n  // ============================================\n\n  /**\n   * POST /api/chat/rooms/:id/participants\n   * Add a participant to a room\n   */\n  async addParticipant(req, res) {\n    try {\n      const { id: roomId } = req.params;\n      const { userId: newUserId } = req.body;\n      const userId = req.user.id;\n\n      // Verify requester is admin\n      const participation = await db\n        .select()\n        .from(chat_participants)\n        .where(\n          and(\n            eq(chat_participants.room_id, roomId),\n            eq(chat_participants.user_id, userId),\n            eq(chat_participants.role, 'admin')\n          )\n        )\n        .limit(1);\n\n      if (participation.length === 0) {\n        return res.status(403).json({\n          success: false,\n          error: 'Not authorized to add participants'\n        });\n      }\n\n      // Check if already a participant\n      const existing = await db\n        .select()\n        .from(chat_participants)\n        .where(\n          and(\n            eq(chat_participants.room_id, roomId),\n            eq(chat_participants.user_id, newUserId)\n          )\n        )\n        .limit(1);\n\n      if (existing.length > 0) {\n        if (existing[0].is_active) {\n          return res.status(400).json({\n            success: false,\n            error: 'User is already a participant'\n          });\n        }\n\n        // Reactivate participation\n        await db\n          .update(chat_participants)\n          .set({\n            is_active: true,\n            joined_at: new Date(),\n            updated_at: new Date()\n          })\n          .where(eq(chat_participants.id, existing[0].id));\n\n        return res.json({\n          success: true,\n          message: 'Participant re-added successfully'\n        });\n      }\n\n      // Add new participant\n      const [participant] = await db\n        .insert(chat_participants)\n        .values({\n          id: nanoid(),\n          room_id: roomId,\n          user_id: newUserId,\n          role: 'member',\n          is_active: true\n        })\n        .returning();\n\n      res.status(201).json({\n        success: true,\n        message: 'Participant added successfully',\n        participant\n      });\n    } catch (error) {\n      logger.error('Error adding participant:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to add participant',\n        message: error.message\n      });\n    }\n  }\n\n  /**\n   * DELETE /api/chat/rooms/:id/participants/:userId\n   * Remove a participant from a room\n   */\n  async removeParticipant(req, res) {\n    try {\n      const { id: roomId, userId: targetUserId } = req.params;\n      const userId = req.user.id;\n\n      // User can remove themselves, or admin can remove others\n      let authorized = targetUserId === userId;\n\n      if (!authorized) {\n        const participation = await db\n          .select()\n          .from(chat_participants)\n          .where(\n            and(\n              eq(chat_participants.room_id, roomId),\n              eq(chat_participants.user_id, userId),\n              eq(chat_participants.role, 'admin')\n            )\n          )\n          .limit(1);\n\n        authorized = participation.length > 0;\n      }\n\n      if (!authorized) {\n        return res.status(403).json({\n          success: false,\n          error: 'Not authorized to remove participants'\n        });\n      }\n\n      await db\n        .update(chat_participants)\n        .set({\n          is_active: false,\n          left_at: new Date(),\n          updated_at: new Date()\n        })\n        .where(\n          and(\n            eq(chat_participants.room_id, roomId),\n            eq(chat_participants.user_id, targetUserId)\n          )\n        );\n\n      res.json({\n        success: true,\n        message: 'Participant removed successfully'\n      });\n    } catch (error) {\n      logger.error('Error removing participant:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to remove participant',\n        message: error.message\n      });\n    }\n  }\n\n  /**\n   * PUT /api/chat/rooms/:id/read\n   * Update last read timestamp for a room\n   */\n  async updateLastRead(req, res) {\n    try {\n      const { id: roomId } = req.params;\n      const { messageId } = req.body;\n      const userId = req.user.id;\n\n      await db\n        .update(chat_participants)\n        .set({\n          last_read_at: new Date(),\n          last_read_message_id: messageId || null,\n          updated_at: new Date()\n        })\n        .where(\n          and(\n            eq(chat_participants.room_id, roomId),\n            eq(chat_participants.user_id, userId)\n          )\n        );\n\n      res.json({\n        success: true,\n        message: 'Last read updated successfully'\n      });\n    } catch (error) {\n      logger.error('Error updating last read:', error);\n      res.status(500).json({\n        success: false,\n        error: 'Failed to update last read',\n        message: error.message\n      });\n    }\n  }\n}\n\nexport default new ChatController();\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}