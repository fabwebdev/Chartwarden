{"version":3,"names":["cov_23cszva6eq","actualCoverage","permissionConfig","PermissionService","constructor","f","s","config","permissions","Map","roles","registerPermission","name","description","b","set","createdAt","Date","registerRole","hasPermission","user","permission","includes","roleName","role","get","hasRole","getPermissions","Array","from","values","getRoles","getRolePermissions"],"sources":["PermissionService.js"],"sourcesContent":["import permissionConfig from \"../config/permission.config.js\";\n\nclass PermissionService {\n  constructor() {\n    this.config = permissionConfig;\n    this.permissions = new Map();\n    this.roles = new Map();\n  }\n\n  /**\n   * Register a permission\n   * @param {string} name - Permission name\n   * @param {string} description - Permission description\n   */\n  registerPermission(name, description = \"\") {\n    this.permissions.set(name, {\n      name: name,\n      description: description,\n      createdAt: new Date(),\n    });\n  }\n\n  /**\n   * Register a role\n   * @param {string} name - Role name\n   * @param {Array} permissions - Array of permission names\n   */\n  registerRole(name, permissions = []) {\n    this.roles.set(name, {\n      name: name,\n      permissions: permissions,\n      createdAt: new Date(),\n    });\n  }\n\n  /**\n   * Check if a user has a permission\n   * @param {Object} user - User object\n   * @param {string} permission - Permission name\n   * @returns {boolean} True if user has permission\n   */\n  hasPermission(user, permission) {\n    // This is a simplified implementation\n    // In practice, you would check the user's roles and permissions in the database\n    if (!user || !user.roles) {\n      return false;\n    }\n\n    // Check if user has the permission directly\n    if (user.permissions && user.permissions.includes(permission)) {\n      return true;\n    }\n\n    // Check if user's roles have the permission\n    for (const roleName of user.roles) {\n      const role = this.roles.get(roleName);\n      if (role && role.permissions.includes(permission)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Check if a user has a role\n   * @param {Object} user - User object\n   * @param {string} role - Role name\n   * @returns {boolean} True if user has role\n   */\n  hasRole(user, role) {\n    if (!user || !user.roles) {\n      return false;\n    }\n\n    return user.roles.includes(role);\n  }\n\n  /**\n   * Get all permissions\n   * @returns {Array} Array of permissions\n   */\n  getPermissions() {\n    return Array.from(this.permissions.values());\n  }\n\n  /**\n   * Get all roles\n   * @returns {Array} Array of roles\n   */\n  getRoles() {\n    return Array.from(this.roles.values());\n  }\n\n  /**\n   * Get permissions for a role\n   * @param {string} roleName - Role name\n   * @returns {Array} Array of permission names\n   */\n  getRolePermissions(roleName) {\n    const role = this.roles.get(roleName);\n    return role ? role.permissions : [];\n  }\n}\n\nexport default new PermissionService();\n"],"mappings":"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","ignoreList":[]}