{"version":3,"names":["cov_2gr0utqcdb","actualCoverage","controller","PERMISSIONS","requireAnyPermission","excelReportRoutes","fastify","options","f","s","get","preHandler","VIEW_REPORTS","getReportTypes","bind","VIEW_PATIENT_DETAILS","VIEW_CLINICAL_NOTES","exportCensusReport","exportARAgingReport","exportBillingReport","exportStaffReport","exportQAPIReport","exportExecutiveDashboard","post","exportAnalyticsReport","exportCustomReport"],"sources":["excelReport.routes.js"],"sourcesContent":["import controller from '../controllers/ExcelReport.controller.js';\nimport { PERMISSIONS } from '../config/rbac.js';\nimport { requireAnyPermission } from '../middleware/rbac.middleware.js';\n\n/**\n * Excel Report Routes\n * Provides Excel export endpoints for all report types\n *\n * Features:\n * - Multiple worksheet Excel exports\n * - Professional formatting with styles\n * - All report types supported (Census, Billing, Staff, QAPI, Analytics)\n * - Streaming file downloads\n *\n * Endpoints:\n * - GET /api/excel-reports/types - Get available report types\n * - GET /api/excel-reports/census - Export census report\n * - GET /api/excel-reports/ar-aging - Export AR aging report\n * - GET /api/excel-reports/billing - Export billing report\n * - GET /api/excel-reports/staff - Export staff report\n * - GET /api/excel-reports/qapi - Export QAPI report\n * - GET /api/excel-reports/executive-dashboard - Export executive dashboard\n * - POST /api/excel-reports/analytics - Export analytics report\n * - POST /api/excel-reports/custom - Export custom report\n */\nexport default async function excelReportRoutes(fastify, options) {\n\n    // Get available report types\n    fastify.get('/excel-reports/types', {\n        preHandler: [requireAnyPermission(PERMISSIONS.VIEW_REPORTS)]\n    }, controller.getReportTypes.bind(controller));\n\n    // Export Census Report\n    fastify.get('/excel-reports/census', {\n        preHandler: [requireAnyPermission(\n            PERMISSIONS.VIEW_PATIENT_DETAILS,\n            PERMISSIONS.VIEW_CLINICAL_NOTES,\n            PERMISSIONS.VIEW_REPORTS\n        )]\n    }, controller.exportCensusReport.bind(controller));\n\n    // Export AR Aging Report\n    fastify.get('/excel-reports/ar-aging', {\n        preHandler: [requireAnyPermission(\n            PERMISSIONS.VIEW_CLINICAL_NOTES,\n            PERMISSIONS.VIEW_REPORTS\n        )]\n    }, controller.exportARAgingReport.bind(controller));\n\n    // Export Billing Report (multiple sheets)\n    fastify.get('/excel-reports/billing', {\n        preHandler: [requireAnyPermission(\n            PERMISSIONS.VIEW_CLINICAL_NOTES,\n            PERMISSIONS.VIEW_REPORTS\n        )]\n    }, controller.exportBillingReport.bind(controller));\n\n    // Export Staff Report (multiple sheets)\n    fastify.get('/excel-reports/staff', {\n        preHandler: [requireAnyPermission(\n            PERMISSIONS.VIEW_CLINICAL_NOTES,\n            PERMISSIONS.VIEW_REPORTS\n        )]\n    }, controller.exportStaffReport.bind(controller));\n\n    // Export QAPI Report (multiple sheets)\n    fastify.get('/excel-reports/qapi', {\n        preHandler: [requireAnyPermission(\n            PERMISSIONS.VIEW_CLINICAL_NOTES,\n            PERMISSIONS.VIEW_REPORTS\n        )]\n    }, controller.exportQAPIReport.bind(controller));\n\n    // Export Executive Dashboard\n    fastify.get('/excel-reports/executive-dashboard', {\n        preHandler: [requireAnyPermission(\n            PERMISSIONS.VIEW_CLINICAL_NOTES,\n            PERMISSIONS.VIEW_REPORTS\n        )]\n    }, controller.exportExecutiveDashboard.bind(controller));\n\n    // Export Analytics Report\n    fastify.post('/excel-reports/analytics', {\n        preHandler: [requireAnyPermission(PERMISSIONS.VIEW_REPORTS)]\n    }, controller.exportAnalyticsReport.bind(controller));\n\n    // Export Custom Report\n    fastify.post('/excel-reports/custom', {\n        preHandler: [requireAnyPermission(PERMISSIONS.VIEW_REPORTS)]\n    }, controller.exportCustomReport.bind(controller));\n}\n"],"mappings":"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","ignoreList":[]}