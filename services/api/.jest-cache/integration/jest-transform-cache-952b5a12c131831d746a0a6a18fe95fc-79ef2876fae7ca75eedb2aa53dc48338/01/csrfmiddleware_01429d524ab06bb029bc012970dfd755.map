{"version":3,"names":["cov_21nv951r5i","actualCoverage","csrfExemptRoutes","s","shouldSkipCsrf","url","f","includes","b","startsWith","betterAuthRoutes","some","route","csrfProtection","request","reply","process","env","NODE_ENV","DISABLE_CSRF","log","warn","csrfToken","headers","body","_csrf","query","method","code","status","error","message","hint","server","debug","csrfError","csrfAutoProtect","protectedMethods","send"],"sources":["csrf.middleware.js"],"sourcesContent":["/**\n * CSRF Protection Middleware\n *\n * SECURITY: TICKET #004 - Prevent Cross-Site Request Forgery attacks\n * HIPAA: Supports ยง164.312(a)(1) - Access Control\n *\n * This middleware integrates with @fastify/csrf-protection plugin to provide\n * CSRF token validation for all state-changing operations (POST, PUT, DELETE, PATCH).\n *\n * Usage:\n *   // Option 1: Use fastify's built-in csrfProtection hook (recommended)\n *   fastify.post('/api/patients', { onRequest: fastify.csrfProtection }, handler);\n *\n *   // Option 2: Use this custom middleware for additional flexibility\n *   import { csrfProtection } from '../middleware/csrf.middleware.js';\n *   fastify.post('/api/patients', { preHandler: csrfProtection }, handler);\n */\n\n/**\n * Routes that should be exempt from CSRF protection\n * These are typically:\n * - Authentication endpoints (sign-in, sign-up) that don't have a session yet\n * - The CSRF token endpoint itself\n * - Health check endpoints\n */\nexport const csrfExemptRoutes = [\n  '/api/auth/csrf-token',\n  '/api/auth/sign-in',\n  '/api/auth/sign-up',\n  '/api/auth/sign-in/email',\n  '/api/auth/sign-out',\n  '/api/auth/check-password-strength', // Public password strength check\n  '/api/auth/password-policy', // Public password policy endpoint\n  '/api/auth/validate-password', // Password validation for registration\n  '/api/health',\n  '/health',\n  '/api/status',\n  // Validation test routes (development only)\n  '/api/validation-test'\n];\n\n/**\n * Check if a route should be exempt from CSRF protection\n * @param {string} url - The request URL\n * @returns {boolean} - True if the route should skip CSRF protection\n */\nfunction shouldSkipCsrf(url) {\n  // Exact match check\n  if (csrfExemptRoutes.includes(url)) {\n    return true;\n  }\n\n  // Prefix match for validation test routes (development only)\n  if (url.startsWith('/api/validation-test')) {\n    return true;\n  }\n\n  // Check for Better Auth internal routes (they have their own CSRF handling)\n  // Only skip specific Better Auth endpoints, not all /api/auth/* routes\n  const betterAuthRoutes = [\n    '/api/auth/get-session',\n    '/api/auth/session',\n    '/api/auth/callback'\n  ];\n\n  if (betterAuthRoutes.some(route => url.startsWith(route))) {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * CSRF Protection Pre-Handler\n * Validates CSRF token for state-changing requests\n *\n * @param {Object} request - Fastify request object\n * @param {Object} reply - Fastify reply object\n */\nexport async function csrfProtection(request, reply) {\n  try {\n    // Skip CSRF validation in development if explicitly disabled\n    if (process.env.NODE_ENV !== 'production' && process.env.DISABLE_CSRF === 'true') {\n      request.log.warn('CSRF protection disabled in development mode');\n      return;\n    }\n\n    // Check if route is exempt\n    if (shouldSkipCsrf(request.url)) {\n      return;\n    }\n\n    // Get CSRF token from request (multiple sources supported by @fastify/csrf-protection)\n    // The plugin checks: x-csrf-token header, _csrf in body, _csrf in query\n    const csrfToken =\n      request.headers['x-csrf-token'] ||\n      request.headers['csrf-token'] ||\n      request.headers['x-xsrf-token'] ||\n      request.body?._csrf ||\n      request.query?._csrf;\n\n    if (!csrfToken) {\n      request.log.warn({\n        url: request.url,\n        method: request.method\n      }, 'CSRF token missing from request');\n\n      reply.code(403);\n      return {\n        status: 403,\n        error: 'CSRF Token Missing',\n        message: 'CSRF token is required for this request. Please include the token in the x-csrf-token header.',\n        hint: 'Fetch a new token from GET /api/auth/csrf-token'\n      };\n    }\n\n    // Use fastify's csrfProtection hook to validate the token\n    // This is done by calling the hook directly if available\n    // The @fastify/csrf-protection plugin decorates fastify with csrfProtection\n    if (request.server.csrfProtection) {\n      try {\n        await request.server.csrfProtection(request, reply);\n        // If we get here without an error, the token is valid\n        request.log.debug({\n          url: request.url,\n          method: request.method\n        }, 'CSRF token validated');\n      } catch (csrfError) {\n        request.log.warn({\n          url: request.url,\n          method: request.method,\n          error: csrfError.message\n        }, 'CSRF token validation failed');\n\n        reply.code(403);\n        return {\n          status: 403,\n          error: 'Invalid CSRF Token',\n          message: 'CSRF token validation failed. The token may be expired or invalid.',\n          hint: 'Fetch a new token from GET /api/auth/csrf-token and retry the request'\n        };\n      }\n    }\n\n  } catch (error) {\n    request.log.error({ error }, 'CSRF validation error');\n    reply.code(403);\n    return {\n      status: 403,\n      error: 'CSRF Validation Error',\n      message: 'An error occurred while validating the CSRF token',\n      hint: 'Fetch a new token from GET /api/auth/csrf-token and retry the request'\n    };\n  }\n}\n\n/**\n * Auto-apply CSRF protection to all state-changing routes\n * This hook can be registered globally to protect all POST/PUT/DELETE/PATCH routes\n *\n * Usage:\n *   // Register as a global preHandler hook in server.js\n *   app.addHook('preHandler', csrfAutoProtect);\n *\n * @param {Object} request - Fastify request object\n * @param {Object} reply - Fastify reply object\n */\nexport async function csrfAutoProtect(request, reply) {\n  // Only protect state-changing HTTP methods\n  const protectedMethods = ['POST', 'PUT', 'DELETE', 'PATCH'];\n\n  if (!protectedMethods.includes(request.method)) {\n    return; // Skip CSRF for GET, HEAD, OPTIONS\n  }\n\n  // Skip CSRF validation in development if explicitly disabled\n  if (process.env.NODE_ENV !== 'production' && process.env.DISABLE_CSRF === 'true') {\n    return;\n  }\n\n  // Check if route is exempt\n  if (shouldSkipCsrf(request.url)) {\n    return;\n  }\n\n  // Get CSRF token from request headers or body\n  const csrfToken =\n    request.headers['x-csrf-token'] ||\n    request.headers['csrf-token'] ||\n    request.headers['x-xsrf-token'] ||\n    request.body?._csrf ||\n    request.query?._csrf;\n\n  if (!csrfToken) {\n    request.log.warn({\n      url: request.url,\n      method: request.method\n    }, 'CSRF token missing from request');\n\n    reply.code(403);\n    return reply.send({\n      status: 403,\n      error: 'CSRF Token Missing',\n      message: 'CSRF token is required for this request. Please include the token in the x-csrf-token header.',\n      hint: 'Fetch a new token from GET /api/auth/csrf-token'\n    });\n  }\n\n  // Use fastify's csrfProtection hook to validate the token\n  if (request.server.csrfProtection) {\n    try {\n      await request.server.csrfProtection(request, reply);\n      // Token is valid - continue to route handler\n      request.log.debug({\n        url: request.url,\n        method: request.method\n      }, 'CSRF token validated');\n    } catch (csrfError) {\n      request.log.warn({\n        url: request.url,\n        method: request.method,\n        error: csrfError.message\n      }, 'CSRF token validation failed');\n\n      reply.code(403);\n      return reply.send({\n        status: 403,\n        error: 'Invalid CSRF Token',\n        message: 'CSRF token validation failed. The token may be expired or invalid.',\n        hint: 'Fetch a new token from GET /api/auth/csrf-token and retry the request'\n      });\n    }\n  }\n}\n\nexport default csrfProtection;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}