{"version":3,"names":["cov_vc4v79gjs","actualCoverage","pgTable","bigint","varchar","text","boolean","timestamp","index","users","patients","nursing_clinical_notes","s","id","mode","primaryKey","generatedByDefaultAsIdentity","patient_id","references","f","benefit_period_id","note_date","length","note_timestamp","defaultNow","time_in","time_out","patient_name","patient_number","dob","location_name","location_number","benefit_period","prn_visit","default","patient_identifiers","nurse_id","nurse_name","nurse_credentials","note_status","notNull","content","content_format","subjective","objective","assessment","plan","interventions","patient_response","patient_education","communication","signed_at","signed_by_id","signature_hash","cosigned_at","cosigned_by_id","amended","amendment_reason","amended_at","amended_by_id","created_by_id","updated_by_id","deleted_at","createdAt","updatedAt","table","patientIdx","on","nurseIdx","statusIdx","noteDateIdx","timestampIdx","benefitPeriodIdx","patientStatusIdx","nurseStatusIdx"],"sources":["nursingClinicalNote.schema.js"],"sourcesContent":["import { pgTable, bigint, varchar, text, boolean, timestamp, index } from 'drizzle-orm/pg-core';\nimport { users } from './user.schema.js';\nimport { patients } from './patient.schema.js';\n\n// ============================================================================\n// NURSING CLINICAL NOTES TABLE\n// ============================================================================\n// Clinical documentation for nursing visits\n// Supports rich text content, timestamps, nurse tracking, and note status\n// ============================================================================\n\n/**\n * Nursing Clinical Notes - Main nursing documentation table\n * Stores clinical observations, assessments, and care provided during nursing visits\n */\nexport const nursing_clinical_notes = pgTable('nursing_clinical_notes', {\n  id: bigint('id', { mode: 'number' }).primaryKey().generatedByDefaultAsIdentity(),\n\n  // Patient and benefit period references\n  patient_id: bigint('patient_id', { mode: 'number' }).references(() => patients.id),\n  benefit_period_id: bigint('benefit_period_id', { mode: 'number' }),\n\n  // Note timing\n  note_date: varchar('note_date', { length: 255 }),\n  note_timestamp: timestamp('note_timestamp').defaultNow(), // Precise timestamp for when note was created\n  time_in: varchar('time_in', { length: 255 }),\n  time_out: varchar('time_out', { length: 255 }),\n\n  // Patient information (denormalized for quick access)\n  patient_name: varchar('patient_name', { length: 255 }),\n  patient_number: varchar('patient_number', { length: 255 }),\n  dob: varchar('dob', { length: 255 }),\n\n  // Location information\n  location_name: varchar('location_name', { length: 255 }),\n  location_number: varchar('location_number', { length: 255 }),\n\n  // Benefit period text\n  benefit_period: text('benefit_period'),\n\n  // Visit type\n  prn_visit: boolean('prn_visit').default(false),\n\n  // Patient identifiers JSON\n  patient_identifiers: text('patient_identifiers'),\n\n  // ============================================================================\n  // NEW FIELDS - Rich text content, nurse ID, and note status\n  // ============================================================================\n\n  // Nurse who created/authored the note\n  nurse_id: text('nurse_id').references(() => users.id),\n  nurse_name: varchar('nurse_name', { length: 255 }),\n  nurse_credentials: varchar('nurse_credentials', { length: 100 }), // RN, LPN, etc.\n\n  // Note status workflow\n  note_status: varchar('note_status', { length: 50 }).default('DRAFT').notNull(),\n  // Possible statuses: DRAFT, IN_PROGRESS, COMPLETED, PENDING_SIGNATURE, SIGNED, AMENDED, VOID\n\n  // Rich text clinical content (HTML/JSON for rich text editor)\n  content: text('content'), // Main rich text note content\n  content_format: varchar('content_format', { length: 20 }).default('html'), // html, json, markdown\n\n  // SOAP documentation sections (rich text)\n  subjective: text('subjective'), // Patient's report, symptoms, complaints\n  objective: text('objective'), // Clinical findings, observations, measurements\n  assessment: text('assessment'), // Clinical assessment, evaluation\n  plan: text('plan'), // Care plan, interventions, follow-up\n\n  // Additional clinical sections (rich text)\n  interventions: text('interventions'), // Nursing interventions performed\n  patient_response: text('patient_response'), // Patient response to interventions\n  patient_education: text('patient_education'), // Education provided\n  communication: text('communication'), // Communication with team/family\n\n  // Signature tracking (21 CFR Part 11 compliance)\n  signed_at: timestamp('signed_at'),\n  signed_by_id: text('signed_by_id').references(() => users.id),\n  signature_hash: varchar('signature_hash', { length: 64 }), // SHA-256 hash\n\n  // Cosignature (for supervision)\n  cosigned_at: timestamp('cosigned_at'),\n  cosigned_by_id: text('cosigned_by_id').references(() => users.id),\n\n  // Amendment tracking\n  amended: boolean('amended').default(false),\n  amendment_reason: text('amendment_reason'),\n  amended_at: timestamp('amended_at'),\n  amended_by_id: text('amended_by_id').references(() => users.id),\n\n  // Audit fields\n  created_by_id: text('created_by_id').references(() => users.id),\n  updated_by_id: text('updated_by_id').references(() => users.id),\n  deleted_at: timestamp('deleted_at'), // Soft delete\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n}, (table) => ({\n  // Performance indexes\n  patientIdx: index('idx_nursing_notes_patient_id').on(table.patient_id),\n  nurseIdx: index('idx_nursing_notes_nurse_id').on(table.nurse_id),\n  statusIdx: index('idx_nursing_notes_status').on(table.note_status),\n  noteDateIdx: index('idx_nursing_notes_date').on(table.note_date),\n  timestampIdx: index('idx_nursing_notes_timestamp').on(table.note_timestamp),\n  benefitPeriodIdx: index('idx_nursing_notes_benefit_period').on(table.benefit_period_id),\n\n  // Composite indexes for common queries\n  patientStatusIdx: index('idx_nursing_notes_patient_status').on(table.patient_id, table.note_status),\n  nurseStatusIdx: index('idx_nursing_notes_nurse_status').on(table.nurse_id, table.note_status),\n}));"],"mappings":"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","ignoreList":[]}