{"version":3,"names":["cov_1uuif6np4","actualCoverage","logger","s","originMiddleware","request","reply","f","headers","origin","b","baseURL","process","env","BETTER_AUTH_URL","host","url","URL","info"],"sources":["origin.middleware.js"],"sourcesContent":["import { logger } from '../utils/logger.js';\n\n/**\n * Middleware to add Origin header if missing\n * Better Auth requires Origin header, but Postman/API clients don't send it by default\n * This adds a default Origin header for testing purposes\n */\nconst originMiddleware = async (request, reply) => {\n  // Only add Origin if it's missing (for Postman/testing)\n  if (!request.headers.origin) {\n    // Use the baseURL from Better Auth config or request host\n    const baseURL = process.env.BETTER_AUTH_URL || `https://${request.headers.host}`;\n    const url = new URL(baseURL);\n    request.headers.origin = url.origin;\n    logger.info(`⚠️  Added default Origin header for testing: ${request.headers.origin}`)\n  }\n};\n\nexport default originMiddleware;\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AAfZ,SAASE,MAAM,QAAQ,oBAAoB;;AAE3C;AACA;AACA;AACA;AACA;AAJA;AAAAF,aAAA,GAAAG,CAAA;AAKA,MAAMC,gBAAgB,GAAG,MAAAA,CAAOC,OAAO,EAAEC,KAAK,KAAK;EAAA;EAAAN,aAAA,GAAAO,CAAA;EAAAP,aAAA,GAAAG,CAAA;EACjD;EACA,IAAI,CAACE,OAAO,CAACG,OAAO,CAACC,MAAM,EAAE;IAAA;IAAAT,aAAA,GAAAU,CAAA;IAC3B;IACA,MAAMC,OAAO;IAAA;IAAA,CAAAX,aAAA,GAAAG,CAAA;IAAG;IAAA,CAAAH,aAAA,GAAAU,CAAA,UAAAE,OAAO,CAACC,GAAG,CAACC,eAAe;IAAA;IAAA,CAAAd,aAAA,GAAAU,CAAA,UAAI,WAAWL,OAAO,CAACG,OAAO,CAACO,IAAI,EAAE;IAChF,MAAMC,GAAG;IAAA;IAAA,CAAAhB,aAAA,GAAAG,CAAA,OAAG,IAAIc,GAAG,CAACN,OAAO,CAAC;IAAC;IAAAX,aAAA,GAAAG,CAAA;IAC7BE,OAAO,CAACG,OAAO,CAACC,MAAM,GAAGO,GAAG,CAACP,MAAM;IAAC;IAAAT,aAAA,GAAAG,CAAA;IACpCD,MAAM,CAACgB,IAAI,CAAC,gDAAgDb,OAAO,CAACG,OAAO,CAACC,MAAM,EAAE,CAAC;EACvF,CAAC;EAAA;EAAA;IAAAT,aAAA,GAAAU,CAAA;EAAA;AACH,CAAC;AAED,eAAeN,gBAAgB","ignoreList":[]}