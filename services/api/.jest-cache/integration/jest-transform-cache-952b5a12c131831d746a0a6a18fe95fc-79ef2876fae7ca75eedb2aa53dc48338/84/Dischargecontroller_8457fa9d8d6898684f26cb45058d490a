835e64946cceff0c31782f94007a4811
/* istanbul ignore next */
function cov_15sfut4phm() {
  var path = "/Users/fabrice/Sites/chartwarden/Chartwarden/services/api/src/controllers/patient/Discharge.controller.js";
  var hash = "567abed5d575d96a3b2edcfcdbff5e18d9f29b1b";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/fabrice/Sites/chartwarden/Chartwarden/services/api/src/controllers/patient/Discharge.controller.js",
    statementMap: {
      "0": {
        start: {
          line: 11,
          column: 8
        },
        end: {
          line: 41,
          column: 9
        }
      },
      "1": {
        start: {
          line: 12,
          column: 31
        },
        end: {
          line: 27,
          column: 30
        }
      },
      "2": {
        start: {
          line: 30,
          column: 12
        },
        end: {
          line: 30,
          column: 63
        }
      },
      "3": {
        start: {
          line: 32,
          column: 12
        },
        end: {
          line: 32,
          column: 28
        }
      },
      "4": {
        start: {
          line: 33,
          column: 12
        },
        end: {
          line: 33,
          column: 30
        }
      },
      "5": {
        start: {
          line: 35,
          column: 12
        },
        end: {
          line: 35,
          column: 61
        }
      },
      "6": {
        start: {
          line: 36,
          column: 12
        },
        end: {
          line: 36,
          column: 28
        }
      },
      "7": {
        start: {
          line: 37,
          column: 12
        },
        end: {
          line: 40,
          column: 14
        }
      },
      "8": {
        start: {
          line: 46,
          column: 8
        },
        end: {
          line: 72,
          column: 9
        }
      },
      "9": {
        start: {
          line: 47,
          column: 31
        },
        end: {
          line: 62,
          column: 30
        }
      },
      "10": {
        start: {
          line: 63,
          column: 12
        },
        end: {
          line: 63,
          column: 28
        }
      },
      "11": {
        start: {
          line: 64,
          column: 12
        },
        end: {
          line: 64,
          column: 30
        }
      },
      "12": {
        start: {
          line: 66,
          column: 12
        },
        end: {
          line: 66,
          column: 65
        }
      },
      "13": {
        start: {
          line: 67,
          column: 12
        },
        end: {
          line: 67,
          column: 28
        }
      },
      "14": {
        start: {
          line: 68,
          column: 12
        },
        end: {
          line: 71,
          column: 14
        }
      },
      "15": {
        start: {
          line: 77,
          column: 8
        },
        end: {
          line: 155,
          column: 9
        }
      },
      "16": {
        start: {
          line: 90,
          column: 16
        },
        end: {
          line: 90,
          column: 28
        }
      },
      "17": {
        start: {
          line: 93,
          column: 39
        },
        end: {
          line: 95,
          column: 25
        }
      },
      "18": {
        start: {
          line: 96,
          column: 38
        },
        end: {
          line: 96,
          column: 59
        }
      },
      "19": {
        start: {
          line: 99,
          column: 24
        },
        end: {
          line: 99,
          column: 34
        }
      },
      "20": {
        start: {
          line: 100,
          column: 34
        },
        end: {
          line: 116,
          column: 13
        }
      },
      "21": {
        start: {
          line: 120,
          column: 12
        },
        end: {
          line: 138,
          column: 13
        }
      },
      "22": {
        start: {
          line: 122,
          column: 16
        },
        end: {
          line: 125,
          column: 33
        }
      },
      "23": {
        start: {
          line: 126,
          column: 16
        },
        end: {
          line: 126,
          column: 35
        }
      },
      "24": {
        start: {
          line: 127,
          column: 16
        },
        end: {
          line: 127,
          column: 34
        }
      },
      "25": {
        start: {
          line: 130,
          column: 16
        },
        end: {
          line: 135,
          column: 33
        }
      },
      "26": {
        start: {
          line: 136,
          column: 16
        },
        end: {
          line: 136,
          column: 35
        }
      },
      "27": {
        start: {
          line: 137,
          column: 16
        },
        end: {
          line: 137,
          column: 34
        }
      },
      "28": {
        start: {
          line: 141,
          column: 12
        },
        end: {
          line: 141,
          column: 68
        }
      },
      "29": {
        start: {
          line: 143,
          column: 12
        },
        end: {
          line: 143,
          column: 28
        }
      },
      "30": {
        start: {
          line: 144,
          column: 12
        },
        end: {
          line: 147,
          column: 14
        }
      },
      "31": {
        start: {
          line: 149,
          column: 12
        },
        end: {
          line: 149,
          column: 59
        }
      },
      "32": {
        start: {
          line: 150,
          column: 12
        },
        end: {
          line: 150,
          column: 28
        }
      },
      "33": {
        start: {
          line: 151,
          column: 12
        },
        end: {
          line: 154,
          column: 14
        }
      },
      "34": {
        start: {
          line: 160,
          column: 8
        },
        end: {
          line: 202,
          column: 9
        }
      },
      "35": {
        start: {
          line: 161,
          column: 27
        },
        end: {
          line: 161,
          column: 41
        }
      },
      "36": {
        start: {
          line: 163,
          column: 31
        },
        end: {
          line: 180,
          column: 25
        }
      },
      "37": {
        start: {
          line: 181,
          column: 36
        },
        end: {
          line: 181,
          column: 49
        }
      },
      "38": {
        start: {
          line: 183,
          column: 12
        },
        end: {
          line: 188,
          column: 13
        }
      },
      "39": {
        start: {
          line: 184,
          column: 16
        },
        end: {
          line: 184,
          column: 32
        }
      },
      "40": {
        start: {
          line: 185,
          column: 12
        },
        end: {
          line: 187,
          column: 18
        }
      },
      "41": {
        start: {
          line: 191,
          column: 12
        },
        end: {
          line: 191,
          column: 77
        }
      },
      "42": {
        start: {
          line: 193,
          column: 12
        },
        end: {
          line: 193,
          column: 28
        }
      },
      "43": {
        start: {
          line: 194,
          column: 12
        },
        end: {
          line: 194,
          column: 35
        }
      },
      "44": {
        start: {
          line: 196,
          column: 12
        },
        end: {
          line: 196,
          column: 60
        }
      },
      "45": {
        start: {
          line: 197,
          column: 12
        },
        end: {
          line: 197,
          column: 28
        }
      },
      "46": {
        start: {
          line: 198,
          column: 12
        },
        end: {
          line: 201,
          column: 14
        }
      },
      "47": {
        start: {
          line: 207,
          column: 8
        },
        end: {
          line: 224,
          column: 9
        }
      },
      "48": {
        start: {
          line: 208,
          column: 38
        },
        end: {
          line: 214,
          column: 39
        }
      },
      "49": {
        start: {
          line: 215,
          column: 12
        },
        end: {
          line: 215,
          column: 28
        }
      },
      "50": {
        start: {
          line: 216,
          column: 12
        },
        end: {
          line: 216,
          column: 37
        }
      },
      "51": {
        start: {
          line: 218,
          column: 12
        },
        end: {
          line: 218,
          column: 69
        }
      },
      "52": {
        start: {
          line: 219,
          column: 12
        },
        end: {
          line: 219,
          column: 28
        }
      },
      "53": {
        start: {
          line: 220,
          column: 12
        },
        end: {
          line: 223,
          column: 14
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 10,
            column: 4
          },
          end: {
            line: 10,
            column: 5
          }
        },
        loc: {
          start: {
            line: 10,
            column: 32
          },
          end: {
            line: 42,
            column: 5
          }
        },
        line: 10
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 45,
            column: 4
          },
          end: {
            line: 45,
            column: 5
          }
        },
        loc: {
          start: {
            line: 45,
            column: 40
          },
          end: {
            line: 73,
            column: 5
          }
        },
        line: 45
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 76,
            column: 4
          },
          end: {
            line: 76,
            column: 5
          }
        },
        loc: {
          start: {
            line: 76,
            column: 32
          },
          end: {
            line: 156,
            column: 5
          }
        },
        line: 76
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 159,
            column: 4
          },
          end: {
            line: 159,
            column: 5
          }
        },
        loc: {
          start: {
            line: 159,
            column: 31
          },
          end: {
            line: 203,
            column: 5
          }
        },
        line: 159
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 206,
            column: 4
          },
          end: {
            line: 206,
            column: 5
          }
        },
        loc: {
          start: {
            line: 206,
            column: 44
          },
          end: {
            line: 225,
            column: 5
          }
        },
        line: 206
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 102,
            column: 32
          },
          end: {
            line: 102,
            column: 54
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 102,
            column: 32
          },
          end: {
            line: 102,
            column: 46
          }
        }, {
          start: {
            line: 102,
            column: 50
          },
          end: {
            line: 102,
            column: 54
          }
        }],
        line: 102
      },
      "1": {
        loc: {
          start: {
            line: 104,
            column: 20
          },
          end: {
            line: 104,
            column: 56
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 104,
            column: 20
          },
          end: {
            line: 104,
            column: 48
          }
        }, {
          start: {
            line: 104,
            column: 52
          },
          end: {
            line: 104,
            column: 56
          }
        }],
        line: 104
      },
      "2": {
        loc: {
          start: {
            line: 105,
            column: 38
          },
          end: {
            line: 105,
            column: 66
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 105,
            column: 38
          },
          end: {
            line: 105,
            column: 58
          }
        }, {
          start: {
            line: 105,
            column: 62
          },
          end: {
            line: 105,
            column: 66
          }
        }],
        line: 105
      },
      "3": {
        loc: {
          start: {
            line: 106,
            column: 32
          },
          end: {
            line: 106,
            column: 54
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 106,
            column: 32
          },
          end: {
            line: 106,
            column: 46
          }
        }, {
          start: {
            line: 106,
            column: 50
          },
          end: {
            line: 106,
            column: 54
          }
        }],
        line: 106
      },
      "4": {
        loc: {
          start: {
            line: 107,
            column: 35
          },
          end: {
            line: 107,
            column: 60
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 107,
            column: 35
          },
          end: {
            line: 107,
            column: 52
          }
        }, {
          start: {
            line: 107,
            column: 56
          },
          end: {
            line: 107,
            column: 60
          }
        }],
        line: 107
      },
      "5": {
        loc: {
          start: {
            line: 108,
            column: 32
          },
          end: {
            line: 108,
            column: 54
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 108,
            column: 32
          },
          end: {
            line: 108,
            column: 46
          }
        }, {
          start: {
            line: 108,
            column: 50
          },
          end: {
            line: 108,
            column: 54
          }
        }],
        line: 108
      },
      "6": {
        loc: {
          start: {
            line: 109,
            column: 40
          },
          end: {
            line: 109,
            column: 70
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 109,
            column: 40
          },
          end: {
            line: 109,
            column: 62
          }
        }, {
          start: {
            line: 109,
            column: 66
          },
          end: {
            line: 109,
            column: 70
          }
        }],
        line: 109
      },
      "7": {
        loc: {
          start: {
            line: 110,
            column: 33
          },
          end: {
            line: 110,
            column: 56
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 110,
            column: 33
          },
          end: {
            line: 110,
            column: 48
          }
        }, {
          start: {
            line: 110,
            column: 52
          },
          end: {
            line: 110,
            column: 56
          }
        }],
        line: 110
      },
      "8": {
        loc: {
          start: {
            line: 111,
            column: 36
          },
          end: {
            line: 111,
            column: 62
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 111,
            column: 36
          },
          end: {
            line: 111,
            column: 54
          }
        }, {
          start: {
            line: 111,
            column: 58
          },
          end: {
            line: 111,
            column: 62
          }
        }],
        line: 111
      },
      "9": {
        loc: {
          start: {
            line: 112,
            column: 38
          },
          end: {
            line: 114,
            column: 50
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 113,
            column: 22
          },
          end: {
            line: 113,
            column: 52
          }
        }, {
          start: {
            line: 114,
            column: 22
          },
          end: {
            line: 114,
            column: 50
          }
        }],
        line: 112
      },
      "10": {
        loc: {
          start: {
            line: 114,
            column: 22
          },
          end: {
            line: 114,
            column: 50
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 114,
            column: 22
          },
          end: {
            line: 114,
            column: 42
          }
        }, {
          start: {
            line: 114,
            column: 46
          },
          end: {
            line: 114,
            column: 50
          }
        }],
        line: 114
      },
      "11": {
        loc: {
          start: {
            line: 120,
            column: 12
          },
          end: {
            line: 138,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 120,
            column: 12
          },
          end: {
            line: 138,
            column: 13
          }
        }, {
          start: {
            line: 128,
            column: 19
          },
          end: {
            line: 138,
            column: 13
          }
        }],
        line: 120
      },
      "12": {
        loc: {
          start: {
            line: 183,
            column: 12
          },
          end: {
            line: 188,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 183,
            column: 12
          },
          end: {
            line: 188,
            column: 13
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 183
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0],
      "11": [0, 0],
      "12": [0, 0]
    },
    inputSourceMap: null,
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "567abed5d575d96a3b2edcfcdbff5e18d9f29b1b"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_15sfut4phm = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_15sfut4phm();
import { db } from "../../config/db.drizzle.js";
import { discharge } from "../../db/schemas/discharge.schema.js";
import { discharge_sections } from "../../db/schemas/dischargeSection.schema.js";
import { eq } from "drizzle-orm";
import { logAudit } from "../../middleware/audit.middleware.js";
import { logger } from '../../utils/logger.js';
class DischargeController {
  // Get all discharges
  async index(request, reply) {
    /* istanbul ignore next */
    cov_15sfut4phm().f[0]++;
    cov_15sfut4phm().s[0]++;
    try {
      const discharges =
      /* istanbul ignore next */
      (cov_15sfut4phm().s[1]++, await db.select({
        id: discharge.id,
        patient_id: discharge.patient_id,
        type_of_record: discharge.type_of_record,
        national_provider_identifier: discharge.national_provider_identifier,
        certification_number: discharge.certification_number,
        admission_date: discharge.admission_date,
        reason_for_record: discharge.reason_for_record,
        discharge_date: discharge.discharge_date,
        social_security_number: discharge.social_security_number,
        medicare_number: discharge.medicare_number,
        medicaid_recipient: discharge.medicaid_recipient,
        reason_for_discharge: discharge.reason_for_discharge,
        createdAt: discharge.createdAt,
        updatedAt: discharge.updatedAt
      }).from(discharge));

      // Log audit - READ operation on discharge table
      /* istanbul ignore next */
      cov_15sfut4phm().s[2]++;
      await logAudit(request, 'READ', 'discharge', null);
      /* istanbul ignore next */
      cov_15sfut4phm().s[3]++;
      reply.code(200);
      /* istanbul ignore next */
      cov_15sfut4phm().s[4]++;
      return discharges;
    } catch (error) {
      /* istanbul ignore next */
      cov_15sfut4phm().s[5]++;
      logger.error("Error fetching discharges:", error);
      /* istanbul ignore next */
      cov_15sfut4phm().s[6]++;
      reply.code(500);
      /* istanbul ignore next */
      cov_15sfut4phm().s[7]++;
      return {
        message: "Internal server error",
        error: error.message
      };
    }
  }

  // Get all discharges (alias for index)
  async dischargeList(request, reply) {
    /* istanbul ignore next */
    cov_15sfut4phm().f[1]++;
    cov_15sfut4phm().s[8]++;
    try {
      const discharges =
      /* istanbul ignore next */
      (cov_15sfut4phm().s[9]++, await db.select({
        id: discharge.id,
        patient_id: discharge.patient_id,
        type_of_record: discharge.type_of_record,
        national_provider_identifier: discharge.national_provider_identifier,
        certification_number: discharge.certification_number,
        admission_date: discharge.admission_date,
        reason_for_record: discharge.reason_for_record,
        discharge_date: discharge.discharge_date,
        social_security_number: discharge.social_security_number,
        medicare_number: discharge.medicare_number,
        medicaid_recipient: discharge.medicaid_recipient,
        reason_for_discharge: discharge.reason_for_discharge,
        createdAt: discharge.createdAt,
        updatedAt: discharge.updatedAt
      }).from(discharge));
      /* istanbul ignore next */
      cov_15sfut4phm().s[10]++;
      reply.code(200);
      /* istanbul ignore next */
      cov_15sfut4phm().s[11]++;
      return discharges;
    } catch (error) {
      /* istanbul ignore next */
      cov_15sfut4phm().s[12]++;
      logger.error("Error fetching discharge list:", error);
      /* istanbul ignore next */
      cov_15sfut4phm().s[13]++;
      reply.code(500);
      /* istanbul ignore next */
      cov_15sfut4phm().s[14]++;
      return {
        message: "Internal server error",
        error: error.message
      };
    }
  }

  // Store or update discharge
  async store(request, reply) {
    /* istanbul ignore next */
    cov_15sfut4phm().f[2]++;
    cov_15sfut4phm().s[15]++;
    try {
      const {
        patient_id,
        type_of_record,
        national_provider_identifier,
        certification_number,
        admission_date,
        reason_for_record,
        discharge_date,
        social_security_number,
        medicare_number,
        medicaid_recipient,
        reason_for_discharge
      } =
      /* istanbul ignore next */
      (cov_15sfut4phm().s[16]++, request.body);

      // Find existing discharge for this patient
      const existingDischarges =
      /* istanbul ignore next */
      (cov_15sfut4phm().s[17]++, await db.select({
        id: discharge.id
      }).from(discharge).where(eq(discharge.patient_id, patient_id)).limit(1));
      const existingDischarge =
      /* istanbul ignore next */
      (cov_15sfut4phm().s[18]++, existingDischarges[0]);

      // Prepare data for update or create
      const now =
      /* istanbul ignore next */
      (cov_15sfut4phm().s[19]++, new Date());
      const dischargeData =
      /* istanbul ignore next */
      (cov_15sfut4phm().s[20]++, {
        patient_id: patient_id,
        type_of_record:
        /* istanbul ignore next */
        (cov_15sfut4phm().b[0][0]++, type_of_record) ||
        /* istanbul ignore next */
        (cov_15sfut4phm().b[0][1]++, null),
        national_provider_identifier:
        /* istanbul ignore next */
        (cov_15sfut4phm().b[1][0]++, national_provider_identifier) ||
        /* istanbul ignore next */
        (cov_15sfut4phm().b[1][1]++, null),
        certification_number:
        /* istanbul ignore next */
        (cov_15sfut4phm().b[2][0]++, certification_number) ||
        /* istanbul ignore next */
        (cov_15sfut4phm().b[2][1]++, null),
        admission_date:
        /* istanbul ignore next */
        (cov_15sfut4phm().b[3][0]++, admission_date) ||
        /* istanbul ignore next */
        (cov_15sfut4phm().b[3][1]++, null),
        reason_for_record:
        /* istanbul ignore next */
        (cov_15sfut4phm().b[4][0]++, reason_for_record) ||
        /* istanbul ignore next */
        (cov_15sfut4phm().b[4][1]++, null),
        discharge_date:
        /* istanbul ignore next */
        (cov_15sfut4phm().b[5][0]++, discharge_date) ||
        /* istanbul ignore next */
        (cov_15sfut4phm().b[5][1]++, null),
        social_security_number:
        /* istanbul ignore next */
        (cov_15sfut4phm().b[6][0]++, social_security_number) ||
        /* istanbul ignore next */
        (cov_15sfut4phm().b[6][1]++, null),
        medicare_number:
        /* istanbul ignore next */
        (cov_15sfut4phm().b[7][0]++, medicare_number) ||
        /* istanbul ignore next */
        (cov_15sfut4phm().b[7][1]++, null),
        medicaid_recipient:
        /* istanbul ignore next */
        (cov_15sfut4phm().b[8][0]++, medicaid_recipient) ||
        /* istanbul ignore next */
        (cov_15sfut4phm().b[8][1]++, null),
        reason_for_discharge: Array.isArray(reason_for_discharge) ?
        /* istanbul ignore next */
        (cov_15sfut4phm().b[9][0]++, reason_for_discharge.join(",")) :
        /* istanbul ignore next */
        (cov_15sfut4phm().b[9][1]++,
        /* istanbul ignore next */
        (cov_15sfut4phm().b[10][0]++, reason_for_discharge) ||
        /* istanbul ignore next */
        (cov_15sfut4phm().b[10][1]++, null)),
        updatedAt: now
      });
      let result;
      let action;
      /* istanbul ignore next */
      cov_15sfut4phm().s[21]++;
      if (existingDischarge) {
        /* istanbul ignore next */
        cov_15sfut4phm().b[11][0]++;
        cov_15sfut4phm().s[22]++;
        // Update existing discharge
        result = await db.update(discharge).set(dischargeData).where(eq(discharge.patient_id, patient_id)).returning();
        /* istanbul ignore next */
        cov_15sfut4phm().s[23]++;
        result = result[0];
        /* istanbul ignore next */
        cov_15sfut4phm().s[24]++;
        action = 'UPDATE';
      } else {
        /* istanbul ignore next */
        cov_15sfut4phm().b[11][1]++;
        cov_15sfut4phm().s[25]++;
        // Create new discharge
        result = await db.insert(discharge).values({
          ...dischargeData,
          createdAt: now
        }).returning();
        /* istanbul ignore next */
        cov_15sfut4phm().s[26]++;
        result = result[0];
        /* istanbul ignore next */
        cov_15sfut4phm().s[27]++;
        action = 'CREATE';
      }

      // Log audit - CREATE or UPDATE operation on discharge table
      /* istanbul ignore next */
      cov_15sfut4phm().s[28]++;
      await logAudit(request, action, 'discharge', result.id);
      /* istanbul ignore next */
      cov_15sfut4phm().s[29]++;
      reply.code(201);
      /* istanbul ignore next */
      cov_15sfut4phm().s[30]++;
      return {
        message: "Discharge created or updated successfully",
        data: result
      };
    } catch (error) {
      /* istanbul ignore next */
      cov_15sfut4phm().s[31]++;
      logger.error("Error storing discharge:", error);
      /* istanbul ignore next */
      cov_15sfut4phm().s[32]++;
      reply.code(500);
      /* istanbul ignore next */
      cov_15sfut4phm().s[33]++;
      return {
        message: "Internal server error",
        error: error.message
      };
    }
  }

  // Show discharge for a specific patient
  async show(request, reply) {
    /* istanbul ignore next */
    cov_15sfut4phm().f[3]++;
    cov_15sfut4phm().s[34]++;
    try {
      const {
        id
      } =
      /* istanbul ignore next */
      (cov_15sfut4phm().s[35]++, request.params);
      const discharges =
      /* istanbul ignore next */
      (cov_15sfut4phm().s[36]++, await db.select({
        id: discharge.id,
        patient_id: discharge.patient_id,
        type_of_record: discharge.type_of_record,
        national_provider_identifier: discharge.national_provider_identifier,
        certification_number: discharge.certification_number,
        admission_date: discharge.admission_date,
        reason_for_record: discharge.reason_for_record,
        discharge_date: discharge.discharge_date,
        social_security_number: discharge.social_security_number,
        medicare_number: discharge.medicare_number,
        medicaid_recipient: discharge.medicaid_recipient,
        reason_for_discharge: discharge.reason_for_discharge,
        createdAt: discharge.createdAt,
        updatedAt: discharge.updatedAt
      }).from(discharge).where(eq(discharge.patient_id, id)).limit(1));
      const dischargeRecord =
      /* istanbul ignore next */
      (cov_15sfut4phm().s[37]++, discharges[0]);
      /* istanbul ignore next */
      cov_15sfut4phm().s[38]++;
      if (!dischargeRecord) {
        /* istanbul ignore next */
        cov_15sfut4phm().b[12][0]++;
        cov_15sfut4phm().s[39]++;
        reply.code(404);
        /* istanbul ignore next */
        cov_15sfut4phm().s[40]++;
        return {
          error: "No discharge found for this patient"
        };
      } else
      /* istanbul ignore next */
      {
        cov_15sfut4phm().b[12][1]++;
      }

      // Log audit - READ operation on discharge table
      cov_15sfut4phm().s[41]++;
      await logAudit(request, 'READ', 'discharge', dischargeRecord.id);
      /* istanbul ignore next */
      cov_15sfut4phm().s[42]++;
      reply.code(200);
      /* istanbul ignore next */
      cov_15sfut4phm().s[43]++;
      return dischargeRecord;
    } catch (error) {
      /* istanbul ignore next */
      cov_15sfut4phm().s[44]++;
      logger.error("Error fetching discharge:", error);
      /* istanbul ignore next */
      cov_15sfut4phm().s[45]++;
      reply.code(500);
      /* istanbul ignore next */
      cov_15sfut4phm().s[46]++;
      return {
        message: "Internal server error",
        error: error.message
      };
    }
  }

  // Get all discharge sections
  async dischargeSections(request, reply) {
    /* istanbul ignore next */
    cov_15sfut4phm().f[4]++;
    cov_15sfut4phm().s[47]++;
    try {
      const dischargeSections =
      /* istanbul ignore next */
      (cov_15sfut4phm().s[48]++, await db.select({
        id: discharge_sections.id,
        name: discharge_sections.name,
        description: discharge_sections.description,
        createdAt: discharge_sections.createdAt,
        updatedAt: discharge_sections.updatedAt
      }).from(discharge_sections));
      /* istanbul ignore next */
      cov_15sfut4phm().s[49]++;
      reply.code(200);
      /* istanbul ignore next */
      cov_15sfut4phm().s[50]++;
      return dischargeSections;
    } catch (error) {
      /* istanbul ignore next */
      cov_15sfut4phm().s[51]++;
      logger.error("Error fetching discharge sections:", error);
      /* istanbul ignore next */
      cov_15sfut4phm().s[52]++;
      reply.code(500);
      /* istanbul ignore next */
      cov_15sfut4phm().s[53]++;
      return {
        message: "Internal server error",
        error: error.message
      };
    }
  }
}
export default new DischargeController();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMTVzZnV0NHBobSIsImFjdHVhbENvdmVyYWdlIiwiZGIiLCJkaXNjaGFyZ2UiLCJkaXNjaGFyZ2Vfc2VjdGlvbnMiLCJlcSIsImxvZ0F1ZGl0IiwibG9nZ2VyIiwiRGlzY2hhcmdlQ29udHJvbGxlciIsImluZGV4IiwicmVxdWVzdCIsInJlcGx5IiwiZiIsInMiLCJkaXNjaGFyZ2VzIiwic2VsZWN0IiwiaWQiLCJwYXRpZW50X2lkIiwidHlwZV9vZl9yZWNvcmQiLCJuYXRpb25hbF9wcm92aWRlcl9pZGVudGlmaWVyIiwiY2VydGlmaWNhdGlvbl9udW1iZXIiLCJhZG1pc3Npb25fZGF0ZSIsInJlYXNvbl9mb3JfcmVjb3JkIiwiZGlzY2hhcmdlX2RhdGUiLCJzb2NpYWxfc2VjdXJpdHlfbnVtYmVyIiwibWVkaWNhcmVfbnVtYmVyIiwibWVkaWNhaWRfcmVjaXBpZW50IiwicmVhc29uX2Zvcl9kaXNjaGFyZ2UiLCJjcmVhdGVkQXQiLCJ1cGRhdGVkQXQiLCJmcm9tIiwiY29kZSIsImVycm9yIiwibWVzc2FnZSIsImRpc2NoYXJnZUxpc3QiLCJzdG9yZSIsImJvZHkiLCJleGlzdGluZ0Rpc2NoYXJnZXMiLCJ3aGVyZSIsImxpbWl0IiwiZXhpc3RpbmdEaXNjaGFyZ2UiLCJub3ciLCJEYXRlIiwiZGlzY2hhcmdlRGF0YSIsImIiLCJBcnJheSIsImlzQXJyYXkiLCJqb2luIiwicmVzdWx0IiwiYWN0aW9uIiwidXBkYXRlIiwic2V0IiwicmV0dXJuaW5nIiwiaW5zZXJ0IiwidmFsdWVzIiwiZGF0YSIsInNob3ciLCJwYXJhbXMiLCJkaXNjaGFyZ2VSZWNvcmQiLCJkaXNjaGFyZ2VTZWN0aW9ucyIsIm5hbWUiLCJkZXNjcmlwdGlvbiJdLCJzb3VyY2VzIjpbIkRpc2NoYXJnZS5jb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRiIH0gZnJvbSBcIi4uLy4uL2NvbmZpZy9kYi5kcml6emxlLmpzXCI7XG5pbXBvcnQgeyBkaXNjaGFyZ2UgfSBmcm9tIFwiLi4vLi4vZGIvc2NoZW1hcy9kaXNjaGFyZ2Uuc2NoZW1hLmpzXCI7XG5pbXBvcnQgeyBkaXNjaGFyZ2Vfc2VjdGlvbnMgfSBmcm9tIFwiLi4vLi4vZGIvc2NoZW1hcy9kaXNjaGFyZ2VTZWN0aW9uLnNjaGVtYS5qc1wiO1xuaW1wb3J0IHsgZXEgfSBmcm9tIFwiZHJpenpsZS1vcm1cIjtcbmltcG9ydCB7IGxvZ0F1ZGl0IH0gZnJvbSBcIi4uLy4uL21pZGRsZXdhcmUvYXVkaXQubWlkZGxld2FyZS5qc1wiO1xuXG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuLi8uLi91dGlscy9sb2dnZXIuanMnO1xuY2xhc3MgRGlzY2hhcmdlQ29udHJvbGxlciB7XG4gICAgLy8gR2V0IGFsbCBkaXNjaGFyZ2VzXG4gICAgYXN5bmMgaW5kZXgocmVxdWVzdCwgcmVwbHkpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRpc2NoYXJnZXMgPSBhd2FpdCBkYi5zZWxlY3Qoe1xuICAgICAgICAgICAgICAgIGlkOiBkaXNjaGFyZ2UuaWQsXG4gICAgICAgICAgICAgICAgcGF0aWVudF9pZDogZGlzY2hhcmdlLnBhdGllbnRfaWQsXG4gICAgICAgICAgICAgICAgdHlwZV9vZl9yZWNvcmQ6IGRpc2NoYXJnZS50eXBlX29mX3JlY29yZCxcbiAgICAgICAgICAgICAgICBuYXRpb25hbF9wcm92aWRlcl9pZGVudGlmaWVyOiBkaXNjaGFyZ2UubmF0aW9uYWxfcHJvdmlkZXJfaWRlbnRpZmllcixcbiAgICAgICAgICAgICAgICBjZXJ0aWZpY2F0aW9uX251bWJlcjogZGlzY2hhcmdlLmNlcnRpZmljYXRpb25fbnVtYmVyLFxuICAgICAgICAgICAgICAgIGFkbWlzc2lvbl9kYXRlOiBkaXNjaGFyZ2UuYWRtaXNzaW9uX2RhdGUsXG4gICAgICAgICAgICAgICAgcmVhc29uX2Zvcl9yZWNvcmQ6IGRpc2NoYXJnZS5yZWFzb25fZm9yX3JlY29yZCxcbiAgICAgICAgICAgICAgICBkaXNjaGFyZ2VfZGF0ZTogZGlzY2hhcmdlLmRpc2NoYXJnZV9kYXRlLFxuICAgICAgICAgICAgICAgIHNvY2lhbF9zZWN1cml0eV9udW1iZXI6IGRpc2NoYXJnZS5zb2NpYWxfc2VjdXJpdHlfbnVtYmVyLFxuICAgICAgICAgICAgICAgIG1lZGljYXJlX251bWJlcjogZGlzY2hhcmdlLm1lZGljYXJlX251bWJlcixcbiAgICAgICAgICAgICAgICBtZWRpY2FpZF9yZWNpcGllbnQ6IGRpc2NoYXJnZS5tZWRpY2FpZF9yZWNpcGllbnQsXG4gICAgICAgICAgICAgICAgcmVhc29uX2Zvcl9kaXNjaGFyZ2U6IGRpc2NoYXJnZS5yZWFzb25fZm9yX2Rpc2NoYXJnZSxcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGRpc2NoYXJnZS5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBkaXNjaGFyZ2UudXBkYXRlZEF0LFxuICAgICAgICAgICAgfSkuZnJvbShkaXNjaGFyZ2UpO1xuXG4gICAgICAgICAgICAvLyBMb2cgYXVkaXQgLSBSRUFEIG9wZXJhdGlvbiBvbiBkaXNjaGFyZ2UgdGFibGVcbiAgICAgICAgICAgIGF3YWl0IGxvZ0F1ZGl0KHJlcXVlc3QsICdSRUFEJywgJ2Rpc2NoYXJnZScsIG51bGwpO1xuXG4gICAgICAgICAgICByZXBseS5jb2RlKDIwMCk7XG4gICAgICAgICAgICByZXR1cm4gZGlzY2hhcmdlcztcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihcIkVycm9yIGZldGNoaW5nIGRpc2NoYXJnZXM6XCIsIGVycm9yKVxuICAgICAgICAgICAgcmVwbHkuY29kZSg1MDApO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkludGVybmFsIHNlcnZlciBlcnJvclwiLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdldCBhbGwgZGlzY2hhcmdlcyAoYWxpYXMgZm9yIGluZGV4KVxuICAgIGFzeW5jIGRpc2NoYXJnZUxpc3QocmVxdWVzdCwgcmVwbHkpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRpc2NoYXJnZXMgPSBhd2FpdCBkYi5zZWxlY3Qoe1xuICAgICAgICAgICAgICAgIGlkOiBkaXNjaGFyZ2UuaWQsXG4gICAgICAgICAgICAgICAgcGF0aWVudF9pZDogZGlzY2hhcmdlLnBhdGllbnRfaWQsXG4gICAgICAgICAgICAgICAgdHlwZV9vZl9yZWNvcmQ6IGRpc2NoYXJnZS50eXBlX29mX3JlY29yZCxcbiAgICAgICAgICAgICAgICBuYXRpb25hbF9wcm92aWRlcl9pZGVudGlmaWVyOiBkaXNjaGFyZ2UubmF0aW9uYWxfcHJvdmlkZXJfaWRlbnRpZmllcixcbiAgICAgICAgICAgICAgICBjZXJ0aWZpY2F0aW9uX251bWJlcjogZGlzY2hhcmdlLmNlcnRpZmljYXRpb25fbnVtYmVyLFxuICAgICAgICAgICAgICAgIGFkbWlzc2lvbl9kYXRlOiBkaXNjaGFyZ2UuYWRtaXNzaW9uX2RhdGUsXG4gICAgICAgICAgICAgICAgcmVhc29uX2Zvcl9yZWNvcmQ6IGRpc2NoYXJnZS5yZWFzb25fZm9yX3JlY29yZCxcbiAgICAgICAgICAgICAgICBkaXNjaGFyZ2VfZGF0ZTogZGlzY2hhcmdlLmRpc2NoYXJnZV9kYXRlLFxuICAgICAgICAgICAgICAgIHNvY2lhbF9zZWN1cml0eV9udW1iZXI6IGRpc2NoYXJnZS5zb2NpYWxfc2VjdXJpdHlfbnVtYmVyLFxuICAgICAgICAgICAgICAgIG1lZGljYXJlX251bWJlcjogZGlzY2hhcmdlLm1lZGljYXJlX251bWJlcixcbiAgICAgICAgICAgICAgICBtZWRpY2FpZF9yZWNpcGllbnQ6IGRpc2NoYXJnZS5tZWRpY2FpZF9yZWNpcGllbnQsXG4gICAgICAgICAgICAgICAgcmVhc29uX2Zvcl9kaXNjaGFyZ2U6IGRpc2NoYXJnZS5yZWFzb25fZm9yX2Rpc2NoYXJnZSxcbiAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IGRpc2NoYXJnZS5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBkaXNjaGFyZ2UudXBkYXRlZEF0LFxuICAgICAgICAgICAgfSkuZnJvbShkaXNjaGFyZ2UpO1xuICAgICAgICAgICAgcmVwbHkuY29kZSgyMDApO1xuICAgICAgICAgICAgcmV0dXJuIGRpc2NoYXJnZXM7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBkaXNjaGFyZ2UgbGlzdDpcIiwgZXJyb3IpXG4gICAgICAgICAgICByZXBseS5jb2RlKDUwMCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gU3RvcmUgb3IgdXBkYXRlIGRpc2NoYXJnZVxuICAgIGFzeW5jIHN0b3JlKHJlcXVlc3QsIHJlcGx5KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICAgICAgcGF0aWVudF9pZCxcbiAgICAgICAgICAgICAgICB0eXBlX29mX3JlY29yZCxcbiAgICAgICAgICAgICAgICBuYXRpb25hbF9wcm92aWRlcl9pZGVudGlmaWVyLFxuICAgICAgICAgICAgICAgIGNlcnRpZmljYXRpb25fbnVtYmVyLFxuICAgICAgICAgICAgICAgIGFkbWlzc2lvbl9kYXRlLFxuICAgICAgICAgICAgICAgIHJlYXNvbl9mb3JfcmVjb3JkLFxuICAgICAgICAgICAgICAgIGRpc2NoYXJnZV9kYXRlLFxuICAgICAgICAgICAgICAgIHNvY2lhbF9zZWN1cml0eV9udW1iZXIsXG4gICAgICAgICAgICAgICAgbWVkaWNhcmVfbnVtYmVyLFxuICAgICAgICAgICAgICAgIG1lZGljYWlkX3JlY2lwaWVudCxcbiAgICAgICAgICAgICAgICByZWFzb25fZm9yX2Rpc2NoYXJnZSxcbiAgICAgICAgICAgIH0gPSByZXF1ZXN0LmJvZHk7XG5cbiAgICAgICAgICAgIC8vIEZpbmQgZXhpc3RpbmcgZGlzY2hhcmdlIGZvciB0aGlzIHBhdGllbnRcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nRGlzY2hhcmdlcyA9IGF3YWl0IGRiLnNlbGVjdCh7IGlkOiBkaXNjaGFyZ2UuaWQgfSkuZnJvbShkaXNjaGFyZ2UpXG4gICAgICAgICAgICAgICAgLndoZXJlKGVxKGRpc2NoYXJnZS5wYXRpZW50X2lkLCBwYXRpZW50X2lkKSlcbiAgICAgICAgICAgICAgICAubGltaXQoMSk7XG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0Rpc2NoYXJnZSA9IGV4aXN0aW5nRGlzY2hhcmdlc1swXTtcblxuICAgICAgICAgICAgLy8gUHJlcGFyZSBkYXRhIGZvciB1cGRhdGUgb3IgY3JlYXRlXG4gICAgICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgY29uc3QgZGlzY2hhcmdlRGF0YSA9IHtcbiAgICAgICAgICAgICAgICBwYXRpZW50X2lkOiBwYXRpZW50X2lkLFxuICAgICAgICAgICAgICAgIHR5cGVfb2ZfcmVjb3JkOiB0eXBlX29mX3JlY29yZCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIG5hdGlvbmFsX3Byb3ZpZGVyX2lkZW50aWZpZXI6XG4gICAgICAgICAgICAgICAgICAgIG5hdGlvbmFsX3Byb3ZpZGVyX2lkZW50aWZpZXIgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBjZXJ0aWZpY2F0aW9uX251bWJlcjogY2VydGlmaWNhdGlvbl9udW1iZXIgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBhZG1pc3Npb25fZGF0ZTogYWRtaXNzaW9uX2RhdGUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICByZWFzb25fZm9yX3JlY29yZDogcmVhc29uX2Zvcl9yZWNvcmQgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBkaXNjaGFyZ2VfZGF0ZTogZGlzY2hhcmdlX2RhdGUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBzb2NpYWxfc2VjdXJpdHlfbnVtYmVyOiBzb2NpYWxfc2VjdXJpdHlfbnVtYmVyIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgbWVkaWNhcmVfbnVtYmVyOiBtZWRpY2FyZV9udW1iZXIgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICBtZWRpY2FpZF9yZWNpcGllbnQ6IG1lZGljYWlkX3JlY2lwaWVudCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIHJlYXNvbl9mb3JfZGlzY2hhcmdlOiBBcnJheS5pc0FycmF5KHJlYXNvbl9mb3JfZGlzY2hhcmdlKVxuICAgICAgICAgICAgICAgICAgICA/IHJlYXNvbl9mb3JfZGlzY2hhcmdlLmpvaW4oXCIsXCIpXG4gICAgICAgICAgICAgICAgICAgIDogcmVhc29uX2Zvcl9kaXNjaGFyZ2UgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5vdyxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGxldCByZXN1bHQ7XG4gICAgICAgICAgICBsZXQgYWN0aW9uO1xuICAgICAgICAgICAgaWYgKGV4aXN0aW5nRGlzY2hhcmdlKSB7XG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIGV4aXN0aW5nIGRpc2NoYXJnZVxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGF3YWl0IGRiLnVwZGF0ZShkaXNjaGFyZ2UpXG4gICAgICAgICAgICAgICAgICAgIC5zZXQoZGlzY2hhcmdlRGF0YSlcbiAgICAgICAgICAgICAgICAgICAgLndoZXJlKGVxKGRpc2NoYXJnZS5wYXRpZW50X2lkLCBwYXRpZW50X2lkKSlcbiAgICAgICAgICAgICAgICAgICAgLnJldHVybmluZygpO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdFswXTtcbiAgICAgICAgICAgICAgICBhY3Rpb24gPSAnVVBEQVRFJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBkaXNjaGFyZ2VcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBhd2FpdCBkYi5pbnNlcnQoZGlzY2hhcmdlKVxuICAgICAgICAgICAgICAgICAgICAudmFsdWVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmRpc2NoYXJnZURhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IG5vdyxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLnJldHVybmluZygpO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdFswXTtcbiAgICAgICAgICAgICAgICBhY3Rpb24gPSAnQ1JFQVRFJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTG9nIGF1ZGl0IC0gQ1JFQVRFIG9yIFVQREFURSBvcGVyYXRpb24gb24gZGlzY2hhcmdlIHRhYmxlXG4gICAgICAgICAgICBhd2FpdCBsb2dBdWRpdChyZXF1ZXN0LCBhY3Rpb24sICdkaXNjaGFyZ2UnLCByZXN1bHQuaWQpO1xuXG4gICAgICAgICAgICByZXBseS5jb2RlKDIwMSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiRGlzY2hhcmdlIGNyZWF0ZWQgb3IgdXBkYXRlZCBzdWNjZXNzZnVsbHlcIixcbiAgICAgICAgICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRXJyb3Igc3RvcmluZyBkaXNjaGFyZ2U6XCIsIGVycm9yKVxuICAgICAgICAgICAgcmVwbHkuY29kZSg1MDApO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkludGVybmFsIHNlcnZlciBlcnJvclwiLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFNob3cgZGlzY2hhcmdlIGZvciBhIHNwZWNpZmljIHBhdGllbnRcbiAgICBhc3luYyBzaG93KHJlcXVlc3QsIHJlcGx5KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB7IGlkIH0gPSByZXF1ZXN0LnBhcmFtcztcblxuICAgICAgICAgICAgY29uc3QgZGlzY2hhcmdlcyA9IGF3YWl0IGRiLnNlbGVjdCh7XG4gICAgICAgICAgICAgICAgaWQ6IGRpc2NoYXJnZS5pZCxcbiAgICAgICAgICAgICAgICBwYXRpZW50X2lkOiBkaXNjaGFyZ2UucGF0aWVudF9pZCxcbiAgICAgICAgICAgICAgICB0eXBlX29mX3JlY29yZDogZGlzY2hhcmdlLnR5cGVfb2ZfcmVjb3JkLFxuICAgICAgICAgICAgICAgIG5hdGlvbmFsX3Byb3ZpZGVyX2lkZW50aWZpZXI6IGRpc2NoYXJnZS5uYXRpb25hbF9wcm92aWRlcl9pZGVudGlmaWVyLFxuICAgICAgICAgICAgICAgIGNlcnRpZmljYXRpb25fbnVtYmVyOiBkaXNjaGFyZ2UuY2VydGlmaWNhdGlvbl9udW1iZXIsXG4gICAgICAgICAgICAgICAgYWRtaXNzaW9uX2RhdGU6IGRpc2NoYXJnZS5hZG1pc3Npb25fZGF0ZSxcbiAgICAgICAgICAgICAgICByZWFzb25fZm9yX3JlY29yZDogZGlzY2hhcmdlLnJlYXNvbl9mb3JfcmVjb3JkLFxuICAgICAgICAgICAgICAgIGRpc2NoYXJnZV9kYXRlOiBkaXNjaGFyZ2UuZGlzY2hhcmdlX2RhdGUsXG4gICAgICAgICAgICAgICAgc29jaWFsX3NlY3VyaXR5X251bWJlcjogZGlzY2hhcmdlLnNvY2lhbF9zZWN1cml0eV9udW1iZXIsXG4gICAgICAgICAgICAgICAgbWVkaWNhcmVfbnVtYmVyOiBkaXNjaGFyZ2UubWVkaWNhcmVfbnVtYmVyLFxuICAgICAgICAgICAgICAgIG1lZGljYWlkX3JlY2lwaWVudDogZGlzY2hhcmdlLm1lZGljYWlkX3JlY2lwaWVudCxcbiAgICAgICAgICAgICAgICByZWFzb25fZm9yX2Rpc2NoYXJnZTogZGlzY2hhcmdlLnJlYXNvbl9mb3JfZGlzY2hhcmdlLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZGlzY2hhcmdlLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGRpc2NoYXJnZS51cGRhdGVkQXQsXG4gICAgICAgICAgICB9KS5mcm9tKGRpc2NoYXJnZSlcbiAgICAgICAgICAgICAgICAud2hlcmUoZXEoZGlzY2hhcmdlLnBhdGllbnRfaWQsIGlkKSlcbiAgICAgICAgICAgICAgICAubGltaXQoMSk7XG4gICAgICAgICAgICBjb25zdCBkaXNjaGFyZ2VSZWNvcmQgPSBkaXNjaGFyZ2VzWzBdO1xuXG4gICAgICAgICAgICBpZiAoIWRpc2NoYXJnZVJlY29yZCkge1xuICAgICAgICAgICAgICAgIHJlcGx5LmNvZGUoNDA0KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBcIk5vIGRpc2NoYXJnZSBmb3VuZCBmb3IgdGhpcyBwYXRpZW50XCIsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTG9nIGF1ZGl0IC0gUkVBRCBvcGVyYXRpb24gb24gZGlzY2hhcmdlIHRhYmxlXG4gICAgICAgICAgICBhd2FpdCBsb2dBdWRpdChyZXF1ZXN0LCAnUkVBRCcsICdkaXNjaGFyZ2UnLCBkaXNjaGFyZ2VSZWNvcmQuaWQpO1xuXG4gICAgICAgICAgICByZXBseS5jb2RlKDIwMCk7XG4gICAgICAgICAgICByZXR1cm4gZGlzY2hhcmdlUmVjb3JkO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgZGlzY2hhcmdlOlwiLCBlcnJvcilcbiAgICAgICAgICAgIHJlcGx5LmNvZGUoNTAwKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJJbnRlcm5hbCBzZXJ2ZXIgZXJyb3JcIixcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBHZXQgYWxsIGRpc2NoYXJnZSBzZWN0aW9uc1xuICAgIGFzeW5jIGRpc2NoYXJnZVNlY3Rpb25zKHJlcXVlc3QsIHJlcGx5KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkaXNjaGFyZ2VTZWN0aW9ucyA9IGF3YWl0IGRiLnNlbGVjdCh7XG4gICAgICAgICAgICAgICAgaWQ6IGRpc2NoYXJnZV9zZWN0aW9ucy5pZCxcbiAgICAgICAgICAgICAgICBuYW1lOiBkaXNjaGFyZ2Vfc2VjdGlvbnMubmFtZSxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogZGlzY2hhcmdlX3NlY3Rpb25zLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogZGlzY2hhcmdlX3NlY3Rpb25zLmNyZWF0ZWRBdCxcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IGRpc2NoYXJnZV9zZWN0aW9ucy51cGRhdGVkQXQsXG4gICAgICAgICAgICB9KS5mcm9tKGRpc2NoYXJnZV9zZWN0aW9ucyk7XG4gICAgICAgICAgICByZXBseS5jb2RlKDIwMCk7XG4gICAgICAgICAgICByZXR1cm4gZGlzY2hhcmdlU2VjdGlvbnM7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBkaXNjaGFyZ2Ugc2VjdGlvbnM6XCIsIGVycm9yKVxuICAgICAgICAgICAgcmVwbHkuY29kZSg1MDApO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkludGVybmFsIHNlcnZlciBlcnJvclwiLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgbmV3IERpc2NoYXJnZUNvbnRyb2xsZXIoKTsiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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Wk4sTUFBTSxDQUFDeUIsS0FBSyxDQUFDLDJCQUEyQixFQUFFQSxLQUFLLENBQUM7TUFBQTtNQUFBaEMsY0FBQSxHQUFBYSxDQUFBO01BQ2hERixLQUFLLENBQUNvQixJQUFJLENBQUMsR0FBRyxDQUFDO01BQUM7TUFBQS9CLGNBQUEsR0FBQWEsQ0FBQTtNQUNoQixPQUFPO1FBQ0hvQixPQUFPLEVBQUUsdUJBQXVCO1FBQ2hDRCxLQUFLLEVBQUVBLEtBQUssQ0FBQ0M7TUFDakIsQ0FBQztJQUNMO0VBQ0o7O0VBRUE7RUFDQSxNQUFNMEIsaUJBQWlCQSxDQUFDakQsT0FBTyxFQUFFQyxLQUFLLEVBQUU7SUFBQTtJQUFBWCxjQUFBLEdBQUFZLENBQUE7SUFBQVosY0FBQSxHQUFBYSxDQUFBO0lBQ3BDLElBQUk7TUFDQSxNQUFNOEMsaUJBQWlCO01BQUE7TUFBQSxDQUFBM0QsY0FBQSxHQUFBYSxDQUFBLFFBQUcsTUFBTVgsRUFBRSxDQUFDYSxNQUFNLENBQUM7UUFDdENDLEVBQUUsRUFBRVosa0JBQWtCLENBQUNZLEVBQUU7UUFDekI0QyxJQUFJLEVBQUV4RCxrQkFBa0IsQ0FBQ3dELElBQUk7UUFDN0JDLFdBQVcsRUFBRXpELGtCQUFrQixDQUFDeUQsV0FBVztRQUMzQ2pDLFNBQVMsRUFBRXhCLGtCQUFrQixDQUFDd0IsU0FBUztRQUN2Q0MsU0FBUyxFQUFFekIsa0JBQWtCLENBQUN5QjtNQUNsQyxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDMUIsa0JBQWtCLENBQUM7TUFBQztNQUFBSixjQUFBLEdBQUFhLENBQUE7TUFDNUJGLEtBQUssQ0FBQ29CLElBQUksQ0FBQyxHQUFHLENBQUM7TUFBQztNQUFBL0IsY0FBQSxHQUFBYSxDQUFBO01BQ2hCLE9BQU84QyxpQkFBaUI7SUFDNUIsQ0FBQyxDQUFDLE9BQU8zQixLQUFLLEVBQUU7TUFBQTtNQUFBaEMsY0FBQSxHQUFBYSxDQUFBO01BQ1pOLE1BQU0sQ0FBQ3lCLEtBQUssQ0FBQyxvQ0FBb0MsRUFBRUEsS0FBSyxDQUFDO01BQUE7TUFBQWhDLGNBQUEsR0FBQWEsQ0FBQTtNQUN6REYsS0FBSyxDQUFDb0IsSUFBSSxDQUFDLEdBQUcsQ0FBQztNQUFDO01BQUEvQixjQUFBLEdBQUFhLENBQUE7TUFDaEIsT0FBTztRQUNIb0IsT0FBTyxFQUFFLHVCQUF1QjtRQUNoQ0QsS0FBSyxFQUFFQSxLQUFLLENBQUNDO01BQ2pCLENBQUM7SUFDTDtFQUNKO0FBQ0o7QUFFQSxlQUFlLElBQUl6QixtQkFBbUIsQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119