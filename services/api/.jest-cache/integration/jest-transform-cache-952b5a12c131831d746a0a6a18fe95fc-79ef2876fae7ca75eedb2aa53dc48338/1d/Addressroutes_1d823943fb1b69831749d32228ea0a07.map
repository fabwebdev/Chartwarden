{"version":3,"names":["cov_10igk6juxy","actualCoverage","AddressController","verifyToken","addressRoutes","fastify","options","f","s","get","preHandler","schema","description","tags","params","type","properties","patientId","required","querystring","enum","active_only","response","status","data","count","getPatientAddresses","bind","addressId","getAddress","post","body","address_type","default","address_line_1","minLength","maxLength","address_line_2","city","state","zip_code","pattern","county","cbsa_code","latitude","longitude","phone_number","alternate_phone","is_primary","is_verified","is_active","effective_from","format","effective_to","notes","createAddress","put","updateAddress","delete","deleteAddress","setPrimaryAddress","store","show"],"sources":["Address.routes.js"],"sourcesContent":["import AddressController from \"../../controllers/patient/Address.controller.js\";\nimport { verifyToken } from \"../../middleware/betterAuth.middleware.js\";\n\n// Fastify plugin for address routes\nasync function addressRoutes(fastify, options) {\n  // ============================================================\n  // NEW RESTful API Routes for Patient Addresses\n  // ============================================================\n\n  // GET /patients/:patientId/addresses - Get all addresses for a patient\n  fastify.get(\"/patients/:patientId/addresses\", {\n    preHandler: [verifyToken],\n    schema: {\n      description: 'Get all addresses for a patient',\n      tags: ['Patient Addresses'],\n      params: {\n        type: 'object',\n        properties: {\n          patientId: { type: 'string', description: 'Patient ID' }\n        },\n        required: ['patientId']\n      },\n      querystring: {\n        type: 'object',\n        properties: {\n          type: { type: 'string', enum: ['PRIMARY', 'BILLING', 'MAILING', 'FACILITY', 'TEMPORARY'], description: 'Filter by address type' },\n          active_only: { type: 'string', enum: ['true', 'false'], description: 'Only return active addresses' }\n        }\n      },\n      response: {\n        200: {\n          type: 'object',\n          properties: {\n            status: { type: 'number' },\n            data: { type: 'array' },\n            count: { type: 'number' }\n          }\n        }\n      }\n    }\n  }, AddressController.getPatientAddresses.bind(AddressController));\n\n  // GET /patients/:patientId/addresses/:addressId - Get a specific address\n  fastify.get(\"/patients/:patientId/addresses/:addressId\", {\n    preHandler: [verifyToken],\n    schema: {\n      description: 'Get a specific address by ID',\n      tags: ['Patient Addresses'],\n      params: {\n        type: 'object',\n        properties: {\n          patientId: { type: 'string', description: 'Patient ID' },\n          addressId: { type: 'string', description: 'Address ID' }\n        },\n        required: ['patientId', 'addressId']\n      }\n    }\n  }, AddressController.getAddress.bind(AddressController));\n\n  // POST /patients/:patientId/addresses - Create a new address\n  fastify.post(\"/patients/:patientId/addresses\", {\n    preHandler: [verifyToken],\n    schema: {\n      description: 'Create a new address for a patient',\n      tags: ['Patient Addresses'],\n      params: {\n        type: 'object',\n        properties: {\n          patientId: { type: 'string', description: 'Patient ID' }\n        },\n        required: ['patientId']\n      },\n      body: {\n        type: 'object',\n        properties: {\n          address_type: { type: 'string', enum: ['PRIMARY', 'BILLING', 'MAILING', 'FACILITY', 'TEMPORARY'], default: 'PRIMARY' },\n          address_line_1: { type: 'string', minLength: 1, maxLength: 255 },\n          address_line_2: { type: 'string', maxLength: 255 },\n          city: { type: 'string', minLength: 1, maxLength: 100 },\n          state: { type: 'string', minLength: 2, maxLength: 2, description: 'Two-letter US state code' },\n          zip_code: { type: 'string', pattern: '^\\\\d{5}(-\\\\d{4})?$', description: 'ZIP code in format 12345 or 12345-6789' },\n          county: { type: 'string', maxLength: 100 },\n          cbsa_code: { type: 'string', maxLength: 10 },\n          latitude: { type: 'string', maxLength: 20 },\n          longitude: { type: 'string', maxLength: 20 },\n          phone_number: { type: 'string', maxLength: 20 },\n          alternate_phone: { type: 'string', maxLength: 20 },\n          is_primary: { type: 'boolean', default: false },\n          is_verified: { type: 'boolean', default: false },\n          is_active: { type: 'boolean', default: true },\n          effective_from: { type: 'string', format: 'date-time' },\n          effective_to: { type: 'string', format: 'date-time' },\n          notes: { type: 'string', maxLength: 500 }\n        },\n        required: ['address_line_1', 'city', 'state', 'zip_code']\n      }\n    }\n  }, AddressController.createAddress.bind(AddressController));\n\n  // PUT /patients/:patientId/addresses/:addressId - Update an address\n  fastify.put(\"/patients/:patientId/addresses/:addressId\", {\n    preHandler: [verifyToken],\n    schema: {\n      description: 'Update an existing address',\n      tags: ['Patient Addresses'],\n      params: {\n        type: 'object',\n        properties: {\n          patientId: { type: 'string', description: 'Patient ID' },\n          addressId: { type: 'string', description: 'Address ID' }\n        },\n        required: ['patientId', 'addressId']\n      },\n      body: {\n        type: 'object',\n        properties: {\n          address_type: { type: 'string', enum: ['PRIMARY', 'BILLING', 'MAILING', 'FACILITY', 'TEMPORARY'] },\n          address_line_1: { type: 'string', minLength: 1, maxLength: 255 },\n          address_line_2: { type: 'string', maxLength: 255 },\n          city: { type: 'string', minLength: 1, maxLength: 100 },\n          state: { type: 'string', minLength: 2, maxLength: 2 },\n          zip_code: { type: 'string', pattern: '^\\\\d{5}(-\\\\d{4})?$' },\n          county: { type: 'string', maxLength: 100 },\n          cbsa_code: { type: 'string', maxLength: 10 },\n          latitude: { type: 'string', maxLength: 20 },\n          longitude: { type: 'string', maxLength: 20 },\n          phone_number: { type: 'string', maxLength: 20 },\n          alternate_phone: { type: 'string', maxLength: 20 },\n          is_primary: { type: 'boolean' },\n          is_verified: { type: 'boolean' },\n          is_active: { type: 'boolean' },\n          effective_from: { type: 'string', format: 'date-time' },\n          effective_to: { type: 'string', format: 'date-time' },\n          notes: { type: 'string', maxLength: 500 }\n        }\n      }\n    }\n  }, AddressController.updateAddress.bind(AddressController));\n\n  // DELETE /patients/:patientId/addresses/:addressId - Delete an address (soft delete)\n  fastify.delete(\"/patients/:patientId/addresses/:addressId\", {\n    preHandler: [verifyToken],\n    schema: {\n      description: 'Delete an address (soft delete)',\n      tags: ['Patient Addresses'],\n      params: {\n        type: 'object',\n        properties: {\n          patientId: { type: 'string', description: 'Patient ID' },\n          addressId: { type: 'string', description: 'Address ID' }\n        },\n        required: ['patientId', 'addressId']\n      }\n    }\n  }, AddressController.deleteAddress.bind(AddressController));\n\n  // POST /patients/:patientId/addresses/:addressId/set-primary - Set address as primary\n  fastify.post(\"/patients/:patientId/addresses/:addressId/set-primary\", {\n    preHandler: [verifyToken],\n    schema: {\n      description: 'Set an address as the primary address for its type',\n      tags: ['Patient Addresses'],\n      params: {\n        type: 'object',\n        properties: {\n          patientId: { type: 'string', description: 'Patient ID' },\n          addressId: { type: 'string', description: 'Address ID' }\n        },\n        required: ['patientId', 'addressId']\n      }\n    }\n  }, AddressController.setPrimaryAddress.bind(AddressController));\n\n  // ============================================================\n  // Legacy Routes (for backwards compatibility)\n  // ============================================================\n\n  // POST /address/store - Legacy store/update address\n  fastify.post(\"/address/store\", {\n    preHandler: [verifyToken],\n  }, AddressController.store.bind(AddressController));\n\n  // GET /address/:id - Legacy get address by patient ID\n  fastify.get(\"/address/:id\", {\n    preHandler: [verifyToken],\n  }, AddressController.show.bind(AddressController));\n}\n\nexport default addressRoutes;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAfZ,OAAOE,iBAAiB,MAAM,iDAAiD;AAC/E,SAASC,WAAW,QAAQ,2CAA2C;;AAEvE;AACA,eAAeC,aAAaA,CAACC,OAAO,EAAEC,OAAO,EAAE;EAAA;EAAAN,cAAA,GAAAO,CAAA;EAAAP,cAAA,GAAAQ,CAAA;EAC7C;EACA;EACA;;EAEA;EACAH,OAAO,CAACI,GAAG,CAAC,gCAAgC,EAAE;IAC5CC,UAAU,EAAE,CAACP,WAAW,CAAC;IACzBQ,MAAM,EAAE;MACNC,WAAW,EAAE,iCAAiC;MAC9CC,IAAI,EAAE,CAAC,mBAAmB,CAAC;MAC3BC,MAAM,EAAE;QACNC,IAAI,EAAE,QAAQ;QACdC,UAAU,EAAE;UACVC,SAAS,EAAE;YAAEF,IAAI,EAAE,QAAQ;YAAEH,WAAW,EAAE;UAAa;QACzD,CAAC;QACDM,QAAQ,EAAE,CAAC,WAAW;MACxB,CAAC;MACDC,WAAW,EAAE;QACXJ,IAAI,EAAE,QAAQ;QACdC,UAAU,EAAE;UACVD,IAAI,EAAE;YAAEA,IAAI,EAAE,QAAQ;YAAEK,IAAI,EAAE,CAAC,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,WAAW,CAAC;YAAER,WAAW,EAAE;UAAyB,CAAC;UACjIS,WAAW,EAAE;YAAEN,IAAI,EAAE,QAAQ;YAAEK,IAAI,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC;YAAER,WAAW,EAAE;UAA+B;QACtG;MACF,CAAC;MACDU,QAAQ,EAAE;QACR,GAAG,EAAE;UACHP,IAAI,EAAE,QAAQ;UACdC,UAAU,EAAE;YACVO,MAAM,EAAE;cAAER,IAAI,EAAE;YAAS,CAAC;YAC1BS,IAAI,EAAE;cAAET,IAAI,EAAE;YAAQ,CAAC;YACvBU,KAAK,EAAE;cAAEV,IAAI,EAAE;YAAS;UAC1B;QACF;MACF;IACF;EACF,CAAC,EAAEb,iBAAiB,CAACwB,mBAAmB,CAACC,IAAI,CAACzB,iBAAiB,CAAC,CAAC;;EAEjE;EAAA;EAAAF,cAAA,GAAAQ,CAAA;EACAH,OAAO,CAACI,GAAG,CAAC,2CAA2C,EAAE;IACvDC,UAAU,EAAE,CAACP,WAAW,CAAC;IACzBQ,MAAM,EAAE;MACNC,WAAW,EAAE,8BAA8B;MAC3CC,IAAI,EAAE,CAAC,mBAAmB,CAAC;MAC3BC,MAAM,EAAE;QACNC,IAAI,EAAE,QAAQ;QACdC,UAAU,EAAE;UACVC,SAAS,EAAE;YAAEF,IAAI,EAAE,QAAQ;YAAEH,WAAW,EAAE;UAAa,CAAC;UACxDgB,SAAS,EAAE;YAAEb,IAAI,EAAE,QAAQ;YAAEH,WAAW,EAAE;UAAa;QACzD,CAAC;QACDM,QAAQ,EAAE,CAAC,WAAW,EAAE,WAAW;MACrC;IACF;EACF,CAAC,EAAEhB,iBAAiB,CAAC2B,UAAU,CAACF,IAAI,CAACzB,iBAAiB,CAAC,CAAC;;EAExD;EAAA;EAAAF,cAAA,GAAAQ,CAAA;EACAH,OAAO,CAACyB,IAAI,CAAC,gCAAgC,EAAE;IAC7CpB,UAAU,EAAE,CAACP,WAAW,CAAC;IACzBQ,MAAM,EAAE;MACNC,WAAW,EAAE,oCAAoC;MACjDC,IAAI,EAAE,CAAC,mBAAmB,CAAC;MAC3BC,MAAM,EAAE;QACNC,IAAI,EAAE,QAAQ;QACdC,UAAU,EAAE;UACVC,SAAS,EAAE;YAAEF,IAAI,EAAE,QAAQ;YAAEH,WAAW,EAAE;UAAa;QACzD,CAAC;QACDM,QAAQ,EAAE,CAAC,WAAW;MACxB,CAAC;MACDa,IAAI,EAAE;QACJhB,IAAI,EAAE,QAAQ;QACdC,UAAU,EAAE;UACVgB,YAAY,EAAE;YAAEjB,IAAI,EAAE,QAAQ;YAAEK,IAAI,EAAE,CAAC,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,WAAW,CAAC;YAAEa,OAAO,EAAE;UAAU,CAAC;UACtHC,cAAc,EAAE;YAAEnB,IAAI,EAAE,QAAQ;YAAEoB,SAAS,EAAE,CAAC;YAAEC,SAAS,EAAE;UAAI,CAAC;UAChEC,cAAc,EAAE;YAAEtB,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAI,CAAC;UAClDE,IAAI,EAAE;YAAEvB,IAAI,EAAE,QAAQ;YAAEoB,SAAS,EAAE,CAAC;YAAEC,SAAS,EAAE;UAAI,CAAC;UACtDG,KAAK,EAAE;YAAExB,IAAI,EAAE,QAAQ;YAAEoB,SAAS,EAAE,CAAC;YAAEC,SAAS,EAAE,CAAC;YAAExB,WAAW,EAAE;UAA2B,CAAC;UAC9F4B,QAAQ,EAAE;YAAEzB,IAAI,EAAE,QAAQ;YAAE0B,OAAO,EAAE,oBAAoB;YAAE7B,WAAW,EAAE;UAAyC,CAAC;UAClH8B,MAAM,EAAE;YAAE3B,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAI,CAAC;UAC1CO,SAAS,EAAE;YAAE5B,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAG,CAAC;UAC5CQ,QAAQ,EAAE;YAAE7B,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAG,CAAC;UAC3CS,SAAS,EAAE;YAAE9B,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAG,CAAC;UAC5CU,YAAY,EAAE;YAAE/B,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAG,CAAC;UAC/CW,eAAe,EAAE;YAAEhC,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAG,CAAC;UAClDY,UAAU,EAAE;YAAEjC,IAAI,EAAE,SAAS;YAAEkB,OAAO,EAAE;UAAM,CAAC;UAC/CgB,WAAW,EAAE;YAAElC,IAAI,EAAE,SAAS;YAAEkB,OAAO,EAAE;UAAM,CAAC;UAChDiB,SAAS,EAAE;YAAEnC,IAAI,EAAE,SAAS;YAAEkB,OAAO,EAAE;UAAK,CAAC;UAC7CkB,cAAc,EAAE;YAAEpC,IAAI,EAAE,QAAQ;YAAEqC,MAAM,EAAE;UAAY,CAAC;UACvDC,YAAY,EAAE;YAAEtC,IAAI,EAAE,QAAQ;YAAEqC,MAAM,EAAE;UAAY,CAAC;UACrDE,KAAK,EAAE;YAAEvC,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAI;QAC1C,CAAC;QACDlB,QAAQ,EAAE,CAAC,gBAAgB,EAAE,MAAM,EAAE,OAAO,EAAE,UAAU;MAC1D;IACF;EACF,CAAC,EAAEhB,iBAAiB,CAACqD,aAAa,CAAC5B,IAAI,CAACzB,iBAAiB,CAAC,CAAC;;EAE3D;EAAA;EAAAF,cAAA,GAAAQ,CAAA;EACAH,OAAO,CAACmD,GAAG,CAAC,2CAA2C,EAAE;IACvD9C,UAAU,EAAE,CAACP,WAAW,CAAC;IACzBQ,MAAM,EAAE;MACNC,WAAW,EAAE,4BAA4B;MACzCC,IAAI,EAAE,CAAC,mBAAmB,CAAC;MAC3BC,MAAM,EAAE;QACNC,IAAI,EAAE,QAAQ;QACdC,UAAU,EAAE;UACVC,SAAS,EAAE;YAAEF,IAAI,EAAE,QAAQ;YAAEH,WAAW,EAAE;UAAa,CAAC;UACxDgB,SAAS,EAAE;YAAEb,IAAI,EAAE,QAAQ;YAAEH,WAAW,EAAE;UAAa;QACzD,CAAC;QACDM,QAAQ,EAAE,CAAC,WAAW,EAAE,WAAW;MACrC,CAAC;MACDa,IAAI,EAAE;QACJhB,IAAI,EAAE,QAAQ;QACdC,UAAU,EAAE;UACVgB,YAAY,EAAE;YAAEjB,IAAI,EAAE,QAAQ;YAAEK,IAAI,EAAE,CAAC,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,WAAW;UAAE,CAAC;UAClGc,cAAc,EAAE;YAAEnB,IAAI,EAAE,QAAQ;YAAEoB,SAAS,EAAE,CAAC;YAAEC,SAAS,EAAE;UAAI,CAAC;UAChEC,cAAc,EAAE;YAAEtB,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAI,CAAC;UAClDE,IAAI,EAAE;YAAEvB,IAAI,EAAE,QAAQ;YAAEoB,SAAS,EAAE,CAAC;YAAEC,SAAS,EAAE;UAAI,CAAC;UACtDG,KAAK,EAAE;YAAExB,IAAI,EAAE,QAAQ;YAAEoB,SAAS,EAAE,CAAC;YAAEC,SAAS,EAAE;UAAE,CAAC;UACrDI,QAAQ,EAAE;YAAEzB,IAAI,EAAE,QAAQ;YAAE0B,OAAO,EAAE;UAAqB,CAAC;UAC3DC,MAAM,EAAE;YAAE3B,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAI,CAAC;UAC1CO,SAAS,EAAE;YAAE5B,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAG,CAAC;UAC5CQ,QAAQ,EAAE;YAAE7B,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAG,CAAC;UAC3CS,SAAS,EAAE;YAAE9B,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAG,CAAC;UAC5CU,YAAY,EAAE;YAAE/B,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAG,CAAC;UAC/CW,eAAe,EAAE;YAAEhC,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAG,CAAC;UAClDY,UAAU,EAAE;YAAEjC,IAAI,EAAE;UAAU,CAAC;UAC/BkC,WAAW,EAAE;YAAElC,IAAI,EAAE;UAAU,CAAC;UAChCmC,SAAS,EAAE;YAAEnC,IAAI,EAAE;UAAU,CAAC;UAC9BoC,cAAc,EAAE;YAAEpC,IAAI,EAAE,QAAQ;YAAEqC,MAAM,EAAE;UAAY,CAAC;UACvDC,YAAY,EAAE;YAAEtC,IAAI,EAAE,QAAQ;YAAEqC,MAAM,EAAE;UAAY,CAAC;UACrDE,KAAK,EAAE;YAAEvC,IAAI,EAAE,QAAQ;YAAEqB,SAAS,EAAE;UAAI;QAC1C;MACF;IACF;EACF,CAAC,EAAElC,iBAAiB,CAACuD,aAAa,CAAC9B,IAAI,CAACzB,iBAAiB,CAAC,CAAC;;EAE3D;EAAA;EAAAF,cAAA,GAAAQ,CAAA;EACAH,OAAO,CAACqD,MAAM,CAAC,2CAA2C,EAAE;IAC1DhD,UAAU,EAAE,CAACP,WAAW,CAAC;IACzBQ,MAAM,EAAE;MACNC,WAAW,EAAE,iCAAiC;MAC9CC,IAAI,EAAE,CAAC,mBAAmB,CAAC;MAC3BC,MAAM,EAAE;QACNC,IAAI,EAAE,QAAQ;QACdC,UAAU,EAAE;UACVC,SAAS,EAAE;YAAEF,IAAI,EAAE,QAAQ;YAAEH,WAAW,EAAE;UAAa,CAAC;UACxDgB,SAAS,EAAE;YAAEb,IAAI,EAAE,QAAQ;YAAEH,WAAW,EAAE;UAAa;QACzD,CAAC;QACDM,QAAQ,EAAE,CAAC,WAAW,EAAE,WAAW;MACrC;IACF;EACF,CAAC,EAAEhB,iBAAiB,CAACyD,aAAa,CAAChC,IAAI,CAACzB,iBAAiB,CAAC,CAAC;;EAE3D;EAAA;EAAAF,cAAA,GAAAQ,CAAA;EACAH,OAAO,CAACyB,IAAI,CAAC,uDAAuD,EAAE;IACpEpB,UAAU,EAAE,CAACP,WAAW,CAAC;IACzBQ,MAAM,EAAE;MACNC,WAAW,EAAE,oDAAoD;MACjEC,IAAI,EAAE,CAAC,mBAAmB,CAAC;MAC3BC,MAAM,EAAE;QACNC,IAAI,EAAE,QAAQ;QACdC,UAAU,EAAE;UACVC,SAAS,EAAE;YAAEF,IAAI,EAAE,QAAQ;YAAEH,WAAW,EAAE;UAAa,CAAC;UACxDgB,SAAS,EAAE;YAAEb,IAAI,EAAE,QAAQ;YAAEH,WAAW,EAAE;UAAa;QACzD,CAAC;QACDM,QAAQ,EAAE,CAAC,WAAW,EAAE,WAAW;MACrC;IACF;EACF,CAAC,EAAEhB,iBAAiB,CAAC0D,iBAAiB,CAACjC,IAAI,CAACzB,iBAAiB,CAAC,CAAC;;EAE/D;EACA;EACA;;EAEA;EAAA;EAAAF,cAAA,GAAAQ,CAAA;EACAH,OAAO,CAACyB,IAAI,CAAC,gBAAgB,EAAE;IAC7BpB,UAAU,EAAE,CAACP,WAAW;EAC1B,CAAC,EAAED,iBAAiB,CAAC2D,KAAK,CAAClC,IAAI,CAACzB,iBAAiB,CAAC,CAAC;;EAEnD;EAAA;EAAAF,cAAA,GAAAQ,CAAA;EACAH,OAAO,CAACI,GAAG,CAAC,cAAc,EAAE;IAC1BC,UAAU,EAAE,CAACP,WAAW;EAC1B,CAAC,EAAED,iBAAiB,CAAC4D,IAAI,CAACnC,IAAI,CAACzB,iBAAiB,CAAC,CAAC;AACpD;AAEA,eAAeE,aAAa","ignoreList":[]}