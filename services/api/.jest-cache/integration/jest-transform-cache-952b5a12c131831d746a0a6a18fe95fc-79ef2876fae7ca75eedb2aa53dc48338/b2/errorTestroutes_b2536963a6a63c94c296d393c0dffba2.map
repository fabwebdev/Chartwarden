{"version":3,"names":["cov_1x8exnwjuc","actualCoverage","AppError","ValidationError","NotFoundError","UnauthorizedError","ForbiddenError","BadRequestError","ConflictError","DatabaseError","RateLimitError","ServiceUnavailableError","asyncHandler","ErrorCodes","errorTestRoutes","fastify","options","f","s","get","request","reply","sessionExpired","insufficientPermissions","missingParameter","post","validationError","errors","field","message","code","VALIDATION_INVALID_EMAIL","VALIDATION_INVALID_PHONE","alreadyExists","queryFailed","loginAttempts","maintenance","obj","property","SYSTEM_ERROR","success","status","data","timestamp","Date","toISOString","availableTests"],"sources":["errorTest.routes.js"],"sourcesContent":["/**\n * Error Handling Test Routes\n * For verifying HIPAA-compliant error handling\n *\n * These routes are for testing purposes only.\n * They demonstrate various error scenarios and the proper error responses.\n */\n\nimport {\n  AppError,\n  ValidationError,\n  NotFoundError,\n  UnauthorizedError,\n  ForbiddenError,\n  BadRequestError,\n  ConflictError,\n  DatabaseError,\n  RateLimitError,\n  ServiceUnavailableError,\n  asyncHandler,\n  ErrorCodes\n} from '../utils/errorHandler.js';\n\nasync function errorTestRoutes(fastify, options) {\n  /**\n   * Test 404 Not Found error\n   * GET /api/error-test/not-found\n   */\n  fastify.get('/error-test/not-found', asyncHandler(async (request, reply) => {\n    throw new NotFoundError('Patient');\n  }, 'testNotFound'));\n\n  /**\n   * Test 401 Unauthorized error\n   * GET /api/error-test/unauthorized\n   */\n  fastify.get('/error-test/unauthorized', asyncHandler(async (request, reply) => {\n    throw UnauthorizedError.sessionExpired();\n  }, 'testUnauthorized'));\n\n  /**\n   * Test 403 Forbidden error\n   * GET /api/error-test/forbidden\n   */\n  fastify.get('/error-test/forbidden', asyncHandler(async (request, reply) => {\n    throw ForbiddenError.insufficientPermissions();\n  }, 'testForbidden'));\n\n  /**\n   * Test 400 Bad Request error\n   * GET /api/error-test/bad-request\n   */\n  fastify.get('/error-test/bad-request', asyncHandler(async (request, reply) => {\n    throw BadRequestError.missingParameter('patientId');\n  }, 'testBadRequest'));\n\n  /**\n   * Test 422 Validation error with field errors\n   * POST /api/error-test/validation\n   */\n  fastify.post('/error-test/validation', asyncHandler(async (request, reply) => {\n    const validationError = new ValidationError('Validation failed', {\n      errors: [\n        { field: 'email', message: 'Invalid email format', code: ErrorCodes.VALIDATION_INVALID_EMAIL },\n        { field: 'phone', message: 'Invalid phone format', code: ErrorCodes.VALIDATION_INVALID_PHONE }\n      ]\n    });\n    throw validationError;\n  }, 'testValidation'));\n\n  /**\n   * Test 409 Conflict error\n   * GET /api/error-test/conflict\n   */\n  fastify.get('/error-test/conflict', asyncHandler(async (request, reply) => {\n    throw ConflictError.alreadyExists('Patient record');\n  }, 'testConflict'));\n\n  /**\n   * Test 500 Database error (HIPAA-safe - no DB details exposed)\n   * GET /api/error-test/database\n   */\n  fastify.get('/error-test/database', asyncHandler(async (request, reply) => {\n    throw DatabaseError.queryFailed('SELECT * FROM patients WHERE id = 123');\n  }, 'testDatabase'));\n\n  /**\n   * Test 429 Rate Limit error\n   * GET /api/error-test/rate-limit\n   */\n  fastify.get('/error-test/rate-limit', asyncHandler(async (request, reply) => {\n    throw RateLimitError.loginAttempts(60);\n  }, 'testRateLimit'));\n\n  /**\n   * Test 503 Service Unavailable error\n   * GET /api/error-test/service-unavailable\n   */\n  fastify.get('/error-test/service-unavailable', asyncHandler(async (request, reply) => {\n    throw ServiceUnavailableError.maintenance();\n  }, 'testServiceUnavailable'));\n\n  /**\n   * Test unhandled error (programming error)\n   * This simulates an unexpected error that would be caught by the global handler\n   * GET /api/error-test/unhandled\n   */\n  fastify.get('/error-test/unhandled', asyncHandler(async (request, reply) => {\n    // This simulates an unexpected programming error\n    const obj = null;\n    return obj.property; // This will throw a TypeError\n  }, 'testUnhandled'));\n\n  /**\n   * Test error with PHI in message (should be sanitized)\n   * GET /api/error-test/phi-leak\n   */\n  fastify.get('/error-test/phi-leak', asyncHandler(async (request, reply) => {\n    // This error message contains PHI that should be logged securely but not returned to client\n    throw new AppError(\n      'Error processing patient John Doe (SSN: 123-45-6789, DOB: 01/15/1950)',\n      500,\n      { code: ErrorCodes.SYSTEM_ERROR }\n    );\n  }, 'testPhiLeak'));\n\n  /**\n   * Test successful response (for comparison)\n   * GET /api/error-test/success\n   */\n  fastify.get('/error-test/success', async (request, reply) => {\n    return {\n      success: true,\n      status: 200,\n      message: 'Error handling test endpoint is working',\n      data: {\n        timestamp: new Date().toISOString(),\n        availableTests: [\n          'GET /api/error-test/not-found - 404 Not Found',\n          'GET /api/error-test/unauthorized - 401 Unauthorized',\n          'GET /api/error-test/forbidden - 403 Forbidden',\n          'GET /api/error-test/bad-request - 400 Bad Request',\n          'POST /api/error-test/validation - 422 Validation Error',\n          'GET /api/error-test/conflict - 409 Conflict',\n          'GET /api/error-test/database - 500 Database Error (safe)',\n          'GET /api/error-test/rate-limit - 429 Rate Limit',\n          'GET /api/error-test/service-unavailable - 503 Service Unavailable',\n          'GET /api/error-test/unhandled - 500 Unhandled Error',\n          'GET /api/error-test/phi-leak - 500 PHI Sanitization Test'\n        ]\n      }\n    };\n  });\n}\n\nexport default errorTestRoutes;\n"],"mappings":"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","ignoreList":[]}