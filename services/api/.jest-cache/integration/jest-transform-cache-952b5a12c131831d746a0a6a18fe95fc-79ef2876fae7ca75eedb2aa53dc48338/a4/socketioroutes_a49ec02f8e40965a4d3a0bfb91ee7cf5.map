{"version":3,"names":["cov_1blzw7q6tv","actualCoverage","authenticate","requireRole","ROLES","socketIOService","socketMetrics","socketIORoutes","fastify","options","f","s","get","request","reply","isInitialized","metrics","getMetrics","send","success","data","status","b","initialized","activeConnections","connectedUsers","timestamp","Date","toISOString","preHandler","ADMIN","connections","total","totalConnections","active","uniqueUsers","authentication","failures","authFailures","messages","totalMessages","reconnections","io","code","error","sockets","fetchSockets","map","socket","socketId","id","userId","user","role","rooms","Array","from","connectedAt","getConnectionInfo","count","length","params","isConnected","isUserConnected","socketIds","getUserSockets","connectionCount","post","schema","body","type","required","properties","event","room","toRoom","broadcast","message","title","enum","notifyUser","Object","values","includes","notifyRole","delete","find","disconnect","disconnected"],"sources":["socketio.routes.js"],"sourcesContent":["/**\n * Socket.IO Management Routes\n *\n * Provides endpoints for Socket.IO monitoring and management:\n * - Health check for WebSocket connectivity\n * - Metrics and connection statistics\n * - Admin operations (broadcast, disconnect users)\n *\n * @module routes/socketio.routes\n */\n\nimport { authenticate } from \"../middleware/betterAuth.middleware.js\";\nimport { requireRole } from \"../middleware/rbac.middleware.js\";\nimport { ROLES } from \"../config/rbac.js\";\nimport socketIOService, { socketMetrics } from \"../services/SocketIO.service.js\";\n\nasync function socketIORoutes(fastify, options) {\n  /**\n   * GET /api/socket.io/health\n   * Health check for Socket.IO service\n   * Public endpoint for monitoring\n   */\n  fastify.get(\"/health\", async (request, reply) => {\n    const isInitialized = socketIOService.isInitialized;\n    const metrics = socketIOService.getMetrics();\n\n    return reply.send({\n      success: true,\n      data: {\n        status: isInitialized ? \"healthy\" : \"not_initialized\",\n        initialized: isInitialized,\n        activeConnections: metrics.activeConnections,\n        connectedUsers: metrics.connectedUsers,\n        timestamp: new Date().toISOString(),\n      },\n    });\n  });\n\n  /**\n   * GET /api/socket.io/metrics\n   * Get Socket.IO metrics and statistics\n   * Requires admin role\n   */\n  fastify.get(\n    \"/metrics\",\n    {\n      preHandler: [authenticate, requireRole(ROLES.ADMIN)],\n    },\n    async (request, reply) => {\n      const metrics = socketIOService.getMetrics();\n\n      return reply.send({\n        success: true,\n        data: {\n          connections: {\n            total: metrics.totalConnections,\n            active: metrics.activeConnections,\n            uniqueUsers: metrics.connectedUsers,\n          },\n          authentication: {\n            failures: metrics.authFailures,\n          },\n          messages: {\n            total: metrics.totalMessages,\n          },\n          reconnections: metrics.reconnections,\n          timestamp: new Date().toISOString(),\n        },\n      });\n    }\n  );\n\n  /**\n   * GET /api/socket.io/connections\n   * Get list of active connections (admin only)\n   */\n  fastify.get(\n    \"/connections\",\n    {\n      preHandler: [authenticate, requireRole(ROLES.ADMIN)],\n    },\n    async (request, reply) => {\n      // Get all connected sockets from the main namespace\n      const io = socketIOService.io;\n      if (!io) {\n        return reply.code(503).send({\n          success: false,\n          error: \"Socket.IO not initialized\",\n        });\n      }\n\n      const sockets = await io.fetchSockets();\n      const connections = sockets.map((socket) => ({\n        socketId: socket.id,\n        userId: socket.user?.id,\n        role: socket.user?.role,\n        rooms: Array.from(socket.rooms),\n        connectedAt: socketIOService.getConnectionInfo(socket.id)?.connectedAt,\n      }));\n\n      return reply.send({\n        success: true,\n        data: {\n          count: connections.length,\n          connections,\n        },\n      });\n    }\n  );\n\n  /**\n   * GET /api/socket.io/user/:userId/status\n   * Check if a specific user is connected\n   */\n  fastify.get(\n    \"/user/:userId/status\",\n    {\n      preHandler: [authenticate],\n    },\n    async (request, reply) => {\n      const { userId } = request.params;\n\n      // Users can check their own status, admins can check anyone\n      if (request.user.id !== userId && request.user.role !== ROLES.ADMIN) {\n        return reply.code(403).send({\n          success: false,\n          error: \"Not authorized to check this user's status\",\n        });\n      }\n\n      const isConnected = socketIOService.isUserConnected(userId);\n      const socketIds = socketIOService.getUserSockets(userId);\n\n      return reply.send({\n        success: true,\n        data: {\n          userId,\n          isConnected,\n          connectionCount: socketIds.length,\n        },\n      });\n    }\n  );\n\n  /**\n   * POST /api/socket.io/broadcast\n   * Broadcast a message to all connected clients (admin only)\n   */\n  fastify.post(\n    \"/broadcast\",\n    {\n      preHandler: [authenticate, requireRole(ROLES.ADMIN)],\n      schema: {\n        body: {\n          type: \"object\",\n          required: [\"event\", \"data\"],\n          properties: {\n            event: { type: \"string\" },\n            data: { type: \"object\" },\n            room: { type: \"string\" },\n          },\n        },\n      },\n    },\n    async (request, reply) => {\n      const { event, data, room } = request.body;\n\n      if (room) {\n        socketIOService.toRoom(room, event, data);\n      } else {\n        socketIOService.broadcast(event, data);\n      }\n\n      return reply.send({\n        success: true,\n        message: room\n          ? `Event '${event}' broadcast to room '${room}'`\n          : `Event '${event}' broadcast to all clients`,\n      });\n    }\n  );\n\n  /**\n   * POST /api/socket.io/notify/:userId\n   * Send a notification to a specific user (admin only)\n   */\n  fastify.post(\n    \"/notify/:userId\",\n    {\n      preHandler: [authenticate, requireRole(ROLES.ADMIN)],\n      schema: {\n        body: {\n          type: \"object\",\n          required: [\"title\", \"message\"],\n          properties: {\n            title: { type: \"string\" },\n            message: { type: \"string\" },\n            type: { type: \"string\", enum: [\"info\", \"success\", \"warning\", \"error\"] },\n            data: { type: \"object\" },\n          },\n        },\n      },\n    },\n    async (request, reply) => {\n      const { userId } = request.params;\n      const { title, message, type = \"info\", data } = request.body;\n\n      socketIOService.notifyUser(userId, { title, message, type, data });\n\n      return reply.send({\n        success: true,\n        message: `Notification sent to user ${userId}`,\n      });\n    }\n  );\n\n  /**\n   * POST /api/socket.io/notify/role/:role\n   * Send a notification to all users with a specific role (admin only)\n   */\n  fastify.post(\n    \"/notify/role/:role\",\n    {\n      preHandler: [authenticate, requireRole(ROLES.ADMIN)],\n      schema: {\n        body: {\n          type: \"object\",\n          required: [\"title\", \"message\"],\n          properties: {\n            title: { type: \"string\" },\n            message: { type: \"string\" },\n            type: { type: \"string\", enum: [\"info\", \"success\", \"warning\", \"error\"] },\n            data: { type: \"object\" },\n          },\n        },\n      },\n    },\n    async (request, reply) => {\n      const { role } = request.params;\n      const { title, message, type = \"info\", data } = request.body;\n\n      // Validate role\n      if (!Object.values(ROLES).includes(role)) {\n        return reply.code(400).send({\n          success: false,\n          error: `Invalid role: ${role}`,\n        });\n      }\n\n      socketIOService.notifyRole(role, { title, message, type, data });\n\n      return reply.send({\n        success: true,\n        message: `Notification sent to all users with role '${role}'`,\n      });\n    }\n  );\n\n  /**\n   * DELETE /api/socket.io/disconnect/:socketId\n   * Disconnect a specific socket (admin only)\n   */\n  fastify.delete(\n    \"/disconnect/:socketId\",\n    {\n      preHandler: [authenticate, requireRole(ROLES.ADMIN)],\n    },\n    async (request, reply) => {\n      const { socketId } = request.params;\n\n      const io = socketIOService.io;\n      if (!io) {\n        return reply.code(503).send({\n          success: false,\n          error: \"Socket.IO not initialized\",\n        });\n      }\n\n      const sockets = await io.fetchSockets();\n      const socket = sockets.find((s) => s.id === socketId);\n\n      if (!socket) {\n        return reply.code(404).send({\n          success: false,\n          error: `Socket ${socketId} not found`,\n        });\n      }\n\n      socket.disconnect(true);\n\n      return reply.send({\n        success: true,\n        message: `Socket ${socketId} disconnected`,\n      });\n    }\n  );\n\n  /**\n   * DELETE /api/socket.io/disconnect/user/:userId\n   * Disconnect all sockets for a specific user (admin only)\n   */\n  fastify.delete(\n    \"/disconnect/user/:userId\",\n    {\n      preHandler: [authenticate, requireRole(ROLES.ADMIN)],\n    },\n    async (request, reply) => {\n      const { userId } = request.params;\n\n      const io = socketIOService.io;\n      if (!io) {\n        return reply.code(503).send({\n          success: false,\n          error: \"Socket.IO not initialized\",\n        });\n      }\n\n      const socketIds = socketIOService.getUserSockets(userId);\n      if (socketIds.length === 0) {\n        return reply.code(404).send({\n          success: false,\n          error: `No active connections for user ${userId}`,\n        });\n      }\n\n      const sockets = await io.fetchSockets();\n      let disconnected = 0;\n\n      for (const socket of sockets) {\n        if (socketIds.includes(socket.id)) {\n          socket.disconnect(true);\n          disconnected++;\n        }\n      }\n\n      return reply.send({\n        success: true,\n        message: `Disconnected ${disconnected} socket(s) for user ${userId}`,\n      });\n    }\n  );\n}\n\nexport default socketIORoutes;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}