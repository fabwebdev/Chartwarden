{"version":3,"names":["cov_dtvxadedi","actualCoverage","pgTable","bigint","varchar","timestamp","boolean","index","text","patients","users","patient_contacts","s","id","mode","primaryKey","generatedByDefaultAsIdentity","patient_id","references","f","notNull","contact_type","length","default","first_name","last_name","middle_name","suffix","preferred_name","relationship","relationship_detail","primary_phone","primary_phone_type","secondary_phone","secondary_phone_type","email","address_line_1","address_line_2","city","state","zip_code","country","preferred_contact_method","preferred_contact_time","preferred_language","priority","is_primary","is_active","authorized_for_phi","authorized_for_decisions","has_key_to_home","lives_with_patient","healthcare_proxy_document","power_of_attorney","document_date","notes","special_instructions","created_by_id","updated_by_id","deleted_at","createdAt","defaultNow","updatedAt","table","patientIdx","on","typeIdx","lastNameIdx","activeIdx","priorityIdx","patientTypeIdx","patientActiveIdx","patientPriorityIdx","patientTypePrimaryIdx","patientContacts"],"sources":["patientContact.schema.js"],"sourcesContent":["import { pgTable, bigint, varchar, timestamp, boolean, index, text } from 'drizzle-orm/pg-core';\nimport { patients } from './patient.schema.js';\nimport { users } from './user.schema.js';\n\n/**\n * Patient Contacts - Emergency and related contacts for patients\n * Manages emergency contacts, family members, caregivers, and other important contacts\n *\n * COMPLIANCE: Required for HIPAA emergency notifications and care coordination\n *\n * Contact types:\n * - EMERGENCY: Primary emergency contact (required for hospice patients)\n * - FAMILY: Family members who may be involved in care decisions\n * - CAREGIVER: Non-family caregivers (aides, neighbors, friends)\n * - HEALTHCARE_PROXY: Person with healthcare power of attorney\n * - LEGAL: Legal guardian or conservator\n * - FUNERAL_HOME: Funeral home contact (for end-of-life planning)\n * - CLERGY: Religious/spiritual contact\n * - OTHER: Other important contacts\n *\n * Use cases:\n * - Store multiple emergency contacts with priority ordering\n * - Track relationships for family care meetings\n * - Document healthcare proxies for decision-making\n * - Maintain funeral home contacts for end-of-life coordination\n */\nexport const patient_contacts = pgTable('patient_contacts', {\n  id: bigint('id', { mode: 'number' }).primaryKey().generatedByDefaultAsIdentity(),\n  patient_id: bigint('patient_id', { mode: 'number' }).references(() => patients.id).notNull(),\n\n  // Contact classification\n  contact_type: varchar('contact_type', { length: 50 }).default('EMERGENCY').notNull(), // EMERGENCY, FAMILY, CAREGIVER, HEALTHCARE_PROXY, LEGAL, FUNERAL_HOME, CLERGY, OTHER\n\n  // Name information\n  first_name: varchar('first_name', { length: 100 }).notNull(),\n  last_name: varchar('last_name', { length: 100 }).notNull(),\n  middle_name: varchar('middle_name', { length: 100 }),\n  suffix: varchar('suffix', { length: 20 }), // Jr., Sr., III, etc.\n  preferred_name: varchar('preferred_name', { length: 100 }), // Nickname or preferred name\n\n  // Relationship to patient\n  relationship: varchar('relationship', { length: 100 }).notNull(), // Spouse, Son, Daughter, Parent, Sibling, Friend, Neighbor, etc.\n  relationship_detail: varchar('relationship_detail', { length: 255 }), // Additional relationship details (e.g., \"Eldest daughter\", \"Lives nearby\")\n\n  // Phone numbers\n  primary_phone: varchar('primary_phone', { length: 20 }).notNull(), // Primary contact number\n  primary_phone_type: varchar('primary_phone_type', { length: 20 }).default('MOBILE'), // MOBILE, HOME, WORK\n  secondary_phone: varchar('secondary_phone', { length: 20 }), // Alternate number\n  secondary_phone_type: varchar('secondary_phone_type', { length: 20 }), // MOBILE, HOME, WORK\n\n  // Email\n  email: varchar('email', { length: 255 }),\n\n  // Address information\n  address_line_1: varchar('address_line_1', { length: 255 }),\n  address_line_2: varchar('address_line_2', { length: 255 }),\n  city: varchar('city', { length: 100 }),\n  state: varchar('state', { length: 2 }), // Two-letter state code\n  zip_code: varchar('zip_code', { length: 10 }), // Format: 12345 or 12345-6789\n  country: varchar('country', { length: 100 }).default('USA'),\n\n  // Contact preferences\n  preferred_contact_method: varchar('preferred_contact_method', { length: 20 }).default('PHONE'), // PHONE, EMAIL, TEXT\n  preferred_contact_time: varchar('preferred_contact_time', { length: 50 }), // e.g., \"Weekday mornings\", \"After 5pm\"\n  preferred_language: varchar('preferred_language', { length: 50 }), // Language preference for communication\n\n  // Priority and status\n  priority: bigint('priority', { mode: 'number' }).default(1), // Order of contact (1 = first to call)\n  is_primary: boolean('is_primary').default(false), // True if this is the primary contact for its type\n  is_active: boolean('is_active').default(true), // Contact is currently active\n\n  // Authorization flags\n  authorized_for_phi: boolean('authorized_for_phi').default(false), // Authorized to receive Protected Health Information\n  authorized_for_decisions: boolean('authorized_for_decisions').default(false), // Can make care decisions\n  has_key_to_home: boolean('has_key_to_home').default(false), // Has key to patient's residence\n  lives_with_patient: boolean('lives_with_patient').default(false), // Lives at same address as patient\n\n  // Legal/compliance fields\n  healthcare_proxy_document: boolean('healthcare_proxy_document').default(false), // Healthcare proxy document on file\n  power_of_attorney: boolean('power_of_attorney').default(false), // POA document on file\n  document_date: timestamp('document_date'), // Date of legal document\n\n  // Notes\n  notes: text('notes'), // General notes about this contact\n  special_instructions: text('special_instructions'), // Special contact instructions\n\n  // Audit fields\n  created_by_id: text('created_by_id').references(() => users.id),\n  updated_by_id: text('updated_by_id').references(() => users.id),\n  deleted_at: timestamp('deleted_at'), // Soft delete\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n}, (table) => ({\n  // Single column indexes for common lookups\n  patientIdx: index('idx_patient_contacts_patient_id').on(table.patient_id),\n  typeIdx: index('idx_patient_contacts_type').on(table.contact_type),\n  lastNameIdx: index('idx_patient_contacts_last_name').on(table.last_name),\n  activeIdx: index('idx_patient_contacts_is_active').on(table.is_active),\n  priorityIdx: index('idx_patient_contacts_priority').on(table.priority),\n\n  // Composite indexes for common query patterns\n  patientTypeIdx: index('idx_patient_contacts_patient_type')\n    .on(table.patient_id, table.contact_type),\n  patientActiveIdx: index('idx_patient_contacts_patient_active')\n    .on(table.patient_id, table.is_active),\n  patientPriorityIdx: index('idx_patient_contacts_patient_priority')\n    .on(table.patient_id, table.priority),\n  patientTypePrimaryIdx: index('idx_patient_contacts_patient_type_primary')\n    .on(table.patient_id, table.contact_type, table.is_primary),\n}));\n\n// Keep legacy export name for backwards compatibility\nexport const patientContacts = patient_contacts;\n"],"mappings":"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","ignoreList":[]}