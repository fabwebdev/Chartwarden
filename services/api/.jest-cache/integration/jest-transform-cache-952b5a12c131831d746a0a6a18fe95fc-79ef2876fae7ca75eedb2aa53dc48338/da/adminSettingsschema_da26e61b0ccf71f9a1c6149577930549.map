{"version":3,"names":["cov_1ql4nhozs8","actualCoverage","pgTable","bigint","varchar","text","timestamp","boolean","jsonb","integer","index","users","admin_settings","s","id","mode","primaryKey","generatedByDefaultAsIdentity","setting_key","length","unique","notNull","name","description","setting_value","default_value","setting_type","category","options","validation_rules","display_order","default","is_sensitive","requires_restart","is_readonly","metadata","created_by_id","references","f","updated_by_id","created_at","defaultNow","updated_at","table","keyIdx","on","categoryIdx","typeIdx","admin_settings_history","setting_id","previous_value","new_value","change_reason","ip_address","user_agent","session_id","changed_by_id","changed_at","settingIdx","settingKeyIdx","changedByIdx","changedAtIdx"],"sources":["adminSettings.schema.js"],"sourcesContent":["import { pgTable, bigint, varchar, text, timestamp, boolean, jsonb, integer, index } from 'drizzle-orm/pg-core';\nimport { users } from './user.schema.js';\n\n/**\n * Admin Settings Module\n * System-wide configuration settings for the hospice EHR system\n *\n * Purpose: Store and manage system configuration settings and clearinghouse integration parameters\n * Compliance: HIPAA audit trail, encrypted sensitive credentials\n *\n * Tables:\n * - admin_settings: General system configuration parameters\n * - admin_settings_history: Audit trail of all settings changes\n */\n\n/**\n * Admin Settings Table\n * Stores system-wide configuration settings organized by category\n */\nexport const admin_settings = pgTable('admin_settings', {\n  id: bigint('id', { mode: 'number' }).primaryKey().generatedByDefaultAsIdentity(),\n\n  // Setting identification\n  setting_key: varchar('setting_key', { length: 100 }).unique().notNull(),\n  name: varchar('name', { length: 255 }).notNull(),\n  description: text('description'),\n\n  // Setting value\n  setting_value: text('setting_value'),\n  default_value: text('default_value'),\n\n  // Setting type for validation\n  setting_type: varchar('setting_type', { length: 50 }).notNull(),\n  // Types: STRING, INTEGER, BOOLEAN, JSON, ENCRYPTED, URL, EMAIL, SELECT\n\n  // Category for grouping\n  category: varchar('category', { length: 50 }).notNull(),\n  // Categories: SYSTEM, SECURITY, CLEARINGHOUSE, NOTIFICATIONS, INTEGRATION, APPEARANCE\n\n  // For SELECT type settings - available options\n  options: jsonb('options'), // Array of { value: string, label: string }\n\n  // Validation rules\n  validation_rules: jsonb('validation_rules'), // { min, max, pattern, required, etc. }\n\n  // Display order within category\n  display_order: integer('display_order').default(0),\n\n  // Flags\n  is_sensitive: boolean('is_sensitive').default(false), // If true, value should be masked in UI\n  requires_restart: boolean('requires_restart').default(false), // If true, changes require app restart\n  is_readonly: boolean('is_readonly').default(false), // If true, cannot be edited via UI\n\n  // Metadata\n  metadata: jsonb('metadata'),\n\n  // Audit fields\n  created_by_id: text('created_by_id').references(() => users.id),\n  updated_by_id: text('updated_by_id').references(() => users.id),\n  created_at: timestamp('created_at').defaultNow().notNull(),\n  updated_at: timestamp('updated_at').defaultNow().notNull()\n}, (table) => ({\n  keyIdx: index('idx_admin_settings_key').on(table.setting_key),\n  categoryIdx: index('idx_admin_settings_category').on(table.category),\n  typeIdx: index('idx_admin_settings_type').on(table.setting_type),\n}));\n\n/**\n * Admin Settings History Table\n * Audit trail of all settings changes - HIPAA compliant\n */\nexport const admin_settings_history = pgTable('admin_settings_history', {\n  id: bigint('id', { mode: 'number' }).primaryKey().generatedByDefaultAsIdentity(),\n\n  // Reference to setting\n  setting_id: bigint('setting_id', { mode: 'number' }).references(() => admin_settings.id).notNull(),\n  setting_key: varchar('setting_key', { length: 100 }).notNull(),\n\n  // Change details\n  previous_value: text('previous_value'),\n  new_value: text('new_value'),\n\n  // Change context\n  change_reason: text('change_reason'),\n\n  // Session/request context\n  ip_address: varchar('ip_address', { length: 45 }),\n  user_agent: text('user_agent'),\n  session_id: varchar('session_id', { length: 255 }),\n\n  // Audit fields\n  changed_by_id: text('changed_by_id').references(() => users.id).notNull(),\n  changed_at: timestamp('changed_at').defaultNow().notNull()\n}, (table) => ({\n  settingIdx: index('idx_admin_settings_history_setting').on(table.setting_id),\n  settingKeyIdx: index('idx_admin_settings_history_key').on(table.setting_key),\n  changedByIdx: index('idx_admin_settings_history_user').on(table.changed_by_id),\n  changedAtIdx: index('idx_admin_settings_history_date').on(table.changed_at),\n}));\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,cAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,cAAA;AAfZ,SAASE,OAAO,EAAEC,MAAM,EAAEC,OAAO,EAAEC,IAAI,EAAEC,SAAS,EAAEC,OAAO,EAAEC,KAAK,EAAEC,OAAO,EAAEC,KAAK,QAAQ,qBAAqB;AAC/G,SAASC,KAAK,QAAQ,kBAAkB;;AAExC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO,MAAMC,cAAc;AAAA;AAAA,CAAAZ,cAAA,GAAAa,CAAA,OAAGX,OAAO,CAAC,gBAAgB,EAAE;EACtDY,EAAE,EAAEX,MAAM,CAAC,IAAI,EAAE;IAAEY,IAAI,EAAE;EAAS,CAAC,CAAC,CAACC,UAAU,CAAC,CAAC,CAACC,4BAA4B,CAAC,CAAC;EAEhF;EACAC,WAAW,EAAEd,OAAO,CAAC,aAAa,EAAE;IAAEe,MAAM,EAAE;EAAI,CAAC,CAAC,CAACC,MAAM,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;EACvEC,IAAI,EAAElB,OAAO,CAAC,MAAM,EAAE;IAAEe,MAAM,EAAE;EAAI,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC;EAChDE,WAAW,EAAElB,IAAI,CAAC,aAAa,CAAC;EAEhC;EACAmB,aAAa,EAAEnB,IAAI,CAAC,eAAe,CAAC;EACpCoB,aAAa,EAAEpB,IAAI,CAAC,eAAe,CAAC;EAEpC;EACAqB,YAAY,EAAEtB,OAAO,CAAC,cAAc,EAAE;IAAEe,MAAM,EAAE;EAAG,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC;EAC/D;;EAEA;EACAM,QAAQ,EAAEvB,OAAO,CAAC,UAAU,EAAE;IAAEe,MAAM,EAAE;EAAG,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC;EACvD;;EAEA;EACAO,OAAO,EAAEpB,KAAK,CAAC,SAAS,CAAC;EAAE;;EAE3B;EACAqB,gBAAgB,EAAErB,KAAK,CAAC,kBAAkB,CAAC;EAAE;;EAE7C;EACAsB,aAAa,EAAErB,OAAO,CAAC,eAAe,CAAC,CAACsB,OAAO,CAAC,CAAC,CAAC;EAElD;EACAC,YAAY,EAAEzB,OAAO,CAAC,cAAc,CAAC,CAACwB,OAAO,CAAC,KAAK,CAAC;EAAE;EACtDE,gBAAgB,EAAE1B,OAAO,CAAC,kBAAkB,CAAC,CAACwB,OAAO,CAAC,KAAK,CAAC;EAAE;EAC9DG,WAAW,EAAE3B,OAAO,CAAC,aAAa,CAAC,CAACwB,OAAO,CAAC,KAAK,CAAC;EAAE;;EAEpD;EACAI,QAAQ,EAAE3B,KAAK,CAAC,UAAU,CAAC;EAE3B;EACA4B,aAAa,EAAE/B,IAAI,CAAC,eAAe,CAAC,CAACgC,UAAU,CAAC,MAAM;IAAA;IAAArC,cAAA,GAAAsC,CAAA;IAAAtC,cAAA,GAAAa,CAAA;IAAA,OAAAF,KAAK,CAACG,EAAE;EAAD,CAAC,CAAC;EAC/DyB,aAAa,EAAElC,IAAI,CAAC,eAAe,CAAC,CAACgC,UAAU,CAAC,MAAM;IAAA;IAAArC,cAAA,GAAAsC,CAAA;IAAAtC,cAAA,GAAAa,CAAA;IAAA,OAAAF,KAAK,CAACG,EAAE;EAAD,CAAC,CAAC;EAC/D0B,UAAU,EAAElC,SAAS,CAAC,YAAY,CAAC,CAACmC,UAAU,CAAC,CAAC,CAACpB,OAAO,CAAC,CAAC;EAC1DqB,UAAU,EAAEpC,SAAS,CAAC,YAAY,CAAC,CAACmC,UAAU,CAAC,CAAC,CAACpB,OAAO,CAAC;AAC3D,CAAC,EAAGsB,KAAK,IAAM;EAAA;EAAA3C,cAAA,GAAAsC,CAAA;EAAAtC,cAAA,GAAAa,CAAA;EAAA;IACb+B,MAAM,EAAElC,KAAK,CAAC,wBAAwB,CAAC,CAACmC,EAAE,CAACF,KAAK,CAACzB,WAAW,CAAC;IAC7D4B,WAAW,EAAEpC,KAAK,CAAC,6BAA6B,CAAC,CAACmC,EAAE,CAACF,KAAK,CAAChB,QAAQ,CAAC;IACpEoB,OAAO,EAAErC,KAAK,CAAC,yBAAyB,CAAC,CAACmC,EAAE,CAACF,KAAK,CAACjB,YAAY;EACjE,CAAC;AAAD,CAAE,CAAC;;AAEH;AACA;AACA;AACA;AACA,OAAO,MAAMsB,sBAAsB;AAAA;AAAA,CAAAhD,cAAA,GAAAa,CAAA,OAAGX,OAAO,CAAC,wBAAwB,EAAE;EACtEY,EAAE,EAAEX,MAAM,CAAC,IAAI,EAAE;IAAEY,IAAI,EAAE;EAAS,CAAC,CAAC,CAACC,UAAU,CAAC,CAAC,CAACC,4BAA4B,CAAC,CAAC;EAEhF;EACAgC,UAAU,EAAE9C,MAAM,CAAC,YAAY,EAAE;IAAEY,IAAI,EAAE;EAAS,CAAC,CAAC,CAACsB,UAAU,CAAC,MAAM;IAAA;IAAArC,cAAA,GAAAsC,CAAA;IAAAtC,cAAA,GAAAa,CAAA;IAAA,OAAAD,cAAc,CAACE,EAAE;EAAD,CAAC,CAAC,CAACO,OAAO,CAAC,CAAC;EAClGH,WAAW,EAAEd,OAAO,CAAC,aAAa,EAAE;IAAEe,MAAM,EAAE;EAAI,CAAC,CAAC,CAACE,OAAO,CAAC,CAAC;EAE9D;EACA6B,cAAc,EAAE7C,IAAI,CAAC,gBAAgB,CAAC;EACtC8C,SAAS,EAAE9C,IAAI,CAAC,WAAW,CAAC;EAE5B;EACA+C,aAAa,EAAE/C,IAAI,CAAC,eAAe,CAAC;EAEpC;EACAgD,UAAU,EAAEjD,OAAO,CAAC,YAAY,EAAE;IAAEe,MAAM,EAAE;EAAG,CAAC,CAAC;EACjDmC,UAAU,EAAEjD,IAAI,CAAC,YAAY,CAAC;EAC9BkD,UAAU,EAAEnD,OAAO,CAAC,YAAY,EAAE;IAAEe,MAAM,EAAE;EAAI,CAAC,CAAC;EAElD;EACAqC,aAAa,EAAEnD,IAAI,CAAC,eAAe,CAAC,CAACgC,UAAU,CAAC,MAAM;IAAA;IAAArC,cAAA,GAAAsC,CAAA;IAAAtC,cAAA,GAAAa,CAAA;IAAA,OAAAF,KAAK,CAACG,EAAE;EAAD,CAAC,CAAC,CAACO,OAAO,CAAC,CAAC;EACzEoC,UAAU,EAAEnD,SAAS,CAAC,YAAY,CAAC,CAACmC,UAAU,CAAC,CAAC,CAACpB,OAAO,CAAC;AAC3D,CAAC,EAAGsB,KAAK,IAAM;EAAA;EAAA3C,cAAA,GAAAsC,CAAA;EAAAtC,cAAA,GAAAa,CAAA;EAAA;IACb6C,UAAU,EAAEhD,KAAK,CAAC,oCAAoC,CAAC,CAACmC,EAAE,CAACF,KAAK,CAACM,UAAU,CAAC;IAC5EU,aAAa,EAAEjD,KAAK,CAAC,gCAAgC,CAAC,CAACmC,EAAE,CAACF,KAAK,CAACzB,WAAW,CAAC;IAC5E0C,YAAY,EAAElD,KAAK,CAAC,iCAAiC,CAAC,CAACmC,EAAE,CAACF,KAAK,CAACa,aAAa,CAAC;IAC9EK,YAAY,EAAEnD,KAAK,CAAC,iCAAiC,CAAC,CAACmC,EAAE,CAACF,KAAK,CAACc,UAAU;EAC5E,CAAC;AAAD,CAAE,CAAC","ignoreList":[]}