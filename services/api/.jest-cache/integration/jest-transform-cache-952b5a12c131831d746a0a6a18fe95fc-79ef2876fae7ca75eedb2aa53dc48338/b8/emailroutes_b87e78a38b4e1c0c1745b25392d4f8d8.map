{"version":3,"names":["cov_9gein4i5n","actualCoverage","authenticate","requireRole","ROLES","MailService","Mail","logger","welcomeEmailHtml","welcomeEmailText","passwordResetEmailHtml","passwordResetEmailText","notificationEmailHtml","notificationEmailText","emailRoutes","fastify","options","f","s","get","preHandler","ADMIN","request","reply","isValid","verify","status","message","b","data","verified","mailer","process","env","MAIL_MAILER","host","MAIL_HOST","port","MAIL_PORT","fromAddress","MAIL_FROM_ADDRESS","error","code","send","post","schema","body","type","required","properties","to","format","template","enum","default","testData","name","email","loginUrl","APP_URL","supportEmail","SUPPORT_EMAIL","resetUrl","expiresInMinutes","title","recipientName","subject","html","text","result","info","messageId","params","sampleData","action","url","details","label","value","Date","toLocaleDateString","encryption","MAIL_ENCRYPTION","fromName","MAIL_FROM_NAME","hasUsername","MAIL_USERNAME","hasPassword","MAIL_PASSWORD"],"sources":["email.routes.js"],"sourcesContent":["/**\n * Email Routes\n * API endpoints for email testing and management\n */\n\nimport { authenticate } from '../middleware/betterAuth.middleware.js';\nimport { requireRole } from '../middleware/rbac.middleware.js';\nimport { ROLES } from '../config/rbac.js';\nimport MailService from '../services/MailService.js';\nimport Mail from '../facades/Mail.js';\nimport { logger } from '../utils/logger.js';\nimport {\n  welcomeEmailHtml,\n  welcomeEmailText\n} from '../templates/email/welcome.template.js';\nimport {\n  passwordResetEmailHtml,\n  passwordResetEmailText\n} from '../templates/email/password-reset.template.js';\nimport {\n  notificationEmailHtml,\n  notificationEmailText\n} from '../templates/email/notification.template.js';\n\nasync function emailRoutes(fastify, options) {\n  /**\n   * Verify mail configuration\n   * GET /api/email/verify\n   * Admin only\n   */\n  fastify.get(\n    '/verify',\n    {\n      preHandler: [authenticate, requireRole(ROLES.ADMIN)]\n    },\n    async (request, reply) => {\n      try {\n        const isValid = await Mail.verify();\n\n        return {\n          status: 200,\n          message: isValid\n            ? 'Mail transporter verified successfully'\n            : 'Mail transporter verification failed',\n          data: {\n            verified: isValid,\n            mailer: process.env.MAIL_MAILER || 'smtp',\n            host: process.env.MAIL_HOST || 'not configured',\n            port: process.env.MAIL_PORT || 'not configured',\n            fromAddress: process.env.MAIL_FROM_ADDRESS || 'not configured'\n          }\n        };\n      } catch (error) {\n        logger.error('Mail verification error:', error);\n        return reply.code(500).send({\n          status: 500,\n          message: 'Failed to verify mail configuration',\n          error: error.message\n        });\n      }\n    }\n  );\n\n  /**\n   * Send a test email\n   * POST /api/email/test\n   * Admin only\n   * Body: { to: string, template?: 'welcome' | 'password-reset' | 'notification' }\n   */\n  fastify.post(\n    '/test',\n    {\n      preHandler: [authenticate, requireRole(ROLES.ADMIN)],\n      schema: {\n        body: {\n          type: 'object',\n          required: ['to'],\n          properties: {\n            to: { type: 'string', format: 'email' },\n            template: {\n              type: 'string',\n              enum: ['welcome', 'password-reset', 'notification'],\n              default: 'notification'\n            }\n          }\n        }\n      }\n    },\n    async (request, reply) => {\n      try {\n        const { to, template = 'notification' } = request.body;\n        const testData = {\n          name: 'Test User',\n          email: to,\n          loginUrl: process.env.APP_URL || 'http://localhost:3000',\n          supportEmail: process.env.SUPPORT_EMAIL || 'support@chartwarden.com',\n          resetUrl: `${process.env.APP_URL || 'http://localhost:3000'}/auth/reset-password?token=test-token`,\n          expiresInMinutes: 60,\n          title: 'Test Notification',\n          message: 'This is a test notification email from Chartwarden. If you received this email, the email system is working correctly.',\n          type: 'info',\n          recipientName: 'Test User'\n        };\n\n        let subject, html, text;\n\n        switch (template) {\n          case 'welcome':\n            subject = 'Test: Welcome to Chartwarden';\n            html = welcomeEmailHtml(testData);\n            text = welcomeEmailText(testData);\n            break;\n          case 'password-reset':\n            subject = 'Test: Password Reset Request';\n            html = passwordResetEmailHtml(testData);\n            text = passwordResetEmailText(testData);\n            break;\n          case 'notification':\n          default:\n            subject = 'Test: Chartwarden Notification';\n            html = notificationEmailHtml(testData);\n            text = notificationEmailText(testData);\n            break;\n        }\n\n        const result = await Mail.send({\n          to,\n          subject,\n          html,\n          text\n        });\n\n        logger.info('Test email sent:', { to, template, messageId: result.messageId });\n\n        return {\n          status: 200,\n          message: 'Test email sent successfully',\n          data: {\n            to,\n            template,\n            messageId: result.messageId\n          }\n        };\n      } catch (error) {\n        logger.error('Test email error:', error);\n        return reply.code(500).send({\n          status: 500,\n          message: 'Failed to send test email',\n          error: error.message\n        });\n      }\n    }\n  );\n\n  /**\n   * Preview email template (returns HTML)\n   * GET /api/email/preview/:template\n   * Admin only\n   */\n  fastify.get(\n    '/preview/:template',\n    {\n      preHandler: [authenticate, requireRole(ROLES.ADMIN)],\n      schema: {\n        params: {\n          type: 'object',\n          required: ['template'],\n          properties: {\n            template: {\n              type: 'string',\n              enum: ['welcome', 'password-reset', 'notification']\n            }\n          }\n        }\n      }\n    },\n    async (request, reply) => {\n      try {\n        const { template } = request.params;\n        const sampleData = {\n          name: 'John Doe',\n          email: 'john.doe@example.com',\n          loginUrl: 'http://localhost:3000',\n          supportEmail: 'support@chartwarden.com',\n          resetUrl: 'http://localhost:3000/auth/reset-password?token=sample-token-12345',\n          expiresInMinutes: 60,\n          title: 'Sample Notification',\n          message: 'This is a sample notification message for preview purposes.',\n          type: 'info',\n          recipientName: 'John Doe',\n          action: {\n            text: 'View Details',\n            url: 'http://localhost:3000/details'\n          },\n          details: [\n            { label: 'Patient', value: 'Jane Smith' },\n            { label: 'MRN', value: '123456' },\n            { label: 'Date', value: new Date().toLocaleDateString() }\n          ]\n        };\n\n        let html;\n\n        switch (template) {\n          case 'welcome':\n            html = welcomeEmailHtml(sampleData);\n            break;\n          case 'password-reset':\n            html = passwordResetEmailHtml(sampleData);\n            break;\n          case 'notification':\n          default:\n            html = notificationEmailHtml(sampleData);\n            break;\n        }\n\n        reply.type('text/html');\n        return html;\n      } catch (error) {\n        logger.error('Template preview error:', error);\n        return reply.code(500).send({\n          status: 500,\n          message: 'Failed to generate template preview',\n          error: error.message\n        });\n      }\n    }\n  );\n\n  /**\n   * Get mail configuration status\n   * GET /api/email/config\n   * Admin only\n   */\n  fastify.get(\n    '/config',\n    {\n      preHandler: [authenticate, requireRole(ROLES.ADMIN)]\n    },\n    async (request, reply) => {\n      try {\n        return {\n          status: 200,\n          message: 'Mail configuration retrieved',\n          data: {\n            mailer: process.env.MAIL_MAILER || 'smtp',\n            host: process.env.MAIL_HOST || 'not configured',\n            port: process.env.MAIL_PORT || 587,\n            encryption: process.env.MAIL_ENCRYPTION || 'tls',\n            fromAddress: process.env.MAIL_FROM_ADDRESS || 'not configured',\n            fromName: process.env.MAIL_FROM_NAME || 'not configured',\n            // Don't expose credentials, just show if they're set\n            hasUsername: !!process.env.MAIL_USERNAME,\n            hasPassword: !!process.env.MAIL_PASSWORD\n          }\n        };\n      } catch (error) {\n        logger.error('Config retrieval error:', error);\n        return reply.code(500).send({\n          status: 500,\n          message: 'Failed to retrieve mail configuration',\n          error: error.message\n        });\n      }\n    }\n  );\n}\n\nexport default emailRoutes;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}