{"version":3,"names":["cov_8yvbhvrqw","actualCoverage","pgTable","text","timestamp","index","nanoid","users","passwordHistory","s","id","primaryKey","$defaultFn","f","userId","notNull","references","onDelete","passwordHash","createdAt","defaultNow","table","userIdIdx","on","createdAtIdx"],"sources":["passwordHistory.schema.js"],"sourcesContent":["/**\n * Password History Schema\n *\n * Stores hashed versions of user's previous passwords to prevent reuse.\n * HIPAA compliance requires password history tracking (minimum 6 passwords).\n *\n * SECURITY:\n * - Only stores hashed passwords, never plain text\n * - Used to enforce password reuse prevention\n * - Automatically cleaned up to maintain only required history\n */\n\nimport {\n  pgTable,\n  text,\n  timestamp,\n  index,\n} from 'drizzle-orm/pg-core';\nimport { nanoid } from 'nanoid';\nimport { users } from './user.schema.js';\n\nexport const passwordHistory = pgTable('password_history', {\n  id: text('id')\n    .primaryKey()\n    .$defaultFn(() => nanoid()),\n  userId: text('user_id')\n    .notNull()\n    .references(() => users.id, { onDelete: 'cascade' }),\n  passwordHash: text('password_hash').notNull(),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n}, (table) => ({\n  userIdIdx: index('password_history_user_id_idx').on(table.userId),\n  createdAtIdx: index('password_history_created_at_idx').on(table.createdAt),\n}));\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAeY;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AAfZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SACEE,OAAO,EACPC,IAAI,EACJC,SAAS,EACTC,KAAK,QACA,qBAAqB;AAC5B,SAASC,MAAM,QAAQ,QAAQ;AAC/B,SAASC,KAAK,QAAQ,kBAAkB;AAExC,OAAO,MAAMC,eAAe;AAAA;AAAA,CAAAR,aAAA,GAAAS,CAAA,OAAGP,OAAO,CAAC,kBAAkB,EAAE;EACzDQ,EAAE,EAAEP,IAAI,CAAC,IAAI,CAAC,CACXQ,UAAU,CAAC,CAAC,CACZC,UAAU,CAAC,MAAM;IAAA;IAAAZ,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAS,CAAA;IAAA,OAAAH,MAAM,CAAC,CAAC;EAAD,CAAC,CAAC;EAC7BQ,MAAM,EAAEX,IAAI,CAAC,SAAS,CAAC,CACpBY,OAAO,CAAC,CAAC,CACTC,UAAU,CAAC,MAAM;IAAA;IAAAhB,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAS,CAAA;IAAA,OAAAF,KAAK,CAACG,EAAE;EAAD,CAAC,EAAE;IAAEO,QAAQ,EAAE;EAAU,CAAC,CAAC;EACtDC,YAAY,EAAEf,IAAI,CAAC,eAAe,CAAC,CAACY,OAAO,CAAC,CAAC;EAC7CI,SAAS,EAAEf,SAAS,CAAC,YAAY,CAAC,CAACgB,UAAU,CAAC,CAAC,CAACL,OAAO,CAAC;AAC1D,CAAC,EAAGM,KAAK,IAAM;EAAA;EAAArB,aAAA,GAAAa,CAAA;EAAAb,aAAA,GAAAS,CAAA;EAAA;IACba,SAAS,EAAEjB,KAAK,CAAC,8BAA8B,CAAC,CAACkB,EAAE,CAACF,KAAK,CAACP,MAAM,CAAC;IACjEU,YAAY,EAAEnB,KAAK,CAAC,iCAAiC,CAAC,CAACkB,EAAE,CAACF,KAAK,CAACF,SAAS;EAC3E,CAAC;AAAD,CAAE,CAAC","ignoreList":[]}