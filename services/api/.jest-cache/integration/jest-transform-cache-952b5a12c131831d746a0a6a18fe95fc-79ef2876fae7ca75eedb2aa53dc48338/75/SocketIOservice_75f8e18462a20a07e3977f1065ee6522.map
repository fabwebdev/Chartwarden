{"version":3,"names":["cov_2eu9po4o4q","actualCoverage","Server","auth","db","users","user_has_roles","roles","sessions","chat_messages","chat_participants","user_presence","eq","and","ROLES","ROLE_PERMISSIONS","info","warn","error","debug","nanoid","DOMPurify","connectionState","s","Map","userConnections","metrics","totalConnections","activeConnections","authFailures","totalMessages","reconnections","SocketIOService","constructor","f","io","server","isInitialized","initialize","fastifyServer","options","b","allowedOrigins","corsOrigins","process","env","CORS_ORIGIN","split","map","o","trim","ioConfig","cors","origin","methods","credentials","allowedHeaders","pingInterval","pingTimeout","connectTimeout","transports","allowUpgrades","perMessageDeflate","threshold","path","use","authenticationMiddleware","bind","setupMainNamespace","setupNotificationsNamespace","setupChatNamespace","setupUpdatesNamespace","origins","length","socket","next","cookies","handshake","headers","cookie","sessionToken","extractSessionToken","socketId","id","Error","session","validateSession","userProfile","loadUserProfile","user","sessionId","authenticated","userId","role","err","message","cookieString","reduce","acc","key","valueParts","join","authHeaders","Headers","Object","entries","forEach","value","set","api","getSession","profile","email","firstName","lastName","PATIENT","permissions","dbUser","select","from","where","limit","userRoles","user_id","roleRecords","role_id","name","on","handleConnection","reason","handleDisconnect","handleError","callback","timestamp","Date","now","status","roomName","handleJoinRoom","handleLeaveRoom","data","handleMessage","notificationsNs","of","userRoom","channels","handleNotificationSubscribe","handleNotificationUnsubscribe","notificationIds","handleMarkNotificationsRead","chatNs","conversationId","handleJoinConversation","handleLeaveConversation","handleChatMessage","update","typing_in_room_id","last_active_at","updated_at","to","emit","userName","updatesNs","patientId","handlePatientSubscribe","encounterId","handleEncounterSubscribe","resourceType","resourceId","room","leave","success","connectionInfo","connectedAt","rooms","Set","lastActivity","has","get","add","insert","values","socket_id","is_connected","last_seen_at","user_agent","ip_address","address","onConflictDoUpdate","target","serverTime","toISOString","Math","max","delete","size","duration","getTime","canJoinRoom","type","response","messageId","random","toString","substr","receivedAt","subscribedChannels","Array","isArray","channel","canSubscribeToChannel","push","unsubscribedChannels","count","markedIds","participation","room_id","is_active","content","replyToId","sanitizedContent","sanitize","ALLOWED_TAGS","ALLOWED_ATTR","sender_id","reply_to_id","is_deleted","returning","broadcastMessage","senderName","is_edited","created_at","senderId","includes","ADMIN","startsWith","DOCTOR","NURSE","STAFF","broadcast","event","toRoom","toUser","socketIds","notifyUser","notification","title","notifyRole","emitPatientUpdate","updateType","emitEncounterUpdate","getMetrics","connectedUsers","getUserSockets","isUserConnected","getConnectionInfo","shutdown","sockets","fetchSockets","disconnect","close","clear","socketIOService","socketMetrics"],"sources":["SocketIO.service.js"],"sourcesContent":["/**\n * Socket.IO Service\n *\n * Provides real-time bidirectional communication with Socket.IO integration.\n * Handles connection lifecycle, authentication, rooms, and event broadcasting.\n *\n * Features:\n * - Connection state tracking (socket ID to user session mapping)\n * - Authentication middleware using Better Auth sessions\n * - Namespace/room architecture for channel isolation\n * - Event handlers with acknowledgment support\n * - Heartbeat/timeout configuration\n * - Structured logging for observability\n * - HIPAA-compliant (no PHI in logs)\n *\n * @module SocketIO.service\n */\n\nimport { Server } from \"socket.io\";\nimport auth from \"../config/betterAuth.js\";\nimport { db } from \"../config/db.drizzle.js\";\nimport { users, user_has_roles, roles, sessions, chat_messages, chat_participants, user_presence } from \"../db/schemas/index.js\";\nimport { eq, and } from \"drizzle-orm\";\nimport { ROLES, ROLE_PERMISSIONS } from \"../config/rbac.js\";\nimport { info, warn, error, debug } from \"../utils/logger.js\";\nimport { nanoid } from \"nanoid\";\nimport DOMPurify from \"isomorphic-dompurify\";\n\n// Connection state tracking\nconst connectionState = new Map(); // socketId -> { userId, user, connectedAt, rooms, lastActivity }\nconst userConnections = new Map(); // userId -> Set<socketId>\n\n// Metrics tracking\nlet metrics = {\n  totalConnections: 0,\n  activeConnections: 0,\n  authFailures: 0,\n  totalMessages: 0,\n  reconnections: 0,\n};\n\n/**\n * Socket.IO Service singleton\n */\nclass SocketIOService {\n  constructor() {\n    this.io = null;\n    this.server = null;\n    this.isInitialized = false;\n  }\n\n  /**\n   * Initialize Socket.IO with Fastify server\n   * @param {object} fastifyServer - Fastify's underlying HTTP server\n   * @param {object} options - Configuration options\n   * @returns {Server} Socket.IO server instance\n   */\n  initialize(fastifyServer, options = {}) {\n    if (this.isInitialized) {\n      warn(\"Socket.IO already initialized, returning existing instance\");\n      return this.io;\n    }\n\n    this.server = fastifyServer;\n\n    // Build CORS origins from environment or defaults\n    const allowedOrigins = options.corsOrigins ||\n      (process.env.CORS_ORIGIN\n        ? process.env.CORS_ORIGIN.split(\",\").map(o => o.trim())\n        : [\"http://localhost:3000\", \"http://localhost:3001\"]);\n\n    // Socket.IO configuration\n    const ioConfig = {\n      cors: {\n        origin: allowedOrigins,\n        methods: [\"GET\", \"POST\", \"PUT\", \"DELETE\", \"OPTIONS\"],\n        credentials: true,\n        allowedHeaders: [\"Content-Type\", \"Authorization\", \"X-CSRF-TOKEN\"],\n      },\n      // Connection settings\n      pingInterval: options.pingInterval || 25000, // 25 seconds\n      pingTimeout: options.pingTimeout || 20000,   // 20 seconds\n      connectTimeout: options.connectTimeout || 45000, // 45 seconds\n      // Transport configuration\n      transports: [\"websocket\", \"polling\"],\n      // Allow upgrades from polling to websocket\n      allowUpgrades: true,\n      // Compression\n      perMessageDeflate: {\n        threshold: 1024, // Only compress messages > 1KB\n      },\n      // Path for Socket.IO\n      path: options.path || \"/socket.io\",\n      // Adapter for horizontal scaling (can be configured for Redis)\n      // adapter: options.adapter || undefined,\n    };\n\n    // Create Socket.IO server\n    this.io = new Server(fastifyServer, ioConfig);\n\n    // Apply authentication middleware\n    this.io.use(this.authenticationMiddleware.bind(this));\n\n    // Setup main namespace handlers\n    this.setupMainNamespace();\n\n    // Setup specialized namespaces\n    this.setupNotificationsNamespace();\n    this.setupChatNamespace();\n    this.setupUpdatesNamespace();\n\n    this.isInitialized = true;\n\n    info(\"Socket.IO initialized successfully\", {\n      origins: allowedOrigins.length,\n      pingInterval: ioConfig.pingInterval,\n      pingTimeout: ioConfig.pingTimeout,\n      transports: ioConfig.transports,\n    });\n\n    return this.io;\n  }\n\n  /**\n   * Authentication middleware for Socket.IO connections\n   * Validates Better Auth session from cookies\n   */\n  async authenticationMiddleware(socket, next) {\n    try {\n      // Extract session token from cookies in handshake\n      const cookies = socket.handshake.headers.cookie;\n      const sessionToken = this.extractSessionToken(cookies);\n\n      if (!sessionToken) {\n        debug(\"Socket auth failed: No session token\", { socketId: socket.id });\n        metrics.authFailures++;\n        return next(new Error(\"Authentication required: No session token\"));\n      }\n\n      // Validate session with Better Auth\n      const session = await this.validateSession(sessionToken, socket.handshake.headers);\n\n      if (!session) {\n        debug(\"Socket auth failed: Invalid session\", { socketId: socket.id });\n        metrics.authFailures++;\n        return next(new Error(\"Authentication failed: Invalid or expired session\"));\n      }\n\n      // Load full user profile with role and permissions\n      const userProfile = await this.loadUserProfile(session.user);\n\n      // Attach user data to socket\n      socket.user = userProfile;\n      socket.sessionId = session.session?.id;\n      socket.authenticated = true;\n\n      debug(\"Socket authenticated\", {\n        socketId: socket.id,\n        userId: userProfile.id,\n        role: userProfile.role,\n      });\n\n      next();\n    } catch (err) {\n      error(\"Socket authentication error\", {\n        socketId: socket.id,\n        error: err.message,\n      });\n      metrics.authFailures++;\n      next(new Error(\"Authentication error: \" + err.message));\n    }\n  }\n\n  /**\n   * Extract session token from cookie string\n   */\n  extractSessionToken(cookieString) {\n    if (!cookieString) return null;\n\n    const cookies = cookieString.split(\";\").reduce((acc, cookie) => {\n      const [key, ...valueParts] = cookie.trim().split(\"=\");\n      acc[key] = valueParts.join(\"=\");\n      return acc;\n    }, {});\n\n    return cookies[\"better-auth.session_token\"];\n  }\n\n  /**\n   * Validate session token with Better Auth\n   */\n  async validateSession(sessionToken, headers) {\n    try {\n      // Build headers object for Better Auth\n      const authHeaders = new Headers();\n      Object.entries(headers).forEach(([key, value]) => {\n        if (value) authHeaders.set(key, value);\n      });\n\n      // Create cookies object\n      const cookies = {\n        \"better-auth.session_token\": sessionToken,\n      };\n\n      // Get session from Better Auth\n      const session = await auth.api.getSession({\n        headers: authHeaders,\n        cookies: cookies,\n      });\n\n      return session;\n    } catch (err) {\n      error(\"Session validation error\", { error: err.message });\n      return null;\n    }\n  }\n\n  /**\n   * Load full user profile with role and permissions\n   */\n  async loadUserProfile(user) {\n    const profile = {\n      id: user.id,\n      email: user.email,\n      firstName: null,\n      lastName: null,\n      role: ROLES.PATIENT,\n      permissions: [],\n    };\n\n    try {\n      // Get user details\n      const dbUser = await db\n        .select()\n        .from(users)\n        .where(eq(users.id, user.id))\n        .limit(1);\n\n      if (dbUser.length > 0) {\n        profile.firstName = dbUser[0].firstName;\n        profile.lastName = dbUser[0].lastName;\n        profile.email = dbUser[0].email;\n      }\n\n      // Get user role\n      const userRoles = await db\n        .select()\n        .from(user_has_roles)\n        .where(eq(user_has_roles.user_id, user.id))\n        .limit(1);\n\n      if (userRoles.length > 0) {\n        const roleRecords = await db\n          .select()\n          .from(roles)\n          .where(eq(roles.id, userRoles[0].role_id))\n          .limit(1);\n\n        if (roleRecords.length > 0) {\n          profile.role = roleRecords[0].name;\n        }\n      }\n\n      // Get permissions for role\n      profile.permissions = ROLE_PERMISSIONS[profile.role] || [];\n    } catch (err) {\n      error(\"Error loading user profile for socket\", { error: err.message });\n    }\n\n    return profile;\n  }\n\n  /**\n   * Setup main namespace connection handlers\n   */\n  setupMainNamespace() {\n    this.io.on(\"connection\", (socket) => {\n      this.handleConnection(socket);\n\n      // Event handlers\n      socket.on(\"disconnect\", (reason) => this.handleDisconnect(socket, reason));\n      socket.on(\"error\", (err) => this.handleError(socket, err));\n\n      // Ping/pong for heartbeat\n      socket.on(\"ping\", (callback) => {\n        if (typeof callback === \"function\") {\n          callback({ timestamp: Date.now(), status: \"pong\" });\n        }\n      });\n\n      // Join room\n      socket.on(\"join:room\", (roomName, callback) => {\n        this.handleJoinRoom(socket, roomName, callback);\n      });\n\n      // Leave room\n      socket.on(\"leave:room\", (roomName, callback) => {\n        this.handleLeaveRoom(socket, roomName, callback);\n      });\n\n      // Generic message handler\n      socket.on(\"message\", (data, callback) => {\n        this.handleMessage(socket, data, callback);\n      });\n    });\n  }\n\n  /**\n   * Setup /notifications namespace\n   */\n  setupNotificationsNamespace() {\n    const notificationsNs = this.io.of(\"/notifications\");\n\n    notificationsNs.use(this.authenticationMiddleware.bind(this));\n\n    notificationsNs.on(\"connection\", (socket) => {\n      debug(\"Notifications namespace connection\", {\n        socketId: socket.id,\n        userId: socket.user?.id,\n      });\n\n      // Auto-join user's notification room\n      const userRoom = `user:${socket.user.id}`;\n      socket.join(userRoom);\n\n      // Also join role-based room\n      if (socket.user.role) {\n        socket.join(`role:${socket.user.role}`);\n      }\n\n      socket.on(\"subscribe\", (channels, callback) => {\n        this.handleNotificationSubscribe(socket, channels, callback);\n      });\n\n      socket.on(\"unsubscribe\", (channels, callback) => {\n        this.handleNotificationUnsubscribe(socket, channels, callback);\n      });\n\n      socket.on(\"mark:read\", (notificationIds, callback) => {\n        this.handleMarkNotificationsRead(socket, notificationIds, callback);\n      });\n\n      socket.on(\"disconnect\", () => {\n        debug(\"Notifications namespace disconnect\", {\n          socketId: socket.id,\n          userId: socket.user?.id,\n        });\n      });\n    });\n  }\n\n  /**\n   * Setup /chat namespace\n   */\n  setupChatNamespace() {\n    const chatNs = this.io.of(\"/chat\");\n\n    chatNs.use(this.authenticationMiddleware.bind(this));\n\n    chatNs.on(\"connection\", (socket) => {\n      debug(\"Chat namespace connection\", {\n        socketId: socket.id,\n        userId: socket.user?.id,\n      });\n\n      socket.on(\"join:conversation\", (conversationId, callback) => {\n        this.handleJoinConversation(socket, conversationId, callback);\n      });\n\n      socket.on(\"leave:conversation\", (conversationId, callback) => {\n        this.handleLeaveConversation(socket, conversationId, callback);\n      });\n\n      socket.on(\"send:message\", (data, callback) => {\n        this.handleChatMessage(socket, data, callback);\n      });\n\n      socket.on(\"typing:start\", async (conversationId) => {\n        try {\n          // Update presence to track typing\n          await db\n            .update(user_presence)\n            .set({\n              typing_in_room_id: conversationId,\n              last_active_at: new Date(),\n              updated_at: new Date()\n            })\n            .where(eq(user_presence.user_id, socket.user.id));\n\n          socket.to(`conversation:${conversationId}`).emit(\"user:typing\", {\n            userId: socket.user.id,\n            userName: `${socket.user.firstName || \"\"} ${socket.user.lastName || \"\"}`.trim(),\n            conversationId,\n          });\n        } catch (err) {\n          error(\"Error updating typing status\", { error: err.message });\n        }\n      });\n\n      socket.on(\"typing:stop\", async (conversationId) => {\n        try {\n          // Clear typing status\n          await db\n            .update(user_presence)\n            .set({\n              typing_in_room_id: null,\n              last_active_at: new Date(),\n              updated_at: new Date()\n            })\n            .where(eq(user_presence.user_id, socket.user.id));\n\n          socket.to(`conversation:${conversationId}`).emit(\"user:stopped_typing\", {\n            userId: socket.user.id,\n            conversationId,\n          });\n        } catch (err) {\n          error(\"Error clearing typing status\", { error: err.message });\n        }\n      });\n\n      socket.on(\"disconnect\", () => {\n        debug(\"Chat namespace disconnect\", {\n          socketId: socket.id,\n          userId: socket.user?.id,\n        });\n      });\n    });\n  }\n\n  /**\n   * Setup /updates namespace for live data updates\n   */\n  setupUpdatesNamespace() {\n    const updatesNs = this.io.of(\"/updates\");\n\n    updatesNs.use(this.authenticationMiddleware.bind(this));\n\n    updatesNs.on(\"connection\", (socket) => {\n      debug(\"Updates namespace connection\", {\n        socketId: socket.id,\n        userId: socket.user?.id,\n      });\n\n      // Subscribe to patient updates (requires permission)\n      socket.on(\"subscribe:patient\", (patientId, callback) => {\n        this.handlePatientSubscribe(socket, patientId, callback);\n      });\n\n      // Subscribe to encounter updates\n      socket.on(\"subscribe:encounter\", (encounterId, callback) => {\n        this.handleEncounterSubscribe(socket, encounterId, callback);\n      });\n\n      // Unsubscribe from updates\n      socket.on(\"unsubscribe\", (resourceType, resourceId, callback) => {\n        const room = `${resourceType}:${resourceId}`;\n        socket.leave(room);\n        if (typeof callback === \"function\") {\n          callback({ success: true, room });\n        }\n      });\n\n      socket.on(\"disconnect\", () => {\n        debug(\"Updates namespace disconnect\", {\n          socketId: socket.id,\n          userId: socket.user?.id,\n        });\n      });\n    });\n  }\n\n  /**\n   * Handle new connection\n   */\n  async handleConnection(socket) {\n    metrics.totalConnections++;\n    metrics.activeConnections++;\n\n    const userId = socket.user?.id;\n    const connectionInfo = {\n      userId,\n      user: socket.user,\n      connectedAt: new Date(),\n      rooms: new Set(),\n      lastActivity: new Date(),\n    };\n\n    // Track connection\n    connectionState.set(socket.id, connectionInfo);\n\n    // Track user connections (for targeting specific users)\n    if (userId) {\n      if (!userConnections.has(userId)) {\n        userConnections.set(userId, new Set());\n      }\n      userConnections.get(userId).add(socket.id);\n\n      // Update or create user presence\n      try {\n        await db\n          .insert(user_presence)\n          .values({\n            id: nanoid(),\n            user_id: userId,\n            status: 'online',\n            socket_id: socket.id,\n            is_connected: true,\n            last_seen_at: new Date(),\n            last_active_at: new Date(),\n            user_agent: socket.handshake.headers['user-agent'] || null,\n            ip_address: socket.handshake.address || null\n          })\n          .onConflictDoUpdate({\n            target: user_presence.user_id,\n            set: {\n              status: 'online',\n              socket_id: socket.id,\n              is_connected: true,\n              last_seen_at: new Date(),\n              last_active_at: new Date(),\n              user_agent: socket.handshake.headers['user-agent'] || null,\n              ip_address: socket.handshake.address || null,\n              updated_at: new Date()\n            }\n          });\n      } catch (err) {\n        error(\"Error updating user presence on connection\", { error: err.message, userId });\n      }\n    }\n\n    info(\"Socket connected\", {\n      socketId: socket.id,\n      userId,\n      role: socket.user?.role,\n      activeConnections: metrics.activeConnections,\n    });\n\n    // Send welcome event\n    socket.emit(\"connected\", {\n      socketId: socket.id,\n      userId,\n      timestamp: Date.now(),\n      serverTime: new Date().toISOString(),\n    });\n  }\n\n  /**\n   * Handle disconnection\n   */\n  async handleDisconnect(socket, reason) {\n    metrics.activeConnections = Math.max(0, metrics.activeConnections - 1);\n\n    const connectionInfo = connectionState.get(socket.id);\n    const userId = connectionInfo?.userId;\n\n    // Clean up connection state\n    connectionState.delete(socket.id);\n\n    // Clean up user connections and update presence\n    if (userId && userConnections.has(userId)) {\n      userConnections.get(userId).delete(socket.id);\n\n      // If user has no more active connections, mark as offline\n      if (userConnections.get(userId).size === 0) {\n        userConnections.delete(userId);\n\n        try {\n          await db\n            .update(user_presence)\n            .set({\n              status: 'offline',\n              is_connected: false,\n              socket_id: null,\n              typing_in_room_id: null,\n              last_seen_at: new Date(),\n              updated_at: new Date()\n            })\n            .where(eq(user_presence.user_id, userId));\n        } catch (err) {\n          error(\"Error updating user presence on disconnect\", { error: err.message, userId });\n        }\n      }\n    }\n\n    info(\"Socket disconnected\", {\n      socketId: socket.id,\n      userId,\n      reason,\n      duration: connectionInfo ? Date.now() - connectionInfo.connectedAt.getTime() : 0,\n      activeConnections: metrics.activeConnections,\n    });\n  }\n\n  /**\n   * Handle socket errors\n   */\n  handleError(socket, err) {\n    error(\"Socket error\", {\n      socketId: socket.id,\n      userId: socket.user?.id,\n      error: err.message,\n    });\n  }\n\n  /**\n   * Handle room join\n   */\n  handleJoinRoom(socket, roomName, callback) {\n    try {\n      // Validate room name\n      if (!roomName || typeof roomName !== \"string\") {\n        throw new Error(\"Invalid room name\");\n      }\n\n      // Check authorization for room (basic check - extend as needed)\n      if (!this.canJoinRoom(socket.user, roomName)) {\n        throw new Error(\"Not authorized to join this room\");\n      }\n\n      socket.join(roomName);\n\n      // Track room membership\n      const connectionInfo = connectionState.get(socket.id);\n      if (connectionInfo) {\n        connectionInfo.rooms.add(roomName);\n        connectionInfo.lastActivity = new Date();\n      }\n\n      debug(\"Socket joined room\", {\n        socketId: socket.id,\n        userId: socket.user?.id,\n        room: roomName,\n      });\n\n      if (typeof callback === \"function\") {\n        callback({ success: true, room: roomName });\n      }\n    } catch (err) {\n      error(\"Error joining room\", {\n        socketId: socket.id,\n        room: roomName,\n        error: err.message,\n      });\n\n      if (typeof callback === \"function\") {\n        callback({ success: false, error: err.message });\n      }\n    }\n  }\n\n  /**\n   * Handle room leave\n   */\n  handleLeaveRoom(socket, roomName, callback) {\n    try {\n      socket.leave(roomName);\n\n      // Track room membership\n      const connectionInfo = connectionState.get(socket.id);\n      if (connectionInfo) {\n        connectionInfo.rooms.delete(roomName);\n        connectionInfo.lastActivity = new Date();\n      }\n\n      debug(\"Socket left room\", {\n        socketId: socket.id,\n        userId: socket.user?.id,\n        room: roomName,\n      });\n\n      if (typeof callback === \"function\") {\n        callback({ success: true, room: roomName });\n      }\n    } catch (err) {\n      error(\"Error leaving room\", {\n        socketId: socket.id,\n        room: roomName,\n        error: err.message,\n      });\n\n      if (typeof callback === \"function\") {\n        callback({ success: false, error: err.message });\n      }\n    }\n  }\n\n  /**\n   * Handle generic message\n   */\n  handleMessage(socket, data, callback) {\n    metrics.totalMessages++;\n\n    const connectionInfo = connectionState.get(socket.id);\n    if (connectionInfo) {\n      connectionInfo.lastActivity = new Date();\n    }\n\n    debug(\"Message received\", {\n      socketId: socket.id,\n      userId: socket.user?.id,\n      type: data?.type,\n    });\n\n    // Validate message data\n    if (!data || typeof data !== \"object\") {\n      if (typeof callback === \"function\") {\n        callback({ success: false, error: \"Invalid message format\" });\n      }\n      return;\n    }\n\n    // Process message based on type\n    const response = {\n      success: true,\n      messageId: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      receivedAt: Date.now(),\n    };\n\n    if (typeof callback === \"function\") {\n      callback(response);\n    }\n  }\n\n  /**\n   * Handle notification subscription\n   */\n  handleNotificationSubscribe(socket, channels, callback) {\n    try {\n      const subscribedChannels = [];\n\n      if (Array.isArray(channels)) {\n        channels.forEach((channel) => {\n          if (this.canSubscribeToChannel(socket.user, channel)) {\n            socket.join(`notification:${channel}`);\n            subscribedChannels.push(channel);\n          }\n        });\n      } else if (typeof channels === \"string\") {\n        if (this.canSubscribeToChannel(socket.user, channels)) {\n          socket.join(`notification:${channels}`);\n          subscribedChannels.push(channels);\n        }\n      }\n\n      debug(\"Notification subscription\", {\n        socketId: socket.id,\n        userId: socket.user?.id,\n        channels: subscribedChannels,\n      });\n\n      if (typeof callback === \"function\") {\n        callback({ success: true, subscribedChannels });\n      }\n    } catch (err) {\n      if (typeof callback === \"function\") {\n        callback({ success: false, error: err.message });\n      }\n    }\n  }\n\n  /**\n   * Handle notification unsubscription\n   */\n  handleNotificationUnsubscribe(socket, channels, callback) {\n    try {\n      const unsubscribedChannels = [];\n\n      if (Array.isArray(channels)) {\n        channels.forEach((channel) => {\n          socket.leave(`notification:${channel}`);\n          unsubscribedChannels.push(channel);\n        });\n      } else if (typeof channels === \"string\") {\n        socket.leave(`notification:${channels}`);\n        unsubscribedChannels.push(channels);\n      }\n\n      if (typeof callback === \"function\") {\n        callback({ success: true, unsubscribedChannels });\n      }\n    } catch (err) {\n      if (typeof callback === \"function\") {\n        callback({ success: false, error: err.message });\n      }\n    }\n  }\n\n  /**\n   * Handle mark notifications as read\n   */\n  handleMarkNotificationsRead(socket, notificationIds, callback) {\n    // This would typically interact with a notification service\n    debug(\"Mark notifications read\", {\n      socketId: socket.id,\n      userId: socket.user?.id,\n      count: Array.isArray(notificationIds) ? notificationIds.length : 1,\n    });\n\n    if (typeof callback === \"function\") {\n      callback({ success: true, markedIds: notificationIds });\n    }\n  }\n\n  /**\n   * Handle joining a chat conversation\n   */\n  async handleJoinConversation(socket, conversationId, callback) {\n    try {\n      // Validate user has access to this conversation\n      const participation = await db\n        .select()\n        .from(chat_participants)\n        .where(\n          and(\n            eq(chat_participants.room_id, conversationId),\n            eq(chat_participants.user_id, socket.user.id),\n            eq(chat_participants.is_active, true)\n          )\n        )\n        .limit(1);\n\n      if (participation.length === 0) {\n        throw new Error(\"Not authorized to access this conversation\");\n      }\n\n      const room = `conversation:${conversationId}`;\n      socket.join(room);\n\n      // Update user presence to indicate they're in this room\n      await db\n        .update(user_presence)\n        .set({\n          typing_in_room_id: null,\n          last_active_at: new Date(),\n          updated_at: new Date()\n        })\n        .where(eq(user_presence.user_id, socket.user.id));\n\n      debug(\"Joined conversation\", {\n        socketId: socket.id,\n        userId: socket.user?.id,\n        conversationId,\n      });\n\n      // Notify others in the conversation\n      socket.to(room).emit(\"user:joined\", {\n        userId: socket.user.id,\n        userName: `${socket.user.firstName || \"\"} ${socket.user.lastName || \"\"}`.trim(),\n        timestamp: Date.now(),\n      });\n\n      if (typeof callback === \"function\") {\n        callback({ success: true, conversationId });\n      }\n    } catch (err) {\n      error(\"Error joining conversation\", { error: err.message, conversationId });\n      if (typeof callback === \"function\") {\n        callback({ success: false, error: err.message });\n      }\n    }\n  }\n\n  /**\n   * Handle leaving a chat conversation\n   */\n  handleLeaveConversation(socket, conversationId, callback) {\n    try {\n      const room = `conversation:${conversationId}`;\n      socket.leave(room);\n\n      // Notify others in the conversation\n      socket.to(room).emit(\"user:left\", {\n        userId: socket.user.id,\n        timestamp: Date.now(),\n      });\n\n      if (typeof callback === \"function\") {\n        callback({ success: true, conversationId });\n      }\n    } catch (err) {\n      if (typeof callback === \"function\") {\n        callback({ success: false, error: err.message });\n      }\n    }\n  }\n\n  /**\n   * Handle chat message with database persistence\n   */\n  async handleChatMessage(socket, data, callback) {\n    try {\n      const { conversationId, content, replyToId } = data;\n\n      if (!conversationId || !content) {\n        throw new Error(\"Missing required fields: conversationId and content\");\n      }\n\n      // Validate user is participant\n      const participation = await db\n        .select()\n        .from(chat_participants)\n        .where(\n          and(\n            eq(chat_participants.room_id, conversationId),\n            eq(chat_participants.user_id, socket.user.id),\n            eq(chat_participants.is_active, true)\n          )\n        )\n        .limit(1);\n\n      if (participation.length === 0) {\n        throw new Error(\"Not authorized to send messages to this room\");\n      }\n\n      // Sanitize content to prevent XSS\n      const sanitizedContent = DOMPurify.sanitize(content, {\n        ALLOWED_TAGS: [],\n        ALLOWED_ATTR: []\n      });\n\n      // Persist message to database\n      const [message] = await db\n        .insert(chat_messages)\n        .values({\n          id: nanoid(),\n          room_id: conversationId,\n          sender_id: socket.user.id,\n          content: sanitizedContent,\n          reply_to_id: replyToId || null,\n          is_deleted: false\n        })\n        .returning();\n\n      // Format message for broadcast\n      const broadcastMessage = {\n        id: message.id,\n        room_id: message.room_id,\n        sender_id: message.sender_id,\n        senderName: `${socket.user.firstName || \"\"} ${socket.user.lastName || \"\"}`.trim(),\n        content: message.content,\n        reply_to_id: message.reply_to_id,\n        is_edited: message.is_edited,\n        is_deleted: message.is_deleted,\n        created_at: message.created_at,\n        updated_at: message.updated_at\n      };\n\n      // Broadcast to conversation room (including sender)\n      this.io.of(\"/chat\").to(`conversation:${conversationId}`).emit(\"new:message\", broadcastMessage);\n\n      // Clear typing indicator for sender\n      await db\n        .update(user_presence)\n        .set({\n          typing_in_room_id: null,\n          last_active_at: new Date(),\n          updated_at: new Date()\n        })\n        .where(eq(user_presence.user_id, socket.user.id));\n\n      // Notify typing stopped\n      socket.to(`conversation:${conversationId}`).emit(\"user:stopped_typing\", {\n        userId: socket.user.id,\n        conversationId,\n      });\n\n      debug(\"Chat message persisted and sent\", {\n        messageId: message.id,\n        conversationId,\n        senderId: socket.user.id,\n      });\n\n      if (typeof callback === \"function\") {\n        callback({ success: true, message: broadcastMessage });\n      }\n    } catch (err) {\n      error(\"Error handling chat message\", { error: err.message, conversationId: data.conversationId });\n      if (typeof callback === \"function\") {\n        callback({ success: false, error: err.message });\n      }\n    }\n  }\n\n  /**\n   * Handle patient subscription\n   */\n  handlePatientSubscribe(socket, patientId, callback) {\n    try {\n      // Check permission\n      if (!socket.user.permissions.includes(\"view:patient\")) {\n        throw new Error(\"Not authorized to subscribe to patient updates\");\n      }\n\n      const room = `patient:${patientId}`;\n      socket.join(room);\n\n      debug(\"Subscribed to patient updates\", {\n        socketId: socket.id,\n        userId: socket.user?.id,\n        patientId,\n      });\n\n      if (typeof callback === \"function\") {\n        callback({ success: true, patientId });\n      }\n    } catch (err) {\n      if (typeof callback === \"function\") {\n        callback({ success: false, error: err.message });\n      }\n    }\n  }\n\n  /**\n   * Handle encounter subscription\n   */\n  handleEncounterSubscribe(socket, encounterId, callback) {\n    try {\n      // Check permission\n      if (!socket.user.permissions.includes(\"view:clinical_notes\")) {\n        throw new Error(\"Not authorized to subscribe to encounter updates\");\n      }\n\n      const room = `encounter:${encounterId}`;\n      socket.join(room);\n\n      debug(\"Subscribed to encounter updates\", {\n        socketId: socket.id,\n        userId: socket.user?.id,\n        encounterId,\n      });\n\n      if (typeof callback === \"function\") {\n        callback({ success: true, encounterId });\n      }\n    } catch (err) {\n      if (typeof callback === \"function\") {\n        callback({ success: false, error: err.message });\n      }\n    }\n  }\n\n  /**\n   * Check if user can join a room\n   */\n  canJoinRoom(user, roomName) {\n    if (!user || !roomName) return false;\n\n    // Admin can join any room\n    if (user.role === ROLES.ADMIN) return true;\n\n    // User can join their own user room\n    if (roomName === `user:${user.id}`) return true;\n\n    // User can join their role room\n    if (roomName === `role:${user.role}`) return true;\n\n    // Additional room authorization logic can be added here\n    // For patient/encounter rooms, check permissions\n    if (roomName.startsWith(\"patient:\")) {\n      return user.permissions.includes(\"view:patient\");\n    }\n\n    if (roomName.startsWith(\"encounter:\")) {\n      return user.permissions.includes(\"view:clinical_notes\");\n    }\n\n    return true; // Default allow for general rooms\n  }\n\n  /**\n   * Check if user can subscribe to a notification channel\n   */\n  canSubscribeToChannel(user, channel) {\n    if (!user || !channel) return false;\n\n    // Admin can subscribe to any channel\n    if (user.role === ROLES.ADMIN) return true;\n\n    // Channel-specific authorization\n    switch (channel) {\n      case \"system\":\n        return true; // All users can receive system notifications\n      case \"admin\":\n        return user.role === ROLES.ADMIN;\n      case \"clinical\":\n        return [ROLES.ADMIN, ROLES.DOCTOR, ROLES.NURSE].includes(user.role);\n      case \"billing\":\n        return [ROLES.ADMIN, ROLES.STAFF].includes(user.role);\n      default:\n        return true;\n    }\n  }\n\n  // ============= PUBLIC API FOR BROADCASTING =============\n\n  /**\n   * Emit event to all connected clients\n   * @param {string} event - Event name\n   * @param {*} data - Event data\n   */\n  broadcast(event, data) {\n    if (!this.io) {\n      warn(\"Socket.IO not initialized, cannot broadcast\");\n      return;\n    }\n    this.io.emit(event, data);\n  }\n\n  /**\n   * Emit event to a specific room\n   * @param {string} room - Room name\n   * @param {string} event - Event name\n   * @param {*} data - Event data\n   */\n  toRoom(room, event, data) {\n    if (!this.io) {\n      warn(\"Socket.IO not initialized, cannot emit to room\");\n      return;\n    }\n    this.io.to(room).emit(event, data);\n  }\n\n  /**\n   * Emit event to a specific user (all their connections)\n   * @param {string} userId - User ID\n   * @param {string} event - Event name\n   * @param {*} data - Event data\n   */\n  toUser(userId, event, data) {\n    if (!this.io) {\n      warn(\"Socket.IO not initialized, cannot emit to user\");\n      return;\n    }\n\n    const socketIds = userConnections.get(userId);\n    if (socketIds) {\n      socketIds.forEach((socketId) => {\n        this.io.to(socketId).emit(event, data);\n      });\n    }\n  }\n\n  /**\n   * Emit notification to a user\n   * @param {string} userId - User ID\n   * @param {object} notification - Notification object\n   */\n  notifyUser(userId, notification) {\n    const event = \"notification\";\n    const data = {\n      id: notification.id || `notif_${Date.now()}`,\n      type: notification.type || \"info\",\n      title: notification.title,\n      message: notification.message,\n      data: notification.data,\n      timestamp: Date.now(),\n    };\n\n    // Send via /notifications namespace\n    if (this.io) {\n      this.io.of(\"/notifications\").to(`user:${userId}`).emit(event, data);\n    }\n  }\n\n  /**\n   * Broadcast notification to a role\n   * @param {string} role - Role name\n   * @param {object} notification - Notification object\n   */\n  notifyRole(role, notification) {\n    const event = \"notification\";\n    const data = {\n      id: notification.id || `notif_${Date.now()}`,\n      type: notification.type || \"info\",\n      title: notification.title,\n      message: notification.message,\n      data: notification.data,\n      timestamp: Date.now(),\n    };\n\n    if (this.io) {\n      this.io.of(\"/notifications\").to(`role:${role}`).emit(event, data);\n    }\n  }\n\n  /**\n   * Emit patient update event\n   * @param {string} patientId - Patient ID\n   * @param {string} updateType - Type of update (e.g., 'vitals', 'medications', 'notes')\n   * @param {object} data - Update data\n   */\n  emitPatientUpdate(patientId, updateType, data) {\n    if (this.io) {\n      this.io.of(\"/updates\").to(`patient:${patientId}`).emit(\"patient:update\", {\n        patientId,\n        updateType,\n        data,\n        timestamp: Date.now(),\n      });\n    }\n  }\n\n  /**\n   * Emit encounter update event\n   * @param {string} encounterId - Encounter ID\n   * @param {string} updateType - Type of update\n   * @param {object} data - Update data\n   */\n  emitEncounterUpdate(encounterId, updateType, data) {\n    if (this.io) {\n      this.io.of(\"/updates\").to(`encounter:${encounterId}`).emit(\"encounter:update\", {\n        encounterId,\n        updateType,\n        data,\n        timestamp: Date.now(),\n      });\n    }\n  }\n\n  // ============= METRICS & MONITORING =============\n\n  /**\n   * Get current connection metrics\n   * @returns {object} Metrics object\n   */\n  getMetrics() {\n    return {\n      ...metrics,\n      connectedUsers: userConnections.size,\n      timestamp: Date.now(),\n    };\n  }\n\n  /**\n   * Get all connected socket IDs for a user\n   * @param {string} userId - User ID\n   * @returns {string[]} Array of socket IDs\n   */\n  getUserSockets(userId) {\n    const socketIds = userConnections.get(userId);\n    return socketIds ? Array.from(socketIds) : [];\n  }\n\n  /**\n   * Check if a user is currently connected\n   * @param {string} userId - User ID\n   * @returns {boolean} True if user has at least one connection\n   */\n  isUserConnected(userId) {\n    return userConnections.has(userId) && userConnections.get(userId).size > 0;\n  }\n\n  /**\n   * Get connection info for a socket\n   * @param {string} socketId - Socket ID\n   * @returns {object|null} Connection info\n   */\n  getConnectionInfo(socketId) {\n    return connectionState.get(socketId) || null;\n  }\n\n  /**\n   * Graceful shutdown\n   */\n  async shutdown() {\n    if (!this.io) return;\n\n    info(\"Shutting down Socket.IO...\", {\n      activeConnections: metrics.activeConnections,\n    });\n\n    // Notify all clients\n    this.broadcast(\"server:shutdown\", {\n      message: \"Server is shutting down\",\n      timestamp: Date.now(),\n    });\n\n    // Close all connections\n    const sockets = await this.io.fetchSockets();\n    for (const socket of sockets) {\n      socket.disconnect(true);\n    }\n\n    // Close the server\n    this.io.close();\n    this.io = null;\n    this.isInitialized = false;\n\n    // Clear state\n    connectionState.clear();\n    userConnections.clear();\n\n    info(\"Socket.IO shutdown complete\");\n  }\n}\n\n// Export singleton instance\nconst socketIOService = new SocketIOService();\nexport default socketIOService;\n\n// Export metrics for monitoring\nexport { metrics as socketMetrics };\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}