{"version":3,"names":["cov_j6gi8221m","actualCoverage","DataExportService","db","patients","encounters","medications","vital_signs","vitalSigns","claims","staff_profiles","staff","eq","and","gte","lte","desc","sql","logger","DataExportController","rateLimitMap","s","Map","RATE_LIMIT_WINDOW_MS","RATE_LIMIT_MAX_REQUESTS","resourceConfigs","name","description","schema","defaultColumns","availableColumns","dateField","permission","getFormats","request","reply","f","formats","getSupportedFormats","status","data","error","code","message","b","getResourceTypes","resourceTypes","Object","entries","map","key","config","id","estimateExportSize","resourceType","format","columns","startDate","endDate","body","keys","join","query","select","count","from","conditions","push","Date","length","where","result","totalCount","parseInt","sampleQuery","limit","sampleData","selectedColumns","estimation","scaleFactor","estimatedSizeBytes","Math","ceil","estimatedSizeFormatted","_formatBytes","rowCount","columnCount","warning","exportData","filename","options","userId","user","_checkRateLimit","retryAfter","validFormats","includes","orderBy","MAX_EXPORT_ROWS","isEmpty","exportOptions","title","subtitle","_buildSubtitle","exportResult","header","mimeType","buffer","exportId","sizeFormatted","send","getExportHistory","history","clearExportHistory","now","windowStart","userRequests","get","filter","timestamp","set","toLocaleDateString","bytes","sizes","i","floor","log","pow","toFixed"],"sources":["DataExport.controller.js"],"sourcesContent":["import DataExportService from '../services/DataExportService.js';\nimport { db } from '../config/db.drizzle.js';\nimport { patients } from '../db/schemas/patient.schema.js';\nimport { encounters } from '../db/schemas/encounters.schema.js';\nimport { medications } from '../db/schemas/medications.schema.js';\nimport { vital_signs as vitalSigns } from '../db/schemas/vitalSign.schema.js';\nimport { claims } from '../db/schemas/billing.schema.js';\nimport { staff_profiles as staff } from '../db/schemas/staffManagement.schema.js';\nimport { eq, and, gte, lte, desc, sql } from 'drizzle-orm';\nimport { logger } from '../utils/logger.js';\n\n/**\n * Data Export Controller\n * Handles data export requests with multi-format support\n *\n * Features:\n * - Multi-format export (CSV, JSON, XML, Excel)\n * - Date range filtering\n * - Column selection\n * - Export size estimation\n * - Export history tracking\n * - Rate limiting support\n *\n * Endpoints:\n * - GET /api/data-export/formats - Get supported export formats\n * - POST /api/data-export/estimate - Estimate export size\n * - POST /api/data-export - Execute data export\n * - GET /api/data-export/history - Get export history\n * - DELETE /api/data-export/history - Clear export history\n * - GET /api/data-export/resource-types - Get exportable resource types\n */\nclass DataExportController {\n    // Rate limiting tracking (in-memory, should use Redis in production)\n    rateLimitMap = new Map();\n    RATE_LIMIT_WINDOW_MS = 60000; // 1 minute\n    RATE_LIMIT_MAX_REQUESTS = 10; // Max exports per minute\n\n    // Exportable resource configurations\n    resourceConfigs = {\n        patients: {\n            name: 'Patients',\n            description: 'Patient demographic information',\n            schema: patients,\n            defaultColumns: ['id', 'first_name', 'last_name', 'date_of_birth', 'gender', 'status', 'created_at'],\n            availableColumns: [\n                'id', 'first_name', 'last_name', 'date_of_birth', 'gender', 'email',\n                'phone', 'status', 'mrn', 'ssn_last_four', 'created_at', 'updated_at'\n            ],\n            dateField: 'created_at',\n            permission: 'view:patient'\n        },\n        encounters: {\n            name: 'Encounters',\n            description: 'Patient encounter/visit records',\n            schema: encounters,\n            defaultColumns: ['id', 'patient_id', 'encounter_type', 'encounter_date', 'status', 'created_at'],\n            availableColumns: [\n                'id', 'patient_id', 'encounter_type', 'encounter_date', 'start_time',\n                'end_time', 'location', 'status', 'notes', 'created_at', 'updated_at'\n            ],\n            dateField: 'encounter_date',\n            permission: 'view:clinical_notes'\n        },\n        medications: {\n            name: 'Medications',\n            description: 'Medication records and prescriptions',\n            schema: medications,\n            defaultColumns: ['id', 'patient_id', 'medication_name', 'dosage', 'frequency', 'status', 'start_date'],\n            availableColumns: [\n                'id', 'patient_id', 'medication_name', 'generic_name', 'dosage', 'dosage_unit',\n                'frequency', 'route', 'start_date', 'end_date', 'status', 'prescriber',\n                'instructions', 'created_at', 'updated_at'\n            ],\n            dateField: 'start_date',\n            permission: 'view:medications'\n        },\n        vital_signs: {\n            name: 'Vital Signs',\n            description: 'Patient vital sign measurements',\n            schema: vitalSigns,\n            defaultColumns: ['id', 'patient_id', 'measurement_timestamp', 'bp_systolic', 'bp_diastolic', 'heart_rate', 'degrees_fahrenheit'],\n            availableColumns: [\n                'id', 'patient_id', 'measurement_timestamp', 'bp_systolic', 'bp_diastolic',\n                'heart_rate', 'respiratory_rate', 'degrees_fahrenheit', 'pulse_oximetry_percentage', 'body_weight_lbs', 'body_height_inches',\n                'pain_score', 'general_notes', 'createdAt', 'updatedAt'\n            ],\n            dateField: 'measurement_timestamp',\n            permission: 'view:vital_signs'\n        },\n        claims: {\n            name: 'Claims',\n            description: 'Billing claims data',\n            schema: claims,\n            defaultColumns: ['id', 'patient_id', 'claim_number', 'claim_status', 'total_charges', 'service_start_date'],\n            availableColumns: [\n                'id', 'patient_id', 'claim_number', 'claim_type', 'claim_status', 'total_charges',\n                'amount_paid', 'amount_due', 'service_start_date', 'service_end_date',\n                'submitted_date', 'payer_id', 'created_at', 'updated_at'\n            ],\n            dateField: 'service_start_date',\n            permission: 'view:reports'\n        },\n        staff: {\n            name: 'Staff',\n            description: 'Staff member information',\n            schema: staff,\n            defaultColumns: ['id', 'first_name', 'last_name', 'job_title', 'email', 'employment_status', 'hire_date'],\n            availableColumns: [\n                'id', 'employee_id', 'first_name', 'last_name', 'job_title', 'email', 'phone', 'employment_status',\n                'hire_date', 'department', 'employment_type', 'created_at', 'updated_at'\n            ],\n            dateField: 'hire_date',\n            permission: 'manage:users'\n        }\n    };\n\n    /**\n     * Get supported export formats\n     * GET /api/data-export/formats\n     */\n    async getFormats(request, reply) {\n        try {\n            const formats = DataExportService.getSupportedFormats();\n\n            return {\n                status: 'success',\n                data: formats\n            };\n        } catch (error) {\n            logger.error('Error getting export formats:', error);\n            reply.code(500);\n            return {\n                status: 'error',\n                message: error.message || 'Failed to get export formats'\n            };\n        }\n    }\n\n    /**\n     * Get exportable resource types\n     * GET /api/data-export/resource-types\n     */\n    async getResourceTypes(request, reply) {\n        try {\n            const resourceTypes = Object.entries(this.resourceConfigs).map(([key, config]) => ({\n                id: key,\n                name: config.name,\n                description: config.description,\n                availableColumns: config.availableColumns,\n                defaultColumns: config.defaultColumns,\n                dateField: config.dateField\n            }));\n\n            return {\n                status: 'success',\n                data: resourceTypes\n            };\n        } catch (error) {\n            logger.error('Error getting resource types:', error);\n            reply.code(500);\n            return {\n                status: 'error',\n                message: error.message || 'Failed to get resource types'\n            };\n        }\n    }\n\n    /**\n     * Estimate export size\n     * POST /api/data-export/estimate\n     *\n     * Body: {\n     *   resourceType: \"patients\",\n     *   format: \"csv\",\n     *   columns: [\"id\", \"first_name\", \"last_name\"], // optional\n     *   startDate: \"2024-01-01\", // optional\n     *   endDate: \"2024-12-31\" // optional\n     * }\n     */\n    async estimateExportSize(request, reply) {\n        try {\n            const { resourceType, format, columns, startDate, endDate } = request.body;\n\n            // Validate resource type\n            if (!this.resourceConfigs[resourceType]) {\n                reply.code(400);\n                return {\n                    status: 'error',\n                    message: `Invalid resource type: ${resourceType}. Available types: ${Object.keys(this.resourceConfigs).join(', ')}`\n                };\n            }\n\n            const config = this.resourceConfigs[resourceType];\n\n            // Build query to count records\n            let query = db.select({ count: sql`count(*)` }).from(config.schema);\n\n            // Apply date filters\n            const conditions = [];\n            if (startDate && config.dateField) {\n                conditions.push(gte(config.schema[config.dateField], new Date(startDate)));\n            }\n            if (endDate && config.dateField) {\n                conditions.push(lte(config.schema[config.dateField], new Date(endDate)));\n            }\n\n            if (conditions.length > 0) {\n                query = query.where(and(...conditions));\n            }\n\n            const result = await query;\n            const totalCount = parseInt(result[0].count);\n\n            // Get sample data for size estimation\n            let sampleQuery = db.select().from(config.schema).limit(100);\n            if (conditions.length > 0) {\n                sampleQuery = sampleQuery.where(and(...conditions));\n            }\n            const sampleData = await sampleQuery;\n\n            // Estimate size\n            const selectedColumns = columns && columns.length > 0 ? columns : config.defaultColumns;\n            const estimation = DataExportService.estimateExportSize(\n                sampleData.length > 0 ? sampleData : [{}],\n                format,\n                selectedColumns\n            );\n\n            // Scale up estimation based on actual count\n            if (sampleData.length > 0) {\n                const scaleFactor = totalCount / sampleData.length;\n                estimation.estimatedSizeBytes = Math.ceil(estimation.estimatedSizeBytes * scaleFactor);\n                estimation.estimatedSizeFormatted = this._formatBytes(estimation.estimatedSizeBytes);\n            }\n\n            estimation.rowCount = totalCount;\n            estimation.columnCount = selectedColumns.length;\n\n            // Add warnings\n            if (totalCount > 100000) {\n                estimation.warning = 'Large dataset: Consider filtering by date range or using pagination for better performance.';\n            } else if (estimation.estimatedSizeBytes > 50 * 1024 * 1024) {\n                estimation.warning = 'Large export: This may take a while to download.';\n            }\n\n            return {\n                status: 'success',\n                data: estimation\n            };\n        } catch (error) {\n            logger.error('Error estimating export size:', error);\n            reply.code(500);\n            return {\n                status: 'error',\n                message: error.message || 'Failed to estimate export size'\n            };\n        }\n    }\n\n    /**\n     * Execute data export\n     * POST /api/data-export\n     *\n     * Body: {\n     *   resourceType: \"patients\",\n     *   format: \"csv\" | \"json\" | \"xml\" | \"excel\",\n     *   columns: [\"id\", \"first_name\", \"last_name\"], // optional\n     *   startDate: \"2024-01-01\", // optional\n     *   endDate: \"2024-12-31\", // optional\n     *   filename: \"my-export\", // optional custom filename\n     *   options: { // optional format-specific options\n     *     pretty: true, // for JSON/XML\n     *     delimiter: \",\" // for CSV\n     *   }\n     * }\n     */\n    async exportData(request, reply) {\n        try {\n            const {\n                resourceType,\n                format,\n                columns,\n                startDate,\n                endDate,\n                filename,\n                options = {}\n            } = request.body;\n\n            // Rate limiting check\n            const userId = request.user?.id || 'anonymous';\n            if (!this._checkRateLimit(userId)) {\n                reply.code(429);\n                return {\n                    status: 'error',\n                    message: 'Rate limit exceeded. Please wait before making another export request.',\n                    retryAfter: 60\n                };\n            }\n\n            // Validate resource type\n            if (!this.resourceConfigs[resourceType]) {\n                reply.code(400);\n                return {\n                    status: 'error',\n                    message: `Invalid resource type: ${resourceType}. Available types: ${Object.keys(this.resourceConfigs).join(', ')}`\n                };\n            }\n\n            // Validate format\n            const validFormats = ['csv', 'json', 'xml', 'excel'];\n            if (!validFormats.includes(format)) {\n                reply.code(400);\n                return {\n                    status: 'error',\n                    message: `Invalid format: ${format}. Supported formats: ${validFormats.join(', ')}`\n                };\n            }\n\n            const config = this.resourceConfigs[resourceType];\n\n            // Build query\n            let query = db.select().from(config.schema);\n\n            // Apply date filters\n            const conditions = [];\n            if (startDate && config.dateField) {\n                conditions.push(gte(config.schema[config.dateField], new Date(startDate)));\n            }\n            if (endDate && config.dateField) {\n                conditions.push(lte(config.schema[config.dateField], new Date(endDate)));\n            }\n\n            if (conditions.length > 0) {\n                query = query.where(and(...conditions));\n            }\n\n            // Order by date field descending\n            if (config.dateField && config.schema[config.dateField]) {\n                query = query.orderBy(desc(config.schema[config.dateField]));\n            }\n\n            // Execute query with limit for safety\n            const MAX_EXPORT_ROWS = 50000;\n            query = query.limit(MAX_EXPORT_ROWS);\n\n            const data = await query;\n\n            // Check for empty result\n            if (data.length === 0) {\n                reply.code(200);\n                return {\n                    status: 'success',\n                    message: 'No records match the specified criteria',\n                    data: {\n                        isEmpty: true,\n                        rowCount: 0\n                    }\n                };\n            }\n\n            // Prepare export options\n            const selectedColumns = columns && columns.length > 0 ? columns : config.defaultColumns;\n            const exportOptions = {\n                ...options,\n                columns: selectedColumns,\n                resourceType,\n                userId,\n                filename: filename || resourceType,\n                title: `${config.name} Export`,\n                subtitle: this._buildSubtitle(startDate, endDate)\n            };\n\n            // Execute export\n            const exportResult = await DataExportService.exportData(data, format, exportOptions);\n\n            if (exportResult.isEmpty) {\n                return {\n                    status: 'success',\n                    message: 'No records match the specified criteria',\n                    data: {\n                        isEmpty: true,\n                        rowCount: 0\n                    }\n                };\n            }\n\n            // Set response headers\n            reply\n                .header('Content-Type', exportResult.mimeType)\n                .header('Content-Disposition', `attachment; filename=\"${exportResult.filename}\"`)\n                .header('Content-Length', exportResult.buffer.length)\n                .header('X-Export-Id', exportResult.exportId)\n                .header('X-Export-Row-Count', exportResult.rowCount)\n                .header('X-Export-Size', exportResult.sizeFormatted);\n\n            return reply.send(exportResult.buffer);\n        } catch (error) {\n            logger.error('Error executing data export:', error);\n            reply.code(500);\n            return {\n                status: 'error',\n                message: error.message || 'Failed to export data'\n            };\n        }\n    }\n\n    /**\n     * Get export history\n     * GET /api/data-export/history\n     *\n     * Query: format, resourceType, limit\n     */\n    async getExportHistory(request, reply) {\n        try {\n            const { format, resourceType, limit = 50 } = request.query;\n            const userId = request.user?.id;\n\n            const history = DataExportService.getExportHistory({\n                userId,\n                format,\n                resourceType,\n                limit: parseInt(limit)\n            });\n\n            return {\n                status: 'success',\n                data: history\n            };\n        } catch (error) {\n            logger.error('Error getting export history:', error);\n            reply.code(500);\n            return {\n                status: 'error',\n                message: error.message || 'Failed to get export history'\n            };\n        }\n    }\n\n    /**\n     * Clear export history\n     * DELETE /api/data-export/history\n     */\n    async clearExportHistory(request, reply) {\n        try {\n            const userId = request.user?.id;\n\n            // Only clear user's own history unless admin\n            DataExportService.clearExportHistory(userId);\n\n            return {\n                status: 'success',\n                message: 'Export history cleared'\n            };\n        } catch (error) {\n            logger.error('Error clearing export history:', error);\n            reply.code(500);\n            return {\n                status: 'error',\n                message: error.message || 'Failed to clear export history'\n            };\n        }\n    }\n\n    /**\n     * Check rate limit for user\n     * @private\n     */\n    _checkRateLimit(userId) {\n        const now = Date.now();\n        const windowStart = now - this.RATE_LIMIT_WINDOW_MS;\n\n        // Get or initialize user's request timestamps\n        let userRequests = this.rateLimitMap.get(userId) || [];\n\n        // Filter out old requests\n        userRequests = userRequests.filter(timestamp => timestamp > windowStart);\n\n        // Check if limit exceeded\n        if (userRequests.length >= this.RATE_LIMIT_MAX_REQUESTS) {\n            return false;\n        }\n\n        // Record this request\n        userRequests.push(now);\n        this.rateLimitMap.set(userId, userRequests);\n\n        return true;\n    }\n\n    /**\n     * Build subtitle for export\n     * @private\n     */\n    _buildSubtitle(startDate, endDate) {\n        if (startDate && endDate) {\n            return `Date Range: ${startDate} to ${endDate}`;\n        } else if (startDate) {\n            return `From: ${startDate}`;\n        } else if (endDate) {\n            return `Until: ${endDate}`;\n        }\n        return `Exported: ${new Date().toLocaleDateString()}`;\n    }\n\n    /**\n     * Format bytes to human-readable string\n     * @private\n     */\n    _formatBytes(bytes) {\n        if (bytes === 0) return '0 B';\n        const sizes = ['B', 'KB', 'MB', 'GB'];\n        const i = Math.floor(Math.log(bytes) / Math.log(1024));\n        return `${(bytes / Math.pow(1024, i)).toFixed(2)} ${sizes[i]}`;\n    }\n}\n\nexport default new DataExportController();\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}