{"version":3,"names":["cov_oclp4isv2","actualCoverage","pgTable","bigint","varchar","text","timestamp","boolean","index","patients","nutrition_dietary_restrictions","s","id","mode","primaryKey","generatedByDefaultAsIdentity","patient_id","notNull","references","f","restriction_type","length","restriction_category","food_item","food_group","allergen_code","severity","reaction_type","reaction_description","onset_time","last_reaction_date","is_permanent","default","is_active","effective_date","defaultNow","expiration_date","review_date","diagnosed_by","diagnosis_date","verification_method","medical_condition_related","icd10_code","avoidance_instructions","cross_contamination_risk","safe_alternatives","emergency_treatment","epipen_available","epipen_location","notify_on_admission","notify_dietary","notify_pharmacy","display_on_chart","source_of_information","verified","verified_by_id","verified_date","notes","created_by_id","updated_by_id","createdAt","updatedAt","table","patientIdx","on","typeIdx","foodGroupIdx","activeIdx","severityIdx","patientActiveIdx","RESTRICTION_TYPES","ALLERGY","INTOLERANCE","MEDICAL","RELIGIOUS","CULTURAL","PREFERENCE","OTHER","FOOD_GROUPS","DAIRY","GLUTEN","WHEAT","TREE_NUTS","PEANUTS","SHELLFISH","FISH","SOY","EGG","SESAME","SULFITES","CORN","NIGHTSHADES","CITRUS","LEGUMES","RED_MEAT","POULTRY","PORK","ALCOHOL","CAFFEINE","RESTRICTION_SEVERITY","MILD","MODERATE","SEVERE","LIFE_THREATENING","REACTION_TYPES","ANAPHYLAXIS","HIVES","ANGIOEDEMA","GI_DISTRESS","RESPIRATORY","SKIN_RASH","ORAL_ALLERGY","MIGRAINE","BLOATING","DIARRHEA","NAUSEA","VOMITING"],"sources":["nutritionDietaryRestriction.schema.js"],"sourcesContent":["import { pgTable, bigint, varchar, text, timestamp, boolean, index } from 'drizzle-orm/pg-core';\nimport { patients } from './patient.schema.js';\n\n/**\n * Nutrition Dietary Restrictions Schema\n * Comprehensive tracking of patient dietary restrictions including allergies,\n * intolerances, and medical restrictions for hospice care.\n *\n * Supports:\n * - Food allergies (IgE-mediated reactions)\n * - Food intolerances (non-allergic adverse reactions)\n * - Medical diet restrictions (diabetes, renal, cardiac, etc.)\n * - Cultural/religious dietary requirements\n * - Temporary vs. permanent restrictions\n * - Severity levels and reaction history\n */\nexport const nutrition_dietary_restrictions = pgTable('nutrition_dietary_restrictions', {\n  id: bigint('id', { mode: 'number' }).primaryKey().generatedByDefaultAsIdentity(),\n\n  // Patient association\n  patient_id: bigint('patient_id', { mode: 'number' }).notNull().references(() => patients.id),\n\n  // =========================================\n  // RESTRICTION IDENTIFICATION\n  // =========================================\n  restriction_type: varchar('restriction_type', { length: 50 }).notNull(), // ALLERGY, INTOLERANCE, MEDICAL, RELIGIOUS, CULTURAL, PREFERENCE, OTHER\n  restriction_category: varchar('restriction_category', { length: 100 }), // FOOD, ADDITIVE, PRESERVATIVE, DYE, MEDICATION_INTERACTION\n\n  // Food/substance details\n  food_item: varchar('food_item', { length: 255 }).notNull(), // Specific food or substance\n  food_group: varchar('food_group', { length: 100 }), // DAIRY, GLUTEN, NUTS, SHELLFISH, SOY, EGG, FISH, etc.\n  allergen_code: varchar('allergen_code', { length: 50 }), // Standard allergen codes if applicable\n\n  // =========================================\n  // SEVERITY AND REACTION DETAILS\n  // =========================================\n  severity: varchar('severity', { length: 50 }), // MILD, MODERATE, SEVERE, LIFE_THREATENING\n  reaction_type: varchar('reaction_type', { length: 255 }), // ANAPHYLAXIS, HIVES, GI_DISTRESS, RESPIRATORY, etc.\n  reaction_description: text('reaction_description'),\n  onset_time: varchar('onset_time', { length: 100 }), // IMMEDIATE, DELAYED, VARIABLE\n  last_reaction_date: timestamp('last_reaction_date'),\n\n  // =========================================\n  // TEMPORAL STATUS\n  // =========================================\n  is_permanent: boolean('is_permanent').default(true),\n  is_active: boolean('is_active').default(true),\n  effective_date: timestamp('effective_date').defaultNow(),\n  expiration_date: timestamp('expiration_date'), // For temporary restrictions\n  review_date: timestamp('review_date'), // When to reassess\n\n  // =========================================\n  // MEDICAL CONTEXT\n  // =========================================\n  diagnosed_by: varchar('diagnosed_by', { length: 255 }), // Provider who confirmed\n  diagnosis_date: timestamp('diagnosis_date'),\n  verification_method: varchar('verification_method', { length: 100 }), // SKIN_TEST, BLOOD_TEST, ELIMINATION_DIET, PATIENT_REPORT, FAMILY_REPORT\n  medical_condition_related: varchar('medical_condition_related', { length: 255 }), // Related diagnosis (e.g., Celiac, PKU)\n  icd10_code: varchar('icd10_code', { length: 20 }), // Associated ICD-10 code\n\n  // =========================================\n  // MANAGEMENT\n  // =========================================\n  avoidance_instructions: text('avoidance_instructions'),\n  cross_contamination_risk: boolean('cross_contamination_risk').default(false),\n  safe_alternatives: text('safe_alternatives'),\n  emergency_treatment: text('emergency_treatment'), // E.g., EpiPen instructions\n  epipen_available: boolean('epipen_available').default(false),\n  epipen_location: varchar('epipen_location', { length: 255 }),\n\n  // =========================================\n  // NOTIFICATION FLAGS\n  // =========================================\n  notify_on_admission: boolean('notify_on_admission').default(true),\n  notify_dietary: boolean('notify_dietary').default(true),\n  notify_pharmacy: boolean('notify_pharmacy').default(false),\n  display_on_chart: boolean('display_on_chart').default(true),\n\n  // =========================================\n  // DOCUMENTATION\n  // =========================================\n  source_of_information: varchar('source_of_information', { length: 100 }), // PATIENT, FAMILY, MEDICAL_RECORD, PROVIDER\n  verified: boolean('verified').default(false),\n  verified_by_id: bigint('verified_by_id', { mode: 'number' }),\n  verified_date: timestamp('verified_date'),\n  notes: text('notes'),\n\n  // =========================================\n  // AUDIT FIELDS\n  // =========================================\n  created_by_id: bigint('created_by_id', { mode: 'number' }),\n  updated_by_id: bigint('updated_by_id', { mode: 'number' }),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n}, (table) => ({\n  patientIdx: index('idx_nutrition_dietary_restrictions_patient_id').on(table.patient_id),\n  typeIdx: index('idx_nutrition_dietary_restrictions_type').on(table.restriction_type),\n  foodGroupIdx: index('idx_nutrition_dietary_restrictions_food_group').on(table.food_group),\n  activeIdx: index('idx_nutrition_dietary_restrictions_active').on(table.is_active),\n  severityIdx: index('idx_nutrition_dietary_restrictions_severity').on(table.severity),\n  patientActiveIdx: index('idx_nutrition_dietary_restrictions_patient_active').on(table.patient_id, table.is_active),\n}));\n\n// Restriction types\nexport const RESTRICTION_TYPES = {\n  ALLERGY: 'ALLERGY',\n  INTOLERANCE: 'INTOLERANCE',\n  MEDICAL: 'MEDICAL',\n  RELIGIOUS: 'RELIGIOUS',\n  CULTURAL: 'CULTURAL',\n  PREFERENCE: 'PREFERENCE',\n  OTHER: 'OTHER'\n};\n\n// Food groups for common allergens\nexport const FOOD_GROUPS = {\n  DAIRY: 'DAIRY',\n  GLUTEN: 'GLUTEN',\n  WHEAT: 'WHEAT',\n  TREE_NUTS: 'TREE_NUTS',\n  PEANUTS: 'PEANUTS',\n  SHELLFISH: 'SHELLFISH',\n  FISH: 'FISH',\n  SOY: 'SOY',\n  EGG: 'EGG',\n  SESAME: 'SESAME',\n  SULFITES: 'SULFITES',\n  CORN: 'CORN',\n  NIGHTSHADES: 'NIGHTSHADES',\n  CITRUS: 'CITRUS',\n  LEGUMES: 'LEGUMES',\n  RED_MEAT: 'RED_MEAT',\n  POULTRY: 'POULTRY',\n  PORK: 'PORK',\n  ALCOHOL: 'ALCOHOL',\n  CAFFEINE: 'CAFFEINE',\n  OTHER: 'OTHER'\n};\n\n// Severity levels\nexport const RESTRICTION_SEVERITY = {\n  MILD: 'MILD',\n  MODERATE: 'MODERATE',\n  SEVERE: 'SEVERE',\n  LIFE_THREATENING: 'LIFE_THREATENING'\n};\n\n// Reaction types\nexport const REACTION_TYPES = {\n  ANAPHYLAXIS: 'ANAPHYLAXIS',\n  HIVES: 'HIVES',\n  ANGIOEDEMA: 'ANGIOEDEMA',\n  GI_DISTRESS: 'GI_DISTRESS',\n  RESPIRATORY: 'RESPIRATORY',\n  SKIN_RASH: 'SKIN_RASH',\n  ORAL_ALLERGY: 'ORAL_ALLERGY',\n  MIGRAINE: 'MIGRAINE',\n  BLOATING: 'BLOATING',\n  DIARRHEA: 'DIARRHEA',\n  NAUSEA: 'NAUSEA',\n  VOMITING: 'VOMITING',\n  OTHER: 'OTHER'\n};\n"],"mappings":"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","ignoreList":[]}